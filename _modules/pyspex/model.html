
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pyspex.model &#8212; SPEX Help Center 3.06.00 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="canonical" href="https://spex-xray.github.io/spex-help/_modules/pyspex/model.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for pyspex.model</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1"># Stuff to import for compatibility between python 2 and 3</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>

<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">int</span>

<span class="kn">from</span> <span class="nn">future</span> <span class="kn">import</span> <span class="n">standard_library</span>

<span class="n">standard_library</span><span class="o">.</span><span class="n">install_aliases</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">pyspex</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">Elements</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span>


<div class="viewcode-block" id="Model"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model">[docs]</a><span class="k">class</span> <span class="nc">Model</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Top class containing the entire model, containing all sectors and components.</span>

<span class="sd">    :ivar nsector: Number of sectors in this model</span>
<span class="sd">    :vartype nsector: int</span>
<span class="sd">    :ivar sect: List of sector objects</span>
<span class="sd">    :vartype sect: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nsector</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Number of sectors in this model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sect</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1"># List of sector objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<div class="viewcode-block" id="Model.update"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the Sectors from SPEX.&quot;&quot;&quot;</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_sector</span><span class="o">.</span><span class="n">api_sector_update</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nsector</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_sector</span><span class="o">.</span><span class="n">sect_nsector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sect</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsector</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">Sector</span><span class="p">()</span>
            <span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

    <span class="c1"># Sector commands</span>
<div class="viewcode-block" id="Model.sector_new"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.sector_new">[docs]</a>    <span class="k">def</span> <span class="nf">sector_new</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new sector.&quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_sector</span><span class="o">.</span><span class="n">api_sector_new</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.sector_copy"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.sector_copy">[docs]</a>    <span class="k">def</span> <span class="nf">sector_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy an existing sector to a new one.</span>

<span class="sd">        :param isect: Sector number to copy.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_sector</span><span class="o">.</span><span class="n">api_sector_copy</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.sector_delete"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.sector_delete">[docs]</a>    <span class="k">def</span> <span class="nf">sector_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete an existing sector.</span>

<span class="sd">        :param isect: Sector number to delete.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_sector</span><span class="o">.</span><span class="n">api_sector_delete</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

    <span class="c1"># Component commands</span>
<div class="viewcode-block" id="Model.comp_new"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.comp_new">[docs]</a>    <span class="k">def</span> <span class="nf">comp_new</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">isect</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add new component to the model. By default in sector 1.</span>

<span class="sd">        :param name: Name of the model component, for example &#39;reds&#39;, &#39;hot&#39;, &#39;cie&#39;, etc.</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param isect: Sector number to add component to (default is sector 1).</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">api_comp_new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">isect</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.comp_delete"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.comp_delete">[docs]</a>    <span class="k">def</span> <span class="nf">comp_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete component from sector.</span>

<span class="sd">        :param isect: Sector number of the component to delete.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number to delete.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">api_comp_delete</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.comp_set_rel"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.comp_set_rel">[docs]</a>    <span class="k">def</span> <span class="nf">comp_set_rel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">rel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set component relation.</span>

<span class="sd">        :param isect: Sector number of the component to relate.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number to relate.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param rel: Array containing the multiplicative component numbers counted from the source to the observer.</span>
<span class="sd">        :type rel: numpy.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nrel</span> <span class="o">=</span> <span class="n">rel</span><span class="o">.</span><span class="n">size</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">api_comp_set_rel</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">),</span> <span class="n">rel</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">nrel</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div>

    <span class="c1"># Parameter commands</span>
<div class="viewcode-block" id="Model.par_set"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_set">[docs]</a>    <span class="k">def</span> <span class="nf">par_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">thawn</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set parameter to value and optionally indicate thawn or frozen status.</span>

<span class="sd">        :param isect: Sector number of the parameter.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number of the parameter.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param name: Parameter name.</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param value: New value of the parameter.</span>
<span class="sd">        :type value: float</span>
<span class="sd">        :param thawn: (Optional) Should the parameter be free (True) or frozen (False).</span>
<span class="sd">        :type thawn: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">api_par_set</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">),</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">thawn</span><span class="o">=</span><span class="n">thawn</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sect</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">comp</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.par_aset"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_aset">[docs]</a>    <span class="k">def</span> <span class="nf">par_aset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a text type parameter value.</span>

<span class="sd">        :param isect: Sector number of the parameter.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number of the parameter.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param name: Parameter name.</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param value: New value of the parameter.</span>
<span class="sd">        :type value: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">api_par_aset</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">),</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sect</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">comp</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.par_fix"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_fix">[docs]</a>    <span class="k">def</span> <span class="nf">par_fix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fix a parameter in the fit.</span>

<span class="sd">        :param isect: Sector number of the parameter.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number of the parameter.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param name: Parameter name.</span>
<span class="sd">        :type name: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;par </span><span class="si">{:d}</span><span class="s1"> </span><span class="si">{:d}</span><span class="s1"> </span><span class="si">{:s}</span><span class="s1"> status frozen&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sect</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">comp</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.par_free"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_free">[docs]</a>    <span class="k">def</span> <span class="nf">par_free</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Free a parameter in the fit.</span>

<span class="sd">        :param isect: Sector number of the parameter.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number of the parameter.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param name: Parameter name.</span>
<span class="sd">        :type name: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;par </span><span class="si">{:d}</span><span class="s1"> </span><span class="si">{:d}</span><span class="s1"> </span><span class="si">{:s}</span><span class="s1"> status thawn&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sect</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">comp</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.par_set_range"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_set_range">[docs]</a>    <span class="k">def</span> <span class="nf">par_set_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">rlow</span><span class="p">,</span> <span class="n">rupp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the fit range for a parameter.</span>

<span class="sd">        :param isect: Sector number of the parameter.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number of the parameter.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param name: Parameter name.</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param rlow: Lower limit of the parameter range.</span>
<span class="sd">        :type rlow: float</span>
<span class="sd">        :param rupp: Upper limit of the parameter range.</span>
<span class="sd">        :type rupp: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">api_par_set_range</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">),</span> <span class="n">name</span><span class="p">,</span> <span class="n">rlow</span><span class="p">,</span> <span class="n">rupp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sect</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">comp</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.par_get"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_get">[docs]</a>    <span class="k">def</span> <span class="nf">par_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the parameter object for sector isect, component icomp and parameter with name.</span>

<span class="sd">        :param isect: Sector number of the parameter.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number of the parameter.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :rtype: model.Parameter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">par</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sect</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">comp</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">par</span>

        <span class="k">return</span> <span class="n">par</span></div>

<div class="viewcode-block" id="Model.par_couple"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_couple">[docs]</a>    <span class="k">def</span> <span class="nf">par_couple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">iname</span><span class="p">,</span> <span class="n">csect</span><span class="p">,</span> <span class="n">ccomp</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Couple parameter (iname) to another parameter with cname, with a coupling factor.</span>

<span class="sd">        :param isect: Sector number of the parameter.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number of the parameter.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param iname: Parameter name.</span>
<span class="sd">        :type iname: str</span>
<span class="sd">        :param csect: Sector number of the parameter to couple to.</span>
<span class="sd">        :type csect: int</span>
<span class="sd">        :param ccomp: Component number of the parameter to couple to.</span>
<span class="sd">        :type ccomp: int</span>
<span class="sd">        :param cname: Parameter name of the parameter to couple to.</span>
<span class="sd">        :type cname: str</span>
<span class="sd">        :param factor: Multiplication factor (value(name) = factor * value(cname)).</span>
<span class="sd">        :type factor: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">api_par_couple</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">),</span> <span class="n">iname</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">csect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">ccomp</span><span class="p">),</span>
                                                        <span class="n">cname</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sect</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">comp</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.par_decouple"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_decouple">[docs]</a>    <span class="k">def</span> <span class="nf">par_decouple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">iname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Decouple parameter.</span>

<span class="sd">        :param isect: Sector number of the parameter.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number of the parameter.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param iname: Parameter name.</span>
<span class="sd">        :type iname: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">api_par_decouple</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">),</span> <span class="n">iname</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sect</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">comp</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.par_norm_set"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_norm_set">[docs]</a>    <span class="k">def</span> <span class="nf">par_norm_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ins</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the instrument normalisation for an instrument number and region number.</span>

<span class="sd">        :param ins: Instrument number.</span>
<span class="sd">        :type ins: int</span>
<span class="sd">        :param reg: Region number.</span>
<span class="sd">        :type reg: int</span>
<span class="sd">        :param value: New value of the instrument normalisation.</span>
<span class="sd">        :type value: float</span>
<span class="sd">        :param status: (Optional) Should the parameter be free (True) or frozen (False).</span>
<span class="sd">        :type status: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_instnorm</span><span class="o">.</span><span class="n">api_norm_set</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ins</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">reg</span><span class="p">),</span> <span class="n">value</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Model.par_norm_get"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_norm_get">[docs]</a>    <span class="k">def</span> <span class="nf">par_norm_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ins</span><span class="p">,</span> <span class="n">reg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the instrument normalisation for instrument ins and region reg.</span>

<span class="sd">        :param ins: Instrument number.</span>
<span class="sd">        :type ins: int</span>
<span class="sd">        :param reg: Region number.</span>
<span class="sd">        :type reg: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_instnorm</span><span class="o">.</span><span class="n">api_norm_get</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ins</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">reg</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_instnorm</span><span class="o">.</span><span class="n">norm_renorm</span><span class="p">),</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_instnorm</span><span class="o">.</span><span class="n">norm_free</span><span class="p">)</span></div>

<div class="viewcode-block" id="Model.par_show"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_show">[docs]</a>    <span class="k">def</span> <span class="nf">par_show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display parameter overview in terminal.</span>

<span class="sd">        :param option: Select which information should be shown (free/couple/flux/stat/corr/all)</span>
<span class="sd">        :type option: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">option</span><span class="o">==</span><span class="s1">&#39;free&#39;</span><span class="p">:</span>
            <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;par show free&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">option</span><span class="o">==</span><span class="s1">&#39;couple&#39;</span><span class="p">:</span>
            <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;par show couple&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">option</span><span class="o">==</span><span class="s1">&#39;flux&#39;</span><span class="p">:</span>
            <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;par show flux&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">option</span><span class="o">==</span><span class="s1">&#39;stat&#39;</span><span class="p">:</span>
            <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;par show stat&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">option</span><span class="o">==</span><span class="s1">&#39;corr&#39;</span><span class="p">:</span>
            <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;par show corr&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">option</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;par show all&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;par show&#39;</span><span class="p">)</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="Model.par_write"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Model.par_write">[docs]</a>    <span class="k">def</span> <span class="nf">par_write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comfile</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write parameters to a .com file.</span>

<span class="sd">        :param comfile: Output file name (with .com extension!)</span>
<span class="sd">        :type comfile: str</span>
<span class="sd">        :param overwrite: (Optional) Overwrite existing files if necessary (True/False).</span>
<span class="sd">        :type overwrite: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">comfile</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">comfile</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">ext</span> <span class="o">!=</span> <span class="s1">&#39;.com&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: File does not have the .com extension.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;par write </span><span class="si">{:s}</span><span class="s1"> overwrite&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;par write </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>

<div class="viewcode-block" id="Sector"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Sector">[docs]</a><span class="k">class</span> <span class="nc">Sector</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class describing a Sector.</span>
<span class="sd">    </span>
<span class="sd">    :ivar index: Sector number.</span>
<span class="sd">    :vartype index: int</span>
<span class="sd">    :ivar ncomp: Number of components in sector.</span>
<span class="sd">    :vartype ncomp: int</span>
<span class="sd">    :ivar comp: List of component objects.</span>
<span class="sd">    :vartype comp: list</span>
<span class="sd">    :ivar distance: Distance for this sector.</span>
<span class="sd">    :vartype distance: float</span>
<span class="sd">    :ivar spectrum: Model spectrum for this sector</span>
<span class="sd">    :vartype spectrum: pyspex.model.Spectrum</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># Sector number.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncomp</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># Number of components in sector.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># List of component objects.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># Distance for this sector.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">()</span> <span class="c1"># The spectrum for this sector</span>

<div class="viewcode-block" id="Sector.update"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Sector.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the information from SPEX for sector isect.</span>
<span class="sd">        </span>
<span class="sd">        :param isect: Sector number.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_sector</span><span class="o">.</span><span class="n">sect_index</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncomp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_sector</span><span class="o">.</span><span class="n">sect_ncomp</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_sector</span><span class="o">.</span><span class="n">sect_distance</span><span class="p">[</span><span class="n">isect</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">isect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comp</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncomp</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">Component</span><span class="p">()</span>
            <span class="n">c</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Component"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Component">[docs]</a><span class="k">class</span> <span class="nc">Component</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class containing a model component.</span>
<span class="sd">    </span>
<span class="sd">    :ivar index: Component number.</span>
<span class="sd">    :vartype index: int</span>
<span class="sd">    :ivar umodel: Model ID number.</span>
<span class="sd">    :vartype umodel: int</span>
<span class="sd">    :ivar add: Is this an additive component?</span>
<span class="sd">    :vartype add: bool</span>
<span class="sd">    :ivar mul: Is this a multiplicative component?</span>
<span class="sd">    :vartype mul: bool</span>
<span class="sd">    :ivar operator: True for complex components.</span>
<span class="sd">    :vartype operator: bool</span>
<span class="sd">    :ivar npar: Number of parameters in components.</span>
<span class="sd">    :vartype npar: int</span>
<span class="sd">    :ivar name: Name of model.</span>
<span class="sd">    :vartype name: str</span>
<span class="sd">    :ivar nmul: Number of elements in addmul (below).</span>
<span class="sd">    :vartype nmul: int</span>
<span class="sd">    :ivar addmul: Array with the numbers of the multiplicative components to multiply with.</span>
<span class="sd">    :vartype addmul: numpy.ndarray</span>

<span class="sd">    :ivar par: List of parameter objects.</span>
<span class="sd">    :vartype par: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>                  <span class="c1"># Component number.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">umodel</span> <span class="o">=</span> <span class="mi">0</span>                 <span class="c1"># Model ID number.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span> <span class="o">=</span> <span class="kc">False</span>                <span class="c1"># Is this an additive component?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mul</span> <span class="o">=</span> <span class="kc">False</span>                <span class="c1"># Is this a multiplicative component?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">operator</span> <span class="o">=</span> <span class="kc">False</span>           <span class="c1"># True for complex components.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npar</span> <span class="o">=</span> <span class="mi">0</span>                   <span class="c1"># Number of parameters in components.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>                  <span class="c1"># Name of model.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nmul</span> <span class="o">=</span> <span class="mi">0</span>                   <span class="c1"># Number of elements in addmul (below).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmul</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Array with the numbers of the multiplicative components to multiply with.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">par</span> <span class="o">=</span> <span class="p">[]</span>                   <span class="c1"># List of parameter objects.</span>

<div class="viewcode-block" id="Component.update"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Component.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the information from SPEX for sector isect and component icomp.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number of the component.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">api_comp_update</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">))</span>
        <span class="c1"># Update the name and relational information for this component</span>
        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">api_comp_get_rel</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">))</span>
        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">api_comp_get_name</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">comp_index</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">umodel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">comp_umodel</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">comp_add</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mul</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">comp_mul</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">operator</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">comp_operator</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npar</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">comp_npar</span><span class="p">[</span><span class="n">icomp</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">comp_name</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;S4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tostring</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nmul</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">comp_nmul</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addmul</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nmul</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nmul</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addmul</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">comp_addmul</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">par</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_component</span><span class="o">.</span><span class="n">api_comp_final</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npar</span><span class="p">):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">()</span>
            <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">par</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Parameter"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Parameter">[docs]</a><span class="k">class</span> <span class="nc">Parameter</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class for model parameters.</span>
<span class="sd">    </span>
<span class="sd">    :ivar index: Parameter number</span>
<span class="sd">    :vartype index: int</span>
<span class="sd">    :ivar name: Name of parameter</span>
<span class="sd">    :vartype name: str</span>
<span class="sd">    :ivar type: Type of parameter (norm, abun, fitp, cons or text)</span>
<span class="sd">    :vartype type: str</span>
<span class="sd">    :ivar value: Value</span>
<span class="sd">    :vartype value: float</span>
<span class="sd">    :ivar low: Lower boundary of parameter range</span>
<span class="sd">    :vartype low: float</span>
<span class="sd">    :ivar upp: Upper boundary of parameter range</span>
<span class="sd">    :vartype upp: float</span>
<span class="sd">    :ivar err_low: Lower error boundary</span>
<span class="sd">    :vartype err_low: float</span>
<span class="sd">    :ivar err_upp: Upper error boundary</span>
<span class="sd">    :vartype err_upp: float</span>
<span class="sd">    :ivar free: True if parameter is free</span>
<span class="sd">    :vartype free: bool</span>
<span class="sd">    :ivar linked: True if parameter is linked</span>
<span class="sd">    :vartype linked: bool</span>
<span class="sd">    :ivar link_sector: Sector to which parameter is linked</span>
<span class="sd">    :vartype link_sector: int</span>
<span class="sd">    :ivar link_comp: Component to which parameter is linked</span>
<span class="sd">    :vartype link_comp: int</span>
<span class="sd">    :ivar link_par: Parameter to which parameter is linked</span>
<span class="sd">    :vartype link_par: int</span>
<span class="sd">    :ivar coupling: Coupling factor</span>
<span class="sd">    :vartype coupling: float</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1"># Parameter number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>        <span class="c1"># Name of parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>        <span class="c1"># Type of parameter (norm, abun, fitp, cons or text)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.</span>       <span class="c1"># Value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low</span> <span class="o">=</span> <span class="mf">0.</span>         <span class="c1"># Lower boundary of parameter range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upp</span> <span class="o">=</span> <span class="mf">0.</span>         <span class="c1"># Upper boundary of parameter range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">err_low</span> <span class="o">=</span> <span class="mf">0.</span>     <span class="c1"># Lower error boundary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">err_upp</span> <span class="o">=</span> <span class="mf">0.</span>     <span class="c1"># Upper error boundary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">free</span> <span class="o">=</span> <span class="kc">False</span>     <span class="c1"># True if parameter is free</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linked</span> <span class="o">=</span> <span class="kc">False</span>   <span class="c1"># True if parameter is linked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link_sector</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Sector to which parameter is linked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link_comp</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># Component to which parameter is linked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link_par</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c1"># Parameter to which parameter is linked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coupling</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># Coupling factor</span>

<div class="viewcode-block" id="Parameter.update"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Parameter.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">ipar</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the parameter values from SPEX memory.</span>
<span class="sd">        </span>
<span class="sd">        :param isect: Sector number of the parameter.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number of the parameter.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param ipar: Parameter number.</span>
<span class="sd">        :type ipar: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">api_par_update</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">ipar</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_acronym</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;S4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tostring</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_type</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;S4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tostring</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_low</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_upp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">err_low</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_err_low</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">err_upp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_err_upp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">free</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_free</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linked</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_linked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link_sector</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_link_sector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link_comp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_link_comp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link_par</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_link_par</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coupling</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_parameter</span><span class="o">.</span><span class="n">par_coupling</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Abundance"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Abundance">[docs]</a><span class="k">class</span> <span class="nc">Abundance</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This class manages the SPEX abundance setting.</span>
<span class="sd">    </span>
<span class="sd">    :ivar index: Abundance index in list</span>
<span class="sd">    :vartype index: int</span>
<span class="sd">    :ivar ref: Reference to abundance set (string)</span>
<span class="sd">    :vartype ref: str</span>
<span class="sd">    :ivar list: The available abundance sets.</span>
<span class="sd">    :vartype list: tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c1"># Abundance index in list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>      <span class="c1"># Reference to abundance set (string)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Lodders et al. (2009)&quot;</span><span class="p">,</span> <span class="s2">&quot;Allen (1973)&quot;</span><span class="p">,</span> <span class="s2">&quot;Ross &amp; Aller (1976)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Grevesse et al. (1992)&quot;</span><span class="p">,</span> <span class="s2">&quot;Grevesse &amp; Sauval (1998)&quot;</span><span class="p">,</span> <span class="s2">&quot;Lodders proto-Solar (2003)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Lodders Solar Photospheric (2003)&quot;</span><span class="p">,</span> <span class="s2">&quot;Anders &amp; Grevesse (1989)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Asplund et al. (2009)&quot;</span><span class="p">)</span>   <span class="c1"># The available abundance sets.</span>

<div class="viewcode-block" id="Abundance.set"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Abundance.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abun</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the abundance in SPEX to another set.</span>
<span class="sd">        </span>
<span class="sd">        :param abun: Abbreviation of the abundance set.</span>
<span class="sd">        :type abun: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_abundance</span><span class="o">.</span><span class="n">api_abun_set</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Abundance.get"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Abundance.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the current Abundance setting (reference).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span></div>

<div class="viewcode-block" id="Abundance.update"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Abundance.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the abundance setting in pyspex.&quot;&quot;&quot;</span>
        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_abundance</span><span class="o">.</span><span class="n">api_abun_update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_abundance</span><span class="o">.</span><span class="n">abun_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_abundance</span><span class="o">.</span><span class="n">abun_ref</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;S48&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tostring</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Distance"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Distance">[docs]</a><span class="k">class</span> <span class="nc">Distance</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This class is used to set and get the distances in SPEX.</span>
<span class="sd">    </span>
<span class="sd">    :ivar m: Distance in meter</span>
<span class="sd">    :vartype m: float</span>
<span class="sd">    :ivar au: Distance in Astronomical Units</span>
<span class="sd">    :vartype au: float</span>
<span class="sd">    :ivar ly: Distance in light year</span>
<span class="sd">    :vartype ly: float</span>
<span class="sd">    :ivar pc: Distance in parsec</span>
<span class="sd">    :vartype pc: float</span>
<span class="sd">    :ivar kpc: Distance in kiloparsec</span>
<span class="sd">    :vartype kpc: float</span>
<span class="sd">    :ivar mpc: Distance in megaparsec</span>
<span class="sd">    :vartype mpc: float</span>
<span class="sd">    :ivar z: Distance in redshift</span>
<span class="sd">    :vartype z: float</span>
<span class="sd">    :ivar cz: Distance in cz</span>
<span class="sd">    :vartype cz: float</span>
<span class="sd">    :ivar age: Lookback time (yr)</span>
<span class="sd">    :vartype age: float</span>
<span class="sd">    </span>
<span class="sd">    :ivar h0: Hubble constant (km/s/Mpc)</span>
<span class="sd">    :vartype h0: float</span>
<span class="sd">    :ivar omega_m: Omega Matter</span>
<span class="sd">    :vartype omega_m: float</span>
<span class="sd">    :ivar omega_l: Omega Lambda</span>
<span class="sd">    :vartype omega_l: float</span>
<span class="sd">    :ivar omega_r: Omega R</span>
<span class="sd">    :vartype omega_r: float</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="mf">0.</span>    <span class="c1"># Distance in meter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># Distance in Astronomical Units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ly</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># Distance in light year</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># Distance in parsec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kpc</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Distance in kiloparsec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpc</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Distance in megaparsec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="mf">0.</span>    <span class="c1"># Distance in redshift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># Distance in cz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Lookback time (yr)</span>

        <span class="c1"># Cosmology</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h0</span> <span class="o">=</span> <span class="mf">70.0</span>      <span class="c1"># Hubble constant (km/s/Mpc)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega_m</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># Omega Matter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega_l</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># Omega Lambda</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega_r</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Omega R</span>

<div class="viewcode-block" id="Distance.set"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Distance.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the distance in units for a particular sector (isect).</span>
<span class="sd">        </span>
<span class="sd">        :param isect: Sector number.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param dist: Distance value.</span>
<span class="sd">        :type dist: float</span>
<span class="sd">        :param unit: Unit of the distance, for example: &#39;m&#39;, &#39;au&#39;, &#39;ly&#39;, &#39;pc&#39;, &#39;kpc&#39;, &#39;mpc&#39;, &#39;z&#39;, &#39;cz&#39;.</span>
<span class="sd">        :type unit: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">api_distance_set</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="n">dist</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_au</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ly</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_ly</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_pc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kpc</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_kpc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpc</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_mpc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_z</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cz</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_cz</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_age</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Distances not set correctly.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Distance.get"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Distance.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the distances for a sector from SPEX.</span>
<span class="sd">        </span>
<span class="sd">        :param isect: Sector number.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">api_distance_calc</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">isect</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_au</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ly</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_ly</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_pc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kpc</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_kpc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mpc</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_mpc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_z</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cz</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_cz</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">dist_age</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Distances could not be retrieved.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Distance.set_cosmo"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Distance.set_cosmo">[docs]</a>    <span class="k">def</span> <span class="nf">set_cosmo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h0</span><span class="p">,</span> <span class="n">omega_m</span><span class="p">,</span> <span class="n">omega_l</span><span class="p">,</span> <span class="n">omega_r</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the cosmological constants for the distance calculation.</span>
<span class="sd">        </span>
<span class="sd">        :param h0: Hubble constant (km/s/Mpc).</span>
<span class="sd">        :type h0: float</span>
<span class="sd">        :param omega_m: Omega matter.</span>
<span class="sd">        :type omega_m: float</span>
<span class="sd">        :param omega_l: Omega lambda.</span>
<span class="sd">        :type omega_l: float</span>
<span class="sd">        :param omega_r: Omega R.</span>
<span class="sd">        :type omega_r: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_distance</span><span class="o">.</span><span class="n">api_distance_set_cosmo</span><span class="p">(</span><span class="n">h0</span><span class="p">,</span> <span class="n">omega_m</span><span class="p">,</span> <span class="n">omega_l</span><span class="p">,</span> <span class="n">omega_r</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h0</span> <span class="o">=</span> <span class="n">h0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">omega_m</span> <span class="o">=</span> <span class="n">omega_m</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">omega_l</span> <span class="o">=</span> <span class="n">omega_l</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">omega_r</span> <span class="o">=</span> <span class="n">omega_r</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Cosmology not set.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Egrid"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Egrid">[docs]</a><span class="k">class</span> <span class="nc">Egrid</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This class is used to specify the model energy grid.</span>
<span class="sd">    </span>
<span class="sd">    :ivar nbins: Number of bins</span>
<span class="sd">    :vartype nbins: int</span>
<span class="sd">    :ivar energy: Centroids of bins (Energy, keV)</span>
<span class="sd">    :vartype energy: numpy.ndarray</span>
<span class="sd">    :ivar energy_upper: Upper boundaries of bins (Energy, keV)</span>
<span class="sd">    :vartype energy_upper: numpy.ndarray</span>
<span class="sd">    :ivar energy_width: Widths of bins (Energy, keV)</span>
<span class="sd">    :vartype energy_width: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbins</span> <span class="o">=</span> <span class="mi">0</span>                              <span class="c1"># Number of bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Centroids of bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_upper</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Upper boundaries of bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_width</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Widths of bins</span>

    <span class="k">def</span> <span class="nf">allocate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_upper</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_width</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">0</span>

<div class="viewcode-block" id="Egrid.set"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Egrid.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elow</span><span class="p">,</span> <span class="n">ehigh</span><span class="p">,</span> <span class="n">nbins</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set egrid using limits and number of bins.</span>
<span class="sd">        </span>
<span class="sd">        :param elow: Lowest energy/wavelength for energy grid.</span>
<span class="sd">        :type elow: float</span>
<span class="sd">        :param ehigh: Highest energy/wavelength for energy grid.</span>
<span class="sd">        :type ehigh: float</span>
<span class="sd">        :param nbins: Number of bins for energy grid.</span>
<span class="sd">        :type nbins: int</span>
<span class="sd">        :param unit: Unit of the energy/wavelength range, for example: &#39;kev&#39;, &#39;ev&#39;, &#39;ryd&#39;, &#39;j&#39;, &#39;hz&#39;, &#39;ang&#39;, &#39;nm&#39;</span>
<span class="sd">        :type unit: str</span>
<span class="sd">        :param log: Make the energy grid logarithmic (True or False)</span>
<span class="sd">        :type log: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">api_egrid_set</span><span class="p">(</span><span class="n">elow</span><span class="p">,</span> <span class="n">ehigh</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">nbins</span><span class="p">),</span> <span class="n">unit</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Egrid.set_step"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Egrid.set_step">[docs]</a>    <span class="k">def</span> <span class="nf">set_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elow</span><span class="p">,</span> <span class="n">ehigh</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set egrid using limits and step size.</span>
<span class="sd">        </span>
<span class="sd">        :param elow: Lowest energy/wavelength for energy grid.</span>
<span class="sd">        :type elow: float</span>
<span class="sd">        :param ehigh: Highest energy/wavelength for energy grid.</span>
<span class="sd">        :type ehigh: float</span>
<span class="sd">        :param step: Step size for the energy grid.</span>
<span class="sd">        :type step: float</span>
<span class="sd">        :param unit: Unit of the energy/wavelength range, for example: &#39;kev&#39;, &#39;ev&#39;, &#39;ryd&#39;, &#39;j&#39;, &#39;hz&#39;, &#39;ang&#39;, &#39;nm&#39;</span>
<span class="sd">        :type unit: str</span>
<span class="sd">        :param log: Make the energy grid logarithmic (True or False)</span>
<span class="sd">        :type log: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">api_egrid_set_step</span><span class="p">(</span><span class="n">elow</span><span class="p">,</span> <span class="n">ehigh</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Egrid.get"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Egrid.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the current energy grid from SPEX.&quot;&quot;&quot;</span>
        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">api_egrid_get</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nbins</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">nbins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">energy_cent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy_upper</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">energy_bupp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy_width</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">energy_width</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">api_egrid_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Egrid.save"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Egrid.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">savefile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the energy grid to a file named savefile (extension: .egr).</span>
<span class="sd">        </span>
<span class="sd">        :param savefile: Filename to save the energy grid to (including .egr extension)</span>
<span class="sd">        :type savefile: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">savefile</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">savefile</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">ext</span> <span class="o">!=</span> <span class="s1">&#39;.egr&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: File does not have the .egr extension.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>

        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">api_egrid_save</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Egrid.read"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Egrid.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">readfile</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the energy grid from a file named readfile (extension: .egr).</span>
<span class="sd">        </span>
<span class="sd">        :param readfile: Filename to read the energy grid from (including .egr extension)</span>
<span class="sd">        :type readfile: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">readfile</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">readfile</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">ext</span> <span class="o">!=</span> <span class="s1">&#39;.egr&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: File does not have the .egr extension.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>

        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">api_egrid_read</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Egrid.grid"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Egrid.grid">[docs]</a>    <span class="k">def</span> <span class="nf">grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ebounds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Provide a grid to SPEX by providing a numpy array with the bin boundaries.</span>
<span class="sd">        Please note that the length of this array is the number of bins + 1!</span>
<span class="sd">        </span>
<span class="sd">        :param ebounds: Array containing the energy boundaries of the new energy grid (keV).</span>
<span class="sd">        :type ebounds: numpy.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ebounds</span><span class="p">)</span> <span class="ow">is</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_egrid</span><span class="o">.</span><span class="n">api_egrid_grid</span><span class="p">(</span><span class="n">ebounds</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Input object is not a numpy array.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Fluxes"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Fluxes">[docs]</a><span class="k">class</span> <span class="nc">Fluxes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This class is used to calculate fluxes and luminosities of spectra in a spectral band.</span>
<span class="sd">    </span>
<span class="sd">    :ivar sector: Sector number of flux calculation</span>
<span class="sd">    :vartype sector: int</span>
<span class="sd">    :ivar component: Component number of flux calculation</span>
<span class="sd">    :vartype component: int</span>
<span class="sd">    :ivar photflux: Photon flux (phot/m**2/s)</span>
<span class="sd">    :vartype photflux: float</span>
<span class="sd">    :ivar enerflux: Energy flux (W/m**2)</span>
<span class="sd">    :vartype enerflux: float</span>
<span class="sd">    :ivar photlum: Photon luminosity (photons/s)</span>
<span class="sd">    :vartype photlum: float</span>
<span class="sd">    :ivar enerlum: Energy luminosity (W)</span>
<span class="sd">    :vartype enerlum: float</span>

<span class="sd">    :ivar elimflux: Flux energy limits (keV)</span>
<span class="sd">    :vartype elimflux: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sector</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c1"># Sector number of flux calculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># Component number of flux calculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">photflux</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># Photon flux (phot/m**2/s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enerflux</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># Energy flux (W/m**2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">photlum</span> <span class="o">=</span> <span class="mf">0.</span>    <span class="c1"># Photon luminosity (photons/s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enerlum</span> <span class="o">=</span> <span class="mf">0.</span>    <span class="c1"># Energy luminosity (W)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">elimflux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1">#: Flux energy limits (keV)</span>

<div class="viewcode-block" id="Fluxes.elim"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Fluxes.elim">[docs]</a>    <span class="k">def</span> <span class="nf">elim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elow</span><span class="p">,</span> <span class="n">ehigh</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the energy limits for the flux and luminosity calculation.</span>
<span class="sd">        </span>
<span class="sd">        :param elow: Lowest energy/wavelength for energy interval.</span>
<span class="sd">        :type elow: float</span>
<span class="sd">        :param ehigh: Highest energy/wavelength for energy interval.</span>
<span class="sd">        :type ehigh: float</span>
<span class="sd">        :param unit: Unit of the energy/wavelength interval, for example: &#39;kev&#39;, &#39;ev&#39;, &#39;ryd&#39;, &#39;j&#39;, &#39;hz&#39;, &#39;ang&#39;, &#39;nm&#39;.</span>
<span class="sd">        :type unit: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_fluxes</span><span class="o">.</span><span class="n">api_flux_elim</span><span class="p">(</span><span class="n">elow</span><span class="p">,</span> <span class="n">ehigh</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Setting of energy limits failed.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Fluxes.get"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Fluxes.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the flux and luminosity from SPEX for a given sector and component number.</span>
<span class="sd">        </span>
<span class="sd">        :param isect: Sector number of the component to obtain the flux from.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number to obtain the flux from.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_fluxes</span><span class="o">.</span><span class="n">api_flux_get</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">isect</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">icomp</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sector</span> <span class="o">=</span> <span class="n">isect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component</span> <span class="o">=</span> <span class="n">icomp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">photflux</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_fluxes</span><span class="o">.</span><span class="n">flux_photflux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enerflux</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_fluxes</span><span class="o">.</span><span class="n">flux_enerflux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">photlum</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_fluxes</span><span class="o">.</span><span class="n">flux_photlum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enerlum</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_fluxes</span><span class="o">.</span><span class="n">flux_enerlum</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">elimflux</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_fluxes</span><span class="o">.</span><span class="n">flux_elim</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="Fluxes.calc"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Fluxes.calc">[docs]</a>    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate and get flux and luminosity from SPEX for a given sector and component number.</span>
<span class="sd">        </span>
<span class="sd">        :param isect: Sector number of the component to calculate.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number to calculate.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model</span><span class="o">.</span><span class="n">api_model_calculate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">return</span></div></div>


<div class="viewcode-block" id="Ibal"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ibal">[docs]</a><span class="k">class</span> <span class="nc">Ibal</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This class manages the SPEX ionisation balance setting.</span>
<span class="sd">    </span>
<span class="sd">    :ivar index: Index number for list of ionisation balance sets.</span>
<span class="sd">    :vartype index: int</span>
<span class="sd">    :ivar ref: Reference to the current ionisation balance.</span>
<span class="sd">    :vartype ref: str</span>
<span class="sd">    :ivar list: List of available ionisation balance data.</span>
<span class="sd">    :vartype list: tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># Index number for list.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>    <span class="c1"># Reference to ibal set (string)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;Arnaud &amp; Raymond (1992) for Fe, Arnaud &amp; Rothenflug (1985) for other elements&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Arnaud &amp; Rothenflug (1985)&quot;</span><span class="p">,</span> <span class="s2">&quot;Arnaud &amp; Raymond (1992) for Fe, Arnaud &amp; Rothenflug (1985) &quot;</span>
                     <span class="s2">&quot;for other elements&quot;</span><span class="p">,</span> <span class="s2">&quot;Old Bryans et al. data (NOT recommended)&quot;</span><span class="p">,</span> <span class="s2">&quot;Bryans et al. (2009)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Urdampilleta et al. (2017)&quot;</span><span class="p">)</span>  <span class="c1"># List of available ibal data.</span>

<div class="viewcode-block" id="Ibal.set"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ibal.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ibal</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the abundance in SPEX to another set.</span>
<span class="sd">        </span>
<span class="sd">        :param ibal: Abbreviation of the reference to the ionisation balance.</span>
<span class="sd">        :type ibal: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ibal</span><span class="o">.</span><span class="n">api_ibal_set</span><span class="p">(</span><span class="n">ibal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ibal.get"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ibal.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the current Abundance setting (reference).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span></div>

<div class="viewcode-block" id="Ibal.update"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ibal.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the abundance setting in pyspex.&quot;&quot;&quot;</span>
        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ibal</span><span class="o">.</span><span class="n">api_ibal_update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ibal</span><span class="o">.</span><span class="n">ibal_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ibal</span><span class="o">.</span><span class="n">ibal_ref</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;S80&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tostring</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></div></div>


<span class="c1"># Classes for ions in the model calculation</span>

<span class="k">class</span> <span class="nc">Ion</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class containing the settings of an ion.</span>
<span class="sd">    </span>
<span class="sd">    :ivar z: Atomic number.</span>
<span class="sd">    :vartype z: int</span>
<span class="sd">    :ivar i: Ionisation stage.</span>
<span class="sd">    :vartype i: int</span>
<span class="sd">    :ivar use: Ion used in calculation.</span>
<span class="sd">    :vartype use: bool</span>
<span class="sd">    :ivar new: Use ion in the new calculation.</span>
<span class="sd">    :vartype new: bool</span>
<span class="sd">    :ivar nmax: Maximum principle quantum number.</span>
<span class="sd">    :vartype nmax: int</span>
<span class="sd">    :ivar lmax: Maximum angular momentum number.</span>
<span class="sd">    :vartype lmax: int</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>        <span class="c1"># Atomic number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span>        <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use</span> <span class="o">=</span> <span class="kc">True</span>   <span class="c1"># Ion used in calculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="kc">True</span>   <span class="c1"># Use ion in the new calculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nmax</span> <span class="o">=</span> <span class="mi">10</span>    <span class="c1"># Maximum principle quantum number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lmax</span> <span class="o">=</span> <span class="mi">10</span>    <span class="c1"># Maximum angular momentum number</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the information for an ion with atomic number z and ionisation stage i.&quot;&quot;&quot;</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lmax</span><span class="p">,</span> <span class="n">use</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_get</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">use</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">new</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="kc">False</span>


<span class="k">class</span> <span class="nc">Atom</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class containing all ions for an atom.</span>

<span class="sd">    :ivar nion: Number of ions for this atom.</span>
<span class="sd">    :vartype nion: int</span>
<span class="sd">    :ivar z: Atomic number for this atom.</span>
<span class="sd">    :vartype z: int</span>
<span class="sd">    :ivar ions: List of ion objects with ion information.</span>
<span class="sd">    :vartype ions: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the information for an atom.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nion</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the properties for this atom.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nion</span><span class="p">):</span>
            <span class="n">ion</span> <span class="o">=</span> <span class="n">Ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ion</span><span class="p">)</span>


<div class="viewcode-block" id="Ions"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions">[docs]</a><span class="k">class</span> <span class="nc">Ions</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class to manage the ions taken into account in the model calculation.</span>

<span class="sd">    :ivar nz: Total number of atoms considered.</span>
<span class="sd">    :vartype nz: int</span>
<span class="sd">    :ivar atoms: List of atoms (with information about each ion).</span>
<span class="sd">    :vartype atoms: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<div class="viewcode-block" id="Ions.update"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the properties of all atoms.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">iz</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">):</span>
            <span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">iz</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span></div>

<div class="viewcode-block" id="Ions.show"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show the settings for the ions.&quot;&quot;&quot;</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">Elements</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">iz</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jz</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">nion</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">ions</span><span class="p">[</span><span class="n">jz</span><span class="p">]</span><span class="o">.</span><span class="n">new</span><span class="p">:</span>
                    <span class="n">new</span> <span class="o">=</span> <span class="s1">&#39;v3&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new</span> <span class="o">=</span> <span class="s1">&#39;v2&#39;</span>
                <span class="n">nmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">ions</span><span class="p">[</span><span class="n">jz</span><span class="p">]</span><span class="o">.</span><span class="n">nmax</span>
                <span class="n">lmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">ions</span><span class="p">[</span><span class="n">jz</span><span class="p">]</span><span class="o">.</span><span class="n">lmax</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">iz</span><span class="p">]</span><span class="o">.</span><span class="n">ions</span><span class="p">[</span><span class="n">jz</span><span class="p">]</span><span class="o">.</span><span class="n">use</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:9}</span><span class="s2"> </span><span class="si">{:2}</span><span class="s2"> </span><span class="si">{:3d}</span><span class="s2"> </span><span class="si">{:3d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="n">iz</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">jz</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">new</span><span class="p">,</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">lmax</span><span class="p">))</span></div>

    <span class="c1"># Set nmax</span>
<div class="viewcode-block" id="Ions.nmax_all"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.nmax_all">[docs]</a>    <span class="k">def</span> <span class="nf">nmax_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nmax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set all ions to maximum quantum number nmax.</span>

<span class="sd">        :param nmax: Maximum principle quantum number to use.</span>
<span class="sd">        :type nmax: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_nmax_all</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nmax</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.nmax_iso"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.nmax_iso">[docs]</a>    <span class="k">def</span> <span class="nf">nmax_iso</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iso</span><span class="p">,</span> <span class="n">nmax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set this iso-electronic sequence to maximum quantum number nmax.</span>

<span class="sd">        :param iso: Iso-electronic sequence.</span>
<span class="sd">        :type iso: int</span>
<span class="sd">        :param nmax: Maximum principle quantum number to use.</span>
<span class="sd">        :type nmax: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_nmax_iso</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nmax</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">iso</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.nmax_z"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.nmax_z">[docs]</a>    <span class="k">def</span> <span class="nf">nmax_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">nmax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set all ions of this element to maximum quantum number nmax.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        :param nmax: Maximum principle quantum number to use.</span>
<span class="sd">        :type nmax: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_nmax_z</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nmax</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.nmax_ion"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.nmax_ion">[docs]</a>    <span class="k">def</span> <span class="nf">nmax_ion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">nmax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set this ion to maximum quantum number nmax.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        :param i: Ion number</span>
<span class="sd">        :type i: int</span>
<span class="sd">        :param nmax: Maximum principle quantum number to use.</span>
<span class="sd">        :type nmax: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_nmax_ion</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nmax</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>
    
    <span class="c1"># Set lmax</span>
<div class="viewcode-block" id="Ions.lmax_all"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.lmax_all">[docs]</a>    <span class="k">def</span> <span class="nf">lmax_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lmax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set all ions to maximum angular momentum lmax.</span>

<span class="sd">        :param lmax: Maximum angular momentum to use.</span>
<span class="sd">        :type lmax: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_lmax_all</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">lmax</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.lmax_iso"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.lmax_iso">[docs]</a>    <span class="k">def</span> <span class="nf">lmax_iso</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iso</span><span class="p">,</span> <span class="n">lmax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set this iso-electronic sequence to maximum angular momentum lmax.</span>

<span class="sd">        :param iso: Iso-electronic sequence.</span>
<span class="sd">        :type iso: int</span>
<span class="sd">        :param lmax: Maximum angular momentum to use.</span>
<span class="sd">        :type lmax: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_lmax_iso</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">lmax</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">iso</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.lmax_z"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.lmax_z">[docs]</a>    <span class="k">def</span> <span class="nf">lmax_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">lmax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set all ions of this element to maximum angular momentum lmax.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        :param lmax: Maximum angular momentum to use.</span>
<span class="sd">        :type lmax: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_lmax_z</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">lmax</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.lmax_ion"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.lmax_ion">[docs]</a>    <span class="k">def</span> <span class="nf">lmax_ion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">lmax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set this ion to maximum angular momentum lmax.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        :param i: Ion number</span>
<span class="sd">        :type i: int</span>
<span class="sd">        :param lmax: Maximum angular momentum to use.</span>
<span class="sd">        :type lmax: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_lmax_ion</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">lmax</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

    <span class="c1"># Set use</span>
<div class="viewcode-block" id="Ions.use_all"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.use_all">[docs]</a>    <span class="k">def</span> <span class="nf">use_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use all ions.&quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_use_all</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.use_iso"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.use_iso">[docs]</a>    <span class="k">def</span> <span class="nf">use_iso</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iso</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use this iso-electronic sequence.</span>

<span class="sd">        :param iso: Iso-electronic sequence.</span>
<span class="sd">        :type iso: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_use_iso</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">iso</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.use_z"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.use_z">[docs]</a>    <span class="k">def</span> <span class="nf">use_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use all ions of this element.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_use_z</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.use_ion"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.use_ion">[docs]</a>    <span class="k">def</span> <span class="nf">use_ion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use this ion.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        :param i: Ion number</span>
<span class="sd">        :type i: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_use_ion</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

    <span class="c1"># Set ignore</span>
<div class="viewcode-block" id="Ions.ignore_all"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.ignore_all">[docs]</a>    <span class="k">def</span> <span class="nf">ignore_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ignore all ions.&quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_ignore_all</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.ignore_iso"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.ignore_iso">[docs]</a>    <span class="k">def</span> <span class="nf">ignore_iso</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iso</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ignore this iso-electronic sequence.</span>

<span class="sd">        :param iso: Iso-electronic sequence.</span>
<span class="sd">        :type iso: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_ignore_iso</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">iso</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.ignore_z"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.ignore_z">[docs]</a>    <span class="k">def</span> <span class="nf">ignore_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ignore all ions of this element.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_ignore_z</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.ignore_ion"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.ignore_ion">[docs]</a>    <span class="k">def</span> <span class="nf">ignore_ion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ignore this ion.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        :param i: Ion number</span>
<span class="sd">        :type i: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_ignore_ion</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>
    
    <span class="c1"># Set new</span>
<div class="viewcode-block" id="Ions.new_all"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.new_all">[docs]</a>    <span class="k">def</span> <span class="nf">new_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use new calculations for all ions.&quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_new_all</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.new_iso"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.new_iso">[docs]</a>    <span class="k">def</span> <span class="nf">new_iso</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iso</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use new calculations for this iso-electronic sequence.</span>

<span class="sd">        :param iso: Iso-electronic sequence.</span>
<span class="sd">        :type iso: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_new_iso</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">iso</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.new_z"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.new_z">[docs]</a>    <span class="k">def</span> <span class="nf">new_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use new calculations for all ions of this element.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_new_z</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.new_ion"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.new_ion">[docs]</a>    <span class="k">def</span> <span class="nf">new_ion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use new calculations for this ion.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        :param i: Ion number</span>
<span class="sd">        :type i: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_new_ion</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

    <span class="c1"># Set old</span>
<div class="viewcode-block" id="Ions.old_all"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.old_all">[docs]</a>    <span class="k">def</span> <span class="nf">old_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use old calculations for all ions.&quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_old_all</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.old_iso"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.old_iso">[docs]</a>    <span class="k">def</span> <span class="nf">old_iso</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iso</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use old calculations for this iso-electronic sequence.</span>

<span class="sd">        :param iso: Iso-electronic sequence.</span>
<span class="sd">        :type iso: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_old_iso</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">iso</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.old_z"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.old_z">[docs]</a>    <span class="k">def</span> <span class="nf">old_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use old calculations for all ions of this element.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_old_z</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Ions.old_ion"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Ions.old_ion">[docs]</a>    <span class="k">def</span> <span class="nf">old_ion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use old calculations for this ion.</span>

<span class="sd">        :param z: Atomic number</span>
<span class="sd">        :type z: int</span>
<span class="sd">        :param i: Ion number</span>
<span class="sd">        :type i: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_ions</span><span class="o">.</span><span class="n">api_ion_old_ion</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div></div>
    

<div class="viewcode-block" id="Spectrum"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Spectrum">[docs]</a><span class="k">class</span> <span class="nc">Spectrum</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This class obtains and stores the model spectrum from SPEX.</span>

<span class="sd">    :ivar nbins: Number of bins</span>
<span class="sd">    :vartype nbins: int</span>
<span class="sd">    :ivar energy: Centroids of bins (Energy, keV)</span>
<span class="sd">    :vartype energy: numpy.ndarray</span>
<span class="sd">    :ivar energy_upper: Upper boundaries of bins (Energy, keV)</span>
<span class="sd">    :vartype energy_upper: numpy.ndarray</span>
<span class="sd">    :ivar energy_width: Widths of bins (Energy, keV)</span>
<span class="sd">    :vartype energy_width: numpy.ndarray</span>
<span class="sd">    :ivar spectrum: Spectrum of bins (in ph/s/m**2/bin at observatory)</span>
<span class="sd">    :vartype spectrum: numpy.ndarray</span>
<span class="sd">    :ivar luminosity: Spectrum of bins (in 10^44 ph/s/keV at source distance)</span>
<span class="sd">    :vartype luminosity: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbins</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Total number of bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Centroids of bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_upper</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Upper boundaries of bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_width</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Widths of bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Spectrum of bins (in ph/s/m**2/bin at observatory)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">luminosity</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Spectrum of bins (in 10^44 ph/s/keV at source distance)</span>

    <span class="k">def</span> <span class="nf">allocate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_upper</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_width</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">luminosity</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<div class="viewcode-block" id="Spectrum.get"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Spectrum.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the model spectra from SPEX for sector number isect.&quot;&quot;&quot;</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_spectrum</span><span class="o">.</span><span class="n">api_model_spectrum_total</span><span class="p">(</span><span class="n">isect</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nbins</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_spectrum</span><span class="o">.</span><span class="n">nbins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allocate</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_spectrum</span><span class="o">.</span><span class="n">energy_cent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy_upper</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_spectrum</span><span class="o">.</span><span class="n">energy_bupp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy_width</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_spectrum</span><span class="o">.</span><span class="n">energy_width</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spectrum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_spectrum</span><span class="o">.</span><span class="n">spectrum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">luminosity</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_spectrum</span><span class="o">.</span><span class="n">luminosity</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_spectrum</span><span class="o">.</span><span class="n">api_model_spectrum_final</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="Var"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var">[docs]</a><span class="k">class</span> <span class="nc">Var</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Various settings for the plasma models.</span>

<span class="sd">    :ivar gacc: Free-bound accuracy</span>
<span class="sd">    :vartype gacc: float</span>

<span class="sd">    :ivar line_ex: Electron excitation included</span>
<span class="sd">    :vartype line_ex: bool</span>
<span class="sd">    :ivar line_px: Proton excitation included</span>
<span class="sd">    :vartype line_px: bool</span>
<span class="sd">    :ivar line_rr: Radiative recombination included</span>
<span class="sd">    :vartype line_rr: bool</span>
<span class="sd">    :ivar line_dr: Di-electronic recombination included</span>
<span class="sd">    :vartype line_dr: bool</span>
<span class="sd">    :ivar line_ds: Di-electronic satellites included</span>
<span class="sd">    :vartype line_ds: bool</span>
<span class="sd">    :ivar line_ii: Inner shell ionisation included</span>
<span class="sd">    :vartype line_ii: bool</span>

<span class="sd">    :ivar doppler: Doppler broadening</span>
<span class="sd">    :vartype doppler: int</span>

<span class="sd">    :ivar newcalc: SPEXACT 3 calculations (False: SPEXACT 2)</span>
<span class="sd">    :vartype newcalc: bool</span>

<span class="sd">    :ivar occstart: Occupation calculations</span>
<span class="sd">    :vartype occstart: int</span>

<span class="sd">    :ivar mekal_wav: Wavelength corrections according to the work of Phillips et al. (1999)</span>
<span class="sd">    :vartype mekal_wav: bool</span>
<span class="sd">    :ivar mekal_fe17: The strongest Fe XVII lines by Doron &amp; Behar (2002).</span>
<span class="sd">    :vartype mekal_fe17: bool</span>
<span class="sd">    :ivar mekal_update: Several minor corrections</span>
<span class="sd">    :vartype mekal_update: book</span>

<span class="sd">    :ivar ibalmaxw: Multi-Maxwellians for the ionisation balance</span>
<span class="sd">    :vartype ibalmaxw: bool</span>

<span class="sd">    :ivar newcoolexc: Cooling by collisional excitation by Stofanova (SPEXACT 3)</span>
<span class="sd">    :vartype newcoolexc: bool</span>
<span class="sd">    :ivar newcooldr: Cooling by dielectronic recombination (SPEXACT 3)</span>
<span class="sd">    :vartype newcooldr: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gacc</span> <span class="o">=</span> <span class="mf">0.</span>          <span class="c1"># Free-bound accuracy</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">line_ex</span> <span class="o">=</span> <span class="kc">True</span>     <span class="c1"># Electron excitation included</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_px</span> <span class="o">=</span> <span class="kc">True</span>     <span class="c1"># Proton excitation included</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_rr</span> <span class="o">=</span> <span class="kc">True</span>     <span class="c1"># Radiative recombination included</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_dr</span> <span class="o">=</span> <span class="kc">True</span>     <span class="c1"># Dielectronic recombination included</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_ds</span> <span class="o">=</span> <span class="kc">True</span>     <span class="c1"># Dielectronic satellites included</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_ii</span> <span class="o">=</span> <span class="kc">True</span>     <span class="c1"># Inner shell ionisation included</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doppler</span> <span class="o">=</span> <span class="mi">2</span>        <span class="c1"># Doppler broadening</span>
                                <span class="c1"># 1 = No broadening at all</span>
                                <span class="c1"># 2 = Only Doppler broadening (default)</span>
                                <span class="c1"># 3 = Only natural broadening (works only for var calc new)</span>
                                <span class="c1"># 4 = Doppler and natural broadening, Voigt profiles (best physical representation,</span>
                                <span class="c1">#     works only for var calc new)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">newcalc</span> <span class="o">=</span> <span class="kc">False</span>       <span class="c1"># SPEXACT 3 calculations (False: SPEXACT 2)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">occstart</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># Occupation calculations</span>
                                <span class="c1"># 0 = from ground state</span>
                                <span class="c1"># 1 = from Boltzmann distribution</span>
                                <span class="c1"># 2 = from last calculation</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mekal_wav</span> <span class="o">=</span> <span class="kc">True</span>    <span class="c1"># Wavelength corrections according to the work of Phillips et al. (1999)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mekal_fe17</span> <span class="o">=</span> <span class="kc">True</span>   <span class="c1"># The strongest Fe XVII lines by Doron &amp; Behar (2002).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mekal_update</span> <span class="o">=</span><span class="kc">True</span>  <span class="c1"># Several minor corrections</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ibalmaxw</span> <span class="o">=</span> <span class="kc">True</span>     <span class="c1"># Multi-Maxwellians for the ionisation balance</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">newcoolexc</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Cooling by collisional excitation by Stofanova (SPEXACT 3)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newcooldr</span> <span class="o">=</span> <span class="kc">False</span>   <span class="c1"># Cooling by dielectronic recombination (SPEXACT 3)</span>

<div class="viewcode-block" id="Var.update"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the current plasma model settings from SPEX.&quot;&quot;&quot;</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">api_var_update</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gacc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_gacc</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">line_ex</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_line_ex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_px</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_line_px</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_rr</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_line_rr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_dr</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_line_dr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_ds</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_line_ds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_ii</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_line_ii</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doppler</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_line_doppler</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">newcalc</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_calc</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">occstart</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_occstart</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mekal_wav</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_mekal_wav</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mekal_fe17</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_mekal_fe17</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mekal_update</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_mekal_update</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ibalmaxw</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_ibalmaxw</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">newcoolexc</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_newcoolexc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newcooldr</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_model_var</span><span class="o">.</span><span class="n">var_newcooldr</span><span class="p">)</span></div>

<div class="viewcode-block" id="Var.set_gacc"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.set_gacc">[docs]</a>    <span class="k">def</span> <span class="nf">set_gacc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the free-bound emission accuracy.</span>

<span class="sd">        :param value: Free-bound emission accuracy.</span>
<span class="sd">        :type value: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var gacc </span><span class="si">{:e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Var.reset_gacc"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.reset_gacc">[docs]</a>    <span class="k">def</span> <span class="nf">reset_gacc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset the free-bound emission accuracy.&quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;var gacc reset&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Var.set_line"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.set_line">[docs]</a>    <span class="k">def</span> <span class="nf">set_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ltype</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a line emission contribution on or off.</span>

<span class="sd">        :param ltype: Line emission contribution (&#39;ex&#39;, &#39;px&#39;, &#39;rr&#39;, &#39;dr&#39;, &#39;ds&#39;, &#39;ii&#39;, &#39;reset&#39;)</span>
<span class="sd">        :type ltype: str</span>
<span class="sd">        :param status: Boolean indicator whether contribution is on (True) or off (False).</span>
<span class="sd">        :type status: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ltype</span> <span class="o">==</span> <span class="s1">&#39;reset&#39;</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var line reset&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
                <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var line </span><span class="si">{:s}</span><span class="s1"> true&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var line </span><span class="si">{:s}</span><span class="s1"> false&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltype</span><span class="p">)</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="Var.set_doppler"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.set_doppler">[docs]</a>    <span class="k">def</span> <span class="nf">set_doppler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Doppler broadening.</span>

<span class="sd">        :param value: Doppler broadening type.</span>
<span class="sd">        :type value: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">com</span> <span class="o">=</span> <span class="s2">&quot;var doppler </span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Var.set_calc"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.set_calc">[docs]</a>    <span class="k">def</span> <span class="nf">set_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Perform SPEXACT 3 line calculations.</span>

<span class="sd">        :param status: Use SPEXACT 3 (True) or SPEXACT 2 (False)</span>
<span class="sd">        :type status: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
            <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;var calc new&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;var calc old&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Var.set_occstart"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.set_occstart">[docs]</a>    <span class="k">def</span> <span class="nf">set_occstart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;At which occupation level to start.</span>

<span class="sd">        :param otype: Occupation level (&#39;ground&#39;, &#39;boltz&#39;, &#39;last&#39;)</span>
<span class="sd">        :type otype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var occstart &#39;</span><span class="o">+</span><span class="n">otype</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Var.set_mekal"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.set_mekal">[docs]</a>    <span class="k">def</span> <span class="nf">set_mekal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utype</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch old Mekal updates on/off.</span>

<span class="sd">        :param utype: Update type (&#39;wav&#39;, &#39;fe17&#39;, &#39;update&#39;, &#39;all&#39;)</span>
<span class="sd">        :type utype: str</span>
<span class="sd">        :param status: On (True) or off (False)</span>
<span class="sd">        :type status: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var newmekal </span><span class="si">{:s}</span><span class="s1"> true&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">utype</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var newmekal </span><span class="si">{:s}</span><span class="s1"> false&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">utype</span><span class="p">)</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Var.set_ibalmaxw"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.set_ibalmaxw">[docs]</a>    <span class="k">def</span> <span class="nf">set_ibalmaxw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch the Multi-Maxwellians for the ionisation balance on/off (True/False).</span>

<span class="sd">        :param status: On (True) or off (False)</span>
<span class="sd">        :type status: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var ibalmaxw true&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var ibalmaxw false&#39;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Var.set_newcoolexc"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.set_newcoolexc">[docs]</a>    <span class="k">def</span> <span class="nf">set_newcoolexc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cooling by collisional excitation by Stofanova (SPEXACT 3) on/off (True/False).</span>

<span class="sd">        :param status: On (True) or off (False)</span>
<span class="sd">        :type status: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var newcoolexc true&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var newcoolexc true&#39;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div>

<div class="viewcode-block" id="Var.set_newcooldr"><a class="viewcode-back" href="../../pyspex/model.html#pyspex.model.Var.set_newcooldr">[docs]</a>    <span class="k">def</span> <span class="nf">set_newcooldr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cooling by dielectronic recombination (SPEXACT 3) on/off (True/False).</span>

<span class="sd">        :param status: On (True) or off (False)</span>
<span class="sd">        :type status: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var newcooldr true&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">com</span> <span class="o">=</span> <span class="s1">&#39;var newcooldr false&#39;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ier</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo-wide.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getstarted.html">1. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../threads.html">2. Analysis threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">3. Command overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">4. Spectral models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">5. Additional tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyspex.html">6. Python Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help.html">7. Help &amp; troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory.html">8. SPEX Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exercises.html">9. Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">10. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">11. Credits</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
        Last updated on: Jul 13, 2020.<br>
    
        &copy;2020, Jelle de Plaa, Jelle Kaastra, SPEX Development Team, <a href="https://www.sron.nl/">SRON Netherlands Institute for Space Research</a>.
    

</div>

  </body>
</html>