
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pyspex.ascdump &#8212; SPEX Help Center 3.06.01 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="canonical" href="https://spex-xray.github.io/spex-help/_modules/pyspex/ascdump.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for pyspex.ascdump</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1"># Stuff to import for compatibility between python 2 and 3</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">unicode_literals</span>

<span class="kn">from</span> <span class="nn">builtins</span> <span class="k">import</span> <span class="nb">int</span>

<span class="kn">from</span> <span class="nn">future</span> <span class="k">import</span> <span class="n">standard_library</span>

<span class="n">standard_library</span><span class="o">.</span><span class="n">install_aliases</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">pyspex</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">utils</span>
<span class="kn">import</span> <span class="nn">numpy</span>


<span class="k">class</span> <span class="nc">Ascdump</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>


<div class="viewcode-block" id="Plas"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Plas">[docs]</a><span class="k">class</span> <span class="nc">Plas</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output for the command ascdump plas.</span>

<span class="sd">    :ivar t: Electron temperature (keV).</span>
<span class="sd">    :vartype t: float</span>
<span class="sd">    :ivar elden: Electron density/1E20 (/m**3).</span>
<span class="sd">    :vartype elden: float</span>
<span class="sd">    :ivar hden: Hydrogen density/1E20 (/m**3).</span>
<span class="sd">    :vartype hden: float</span>
<span class="sd">    :ivar ed: Electron/Hydrogen density.</span>
<span class="sd">    :vartype ed: float</span>
<span class="sd">    :ivar pdion: (Electron + Ion)/Hydrogen density.</span>
<span class="sd">    :vartype pdion: float</span>
<span class="sd">    :ivar denmas: Mass density / (n_H * m_p).</span>
<span class="sd">    :vartype denmas: float</span>
<span class="sd">    :ivar cs: Sound speed (km/s).</span>
<span class="sd">    :vartype cs: float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="mf">0.</span>       <span class="c1"># Electron temperature (keV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elden</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># Electron density/1E20 (/m**3)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hden</span> <span class="o">=</span> <span class="mf">0.</span>    <span class="c1"># Hydrogen density/1E20 (/m**3)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ed</span> <span class="o">=</span> <span class="mf">0.</span>      <span class="c1"># Electron/Hydrogen density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdion</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># (Electron + Ion)/Hydrogen density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">denmas</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Mass density / (n_H * m_p)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cs</span> <span class="o">=</span> <span class="mf">0.</span>      <span class="c1"># Sound speed (km/s)</span>

<div class="viewcode-block" id="Plas.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Plas.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the plasma parameters from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_plas</span><span class="o">.</span><span class="n">plas_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_plas</span><span class="o">.</span><span class="n">plas_t</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elden</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_plas</span><span class="o">.</span><span class="n">plas_elden</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hden</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_plas</span><span class="o">.</span><span class="n">plas_hden</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ed</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_plas</span><span class="o">.</span><span class="n">plas_ed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdion</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_plas</span><span class="o">.</span><span class="n">plas_pdion</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">denmas</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_plas</span><span class="o">.</span><span class="n">plas_denmas</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_plas</span><span class="o">.</span><span class="n">plas_cs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Abun"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Abun">[docs]</a><span class="k">class</span> <span class="nc">Abun</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output for the command ascdump abun.</span>

<span class="sd">    :ivar nz: Number of elements.</span>
<span class="sd">    :vartype nz: int</span>
<span class="sd">    :ivar atom: Atomic number.</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name.</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar relabn: Abundance in solar units.</span>
<span class="sd">    :vartype relabn: numpy.ndarray</span>
<span class="sd">    :ivar absabn: Absolute abundance.</span>
<span class="sd">    :vartype absabn: numpy.ndarray</span>
<span class="sd">    :ivar charge: Average charge.</span>
<span class="sd">    :vartype charge: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">=</span> <span class="mi">0</span>                    <span class="c1"># Number of elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Atomic number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relabn</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Abundance in solar units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">absabn</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Absolute abundance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Average charge</span>

<div class="viewcode-block" id="Abun.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Abun.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the abundance information from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_abun</span><span class="o">.</span><span class="n">abun_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_abun</span><span class="o">.</span><span class="n">abun_nz</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relabn</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">absabn</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_abun</span><span class="o">.</span><span class="n">abun_element</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">relabn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_abun</span><span class="o">.</span><span class="n">abun_relabun</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">absabn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_abun</span><span class="o">.</span><span class="n">abun_conele</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_abun</span><span class="o">.</span><span class="n">abun_charge</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_abun</span><span class="o">.</span><span class="n">abun_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Icon"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Icon">[docs]</a><span class="k">class</span> <span class="nc">Icon</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Ascdump output containing the ion concentrations.</span>

<span class="sd">    :ivar nline: Number of entries</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar atom: Atomic number.</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage.</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name.</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman).</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar charge: Ion charge.</span>
<span class="sd">    :vartype charge: numpy.ndarray</span>
<span class="sd">    :ivar conrel: Relative ion concentration.</span>
<span class="sd">    :vartype conrel: numpy.ndarray</span>
<span class="sd">    :ivar conabs: Absolute ion concentration.</span>
<span class="sd">    :vartype conabs: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Atomic number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Ion charge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conrel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Relative ion concentration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conabs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Absolute ion concentration</span>

<div class="viewcode-block" id="Icon.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Icon.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the ion concentrations from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_icon</span><span class="o">.</span><span class="n">icon_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_icon</span><span class="o">.</span><span class="n">icon_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conrel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conabs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_icon</span><span class="o">.</span><span class="n">icon_atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_icon</span><span class="o">.</span><span class="n">icon_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conrel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_icon</span><span class="o">.</span><span class="n">icon_conrel</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conabs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_icon</span><span class="o">.</span><span class="n">icon_conion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_icon</span><span class="o">.</span><span class="n">icon_charge</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_icon</span><span class="o">.</span><span class="n">icon_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Rate"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Rate">[docs]</a><span class="k">class</span> <span class="nc">Rate</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output for the command ascdump rate.</span>

<span class="sd">    :ivar nline: Number of entries.</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar atom: Atomic number.</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage.</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name.</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman).</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar irate: Ionisation rate.</span>
<span class="sd">    :vartype irate: numpy.ndarray</span>
<span class="sd">    :ivar rrate: Recombination rate.</span>
<span class="sd">    :vartype rrate: numpy.ndarray</span>
<span class="sd">    :ivar ceirate: Charge transfer ionisation rate.</span>
<span class="sd">    :vartype ceirate: numpy.ndarray</span>
<span class="sd">    :ivar cerrate: Charge transfer recombination rate.</span>
<span class="sd">    :vartype cerrate: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Atomic number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Ionisation rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Recombination rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ceirate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Charge transfer ionisation rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cerrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Charge transfer recombination rate</span>

<div class="viewcode-block" id="Rate.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Rate.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the rates from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rate</span><span class="o">.</span><span class="n">rate_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rate</span><span class="o">.</span><span class="n">rate_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">irate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ceirate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cerrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rate</span><span class="o">.</span><span class="n">rate_atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rate</span><span class="o">.</span><span class="n">rate_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">irate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rate</span><span class="o">.</span><span class="n">rate_siont</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rrate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rate</span><span class="o">.</span><span class="n">rate_alfa</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ceirate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rate</span><span class="o">.</span><span class="n">rate_ceirat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cerrate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rate</span><span class="o">.</span><span class="n">rate_cerrat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rate</span><span class="o">.</span><span class="n">rate_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Rion"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Rion">[docs]</a><span class="k">class</span> <span class="nc">Rion</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Ionisation rates per subshell.</span>

<span class="sd">    :ivar nline: Number of entries</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar atom: Atomic number</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman)</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar shell: Shell number</span>
<span class="sd">    :vartype shell: numpy.ndarray</span>
<span class="sd">    :ivar shname: Shell name</span>
<span class="sd">    :vartype shname: numpy.ndarray</span>
<span class="sd">    :ivar phion: Photon ionisation rate (/s/ion)</span>
<span class="sd">    :vartype phion: numpy.ndarray</span>
<span class="sd">    :ivar cpion: Compton ionisation rate (/s/ion)</span>
<span class="sd">    :vartype cpion: numpy.ndarray</span>
<span class="sd">    :ivar elion: Electron ionisation rate (/s/ion)</span>
<span class="sd">    :vartype elion: numpy.ndarray</span>
<span class="sd">    :ivar phheat: Photon heating (keV/ion)</span>
<span class="sd">    :vartype phheat: numpy.ndarray</span>
<span class="sd">    :ivar cpheat: Compton heating (keV/ion)</span>
<span class="sd">    :vartype cpheat: numpy.ndarray</span>
<span class="sd">    :ivar elcool: Electron cooling (kev/ion)</span>
<span class="sd">    :vartype elcool: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Atomic number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shell</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Shell number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shname</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Shell name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Photon ionisation rate (/s/ion)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Compton ionisation rate (/s/ion)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Electron ionisation rate (/s/ion)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phheat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Photon heating (keV/ion)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpheat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Compton heating (keV/ion)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elcool</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Electron cooling (kev/ion)</span>

<div class="viewcode-block" id="Rion.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Rion.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the ionisation rates per subshell.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_nline</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shell</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shname</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phheat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpheat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elcool</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_shell</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shname</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atomshell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">phion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_phion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cpion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_cpion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_elion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">phheat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_phheat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cpheat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_cpheat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elcool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_elcool</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rion</span><span class="o">.</span><span class="n">rion_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Pop"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Pop">[docs]</a><span class="k">class</span> <span class="nc">Pop</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The occupation numbers as well as upwards/downwards loss and gain rates to all quantum levels included.</span>

<span class="sd">    :ivar nlev: Number of levels</span>
<span class="sd">    :vartype nlev: int</span>
<span class="sd">    :ivar num: Level number</span>
<span class="sd">    :vartype num: numpy.ndarray</span>
<span class="sd">    :ivar atom: Atomic number</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ion charge</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman)</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar conf: Configuration of level</span>
<span class="sd">    :vartype conf: numpy.ndarray</span>
<span class="sd">    :ivar ener: Energy of level (keV)</span>
<span class="sd">    :vartype ener: numpy.ndarray</span>
<span class="sd">    :ivar occ: Population (sum=1)</span>
<span class="sd">    :vartype occ: numpy.ndarray</span>
<span class="sd">    :ivar occlte: Pop/PopLTE</span>
<span class="sd">    :vartype occlte: numpy.ndarray</span>
<span class="sd">    :ivar cascade: Cascade (per s)</span>
<span class="sd">    :vartype cascade: numpy.ndarray</span>
<span class="sd">    :ivar excite: Excitation (per s)</span>
<span class="sd">    :vartype excite: numpy.ndarray</span>
<span class="sd">    :ivar down: Down loss (per s)</span>
<span class="sd">    :vartype down: numpy.ndarray</span>
<span class="sd">    :ivar up: Upward loss (per s)</span>
<span class="sd">    :vartype up: numpy.ndarray</span>
<span class="sd">    :ivar arr: Radiative recombination (per s)</span>
<span class="sd">    :vartype arr: numpy.ndarray</span>
<span class="sd">    :ivar adr: Dielectronic recombination (per s)</span>
<span class="sd">    :vartype adr: numpy.ndarray</span>
<span class="sd">    :ivar aii: Innershell ionisation (per s)</span>
<span class="sd">    :vartype aii: numpy.ndarray</span>
<span class="sd">    :ivar cxrr: Charge exchange (per s)</span>
<span class="sd">    :vartype cxrr: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlev</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Level number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Atomic number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Ion charge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Configuration of level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Energy of level (keV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occ</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Population (sum=1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occlte</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Pop/PopLTE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cascade</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Cascade (per s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">excite</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Excitation (per s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Down loss (per s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>       <span class="c1"># Upward loss (per s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Radiative recombination (per s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Dielectronic recombination (per s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aii</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Innershell ionisation (per s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cxrr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Charge exchange (per s)</span>

<div class="viewcode-block" id="Pop.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Pop.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the occupation numbers from SPEX.&quot;&quot;&quot;</span>

        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlev</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_nlev</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">occ</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">occlte</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cascade</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">excite</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aii</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cxrr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlev</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_num</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_elem</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_get_config</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ener</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_ener</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">occ</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_occ</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">occlte</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_occlte</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cascade</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_cascade</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">excite</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_excite</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_down</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_up</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">adr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_adr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">aii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_aii</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cxrr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_cxrr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_pop</span><span class="o">.</span><span class="n">pop_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Elex"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Elex">[docs]</a><span class="k">class</span> <span class="nc">Elex</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output the collisional excitation and de-excitation rates due to collisions with electrons.</span>

<span class="sd">    :ivar nline: Number of transitions.</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar il: Number of lower level</span>
<span class="sd">    :vartype il: numpy.ndarray</span>
<span class="sd">    :ivar iu: Number of upper level</span>
<span class="sd">    :vartype iu: numpy.ndarray</span>
<span class="sd">    :ivar atom: Element number (atomic number)</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman)</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar al: Configuration of lower level</span>
<span class="sd">    :vartype al: numpy.ndarray</span>
<span class="sd">    :ivar au: Configuration of upper level</span>
<span class="sd">    :vartype au: numpy.ndarray</span>
<span class="sd">    :ivar upsilon: Upsilon</span>
<span class="sd">    :vartype upsilon: numpy.ndarray</span>
<span class="sd">    :ivar gbar: Gbar</span>
<span class="sd">    :vartype gbar: numpy.ndarray</span>
<span class="sd">    :ivar exrate: Excitation rate (/atom/s)</span>
<span class="sd">    :vartype exrate: numpy.ndarray</span>
<span class="sd">    :ivar dexrate: De-excitation rate (/atom/s)</span>
<span class="sd">    :vartype dexrate: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>                <span class="c1"># Number of transitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">il</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Lower level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iu</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Upper level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Element number (atomic number)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Configuration lower level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Configuration upper level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upsilon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Upsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gbar</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Gbar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Excitation rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dexrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># De-excitation rate</span>
        
<div class="viewcode-block" id="Elex.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Elex.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the collisional excitation and de-excitation rates due to collisions with electrons from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">il</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iu</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">upsilon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gbar</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dexrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">il</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_il</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_iu</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_elem</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">al</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_get_al</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">au</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_get_au</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">upsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_upsilon</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_gbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exrate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_excrate</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dexrate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_dexcrate</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_elex</span><span class="o">.</span><span class="n">elex_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Prex"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Prex">[docs]</a><span class="k">class</span> <span class="nc">Prex</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output the collisional excitation and de-excitation rates due to collisions with protons.</span>

<span class="sd">    :ivar nline: Number of transitions.</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar il: Number of lower level</span>
<span class="sd">    :vartype il: numpy.ndarray</span>
<span class="sd">    :ivar iu: Number of upper level</span>
<span class="sd">    :vartype iu: numpy.ndarray</span>
<span class="sd">    :ivar atom: Element number (atomic number)</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman)</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar al: Configuration of lower level</span>
<span class="sd">    :vartype al: numpy.ndarray</span>
<span class="sd">    :ivar au: Configuration of upper level</span>
<span class="sd">    :vartype au: numpy.ndarray</span>
<span class="sd">    :ivar exrate: Excitation rate (/atom/s)</span>
<span class="sd">    :vartype exrate: numpy.ndarray</span>
<span class="sd">    :ivar dexrate: De-excitation rate (/atom/s)</span>
<span class="sd">    :vartype dexrate: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>                <span class="c1"># Number of transitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">il</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Lower level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iu</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Upper level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Element number (atomic number)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Configuration lower level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Configuration upper level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Excitation rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dexrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># De-excitation rate</span>
        
<div class="viewcode-block" id="Prex.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Prex.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the collisional excitation and de-excitation rates due to collisions with protons from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">il</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iu</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dexrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">il</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_il</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_iu</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_elem</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">al</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_get_al</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">au</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_get_au</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exrate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_excrate</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dexrate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_dexcrate</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_prex</span><span class="o">.</span><span class="n">prex_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Rad"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Rad">[docs]</a><span class="k">class</span> <span class="nc">Rad</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output the radiative transition rates from each level</span>

<span class="sd">    :ivar nline: Number of transitions.</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar il: Number of lower level</span>
<span class="sd">    :vartype il: numpy.ndarray</span>
<span class="sd">    :ivar iu: Number of upper level</span>
<span class="sd">    :vartype iu: numpy.ndarray</span>
<span class="sd">    :ivar atom: Element number (atomic number)</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman)</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar al: Configuration of lower level</span>
<span class="sd">    :vartype al: numpy.ndarray</span>
<span class="sd">    :ivar au: Configuration of upper level</span>
<span class="sd">    :vartype au: numpy.ndarray</span>
<span class="sd">    :ivar prob: Transition probability</span>
<span class="sd">    :vartype prob: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>                <span class="c1"># Number of transitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">il</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Lower level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iu</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Upper level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Element number (atomic number)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Configuration lower level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Configuration upper level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Transition probability</span>

<div class="viewcode-block" id="Rad.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Rad.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the radiative transition probablilities from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rad</span><span class="o">.</span><span class="n">rad_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rad</span><span class="o">.</span><span class="n">rad_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">il</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iu</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">il</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rad</span><span class="o">.</span><span class="n">rad_il</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rad</span><span class="o">.</span><span class="n">rad_iu</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rad</span><span class="o">.</span><span class="n">rad_elem</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rad</span><span class="o">.</span><span class="n">rad_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">al</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rad</span><span class="o">.</span><span class="n">rad_get_al</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">au</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rad</span><span class="o">.</span><span class="n">rad_get_au</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rad</span><span class="o">.</span><span class="n">rad_prob</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rad</span><span class="o">.</span><span class="n">rad_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Two"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Two">[docs]</a><span class="k">class</span> <span class="nc">Two</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output the two-photon emission transition rates from each level.</span>

<span class="sd">    :ivar nline: Number of two-photon transitions.</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar il: Number of lower level</span>
<span class="sd">    :vartype il: numpy.ndarray</span>
<span class="sd">    :ivar iu: Number of upper level</span>
<span class="sd">    :vartype iu: numpy.ndarray</span>
<span class="sd">    :ivar atom: Element number (atomic number)</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman)</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar al: Configuration of lower level</span>
<span class="sd">    :vartype al: numpy.ndarray</span>
<span class="sd">    :ivar au: Configuration of upper level</span>
<span class="sd">    :vartype au: numpy.ndarray</span>
<span class="sd">    :ivar prob: Transition probability</span>
<span class="sd">    :vartype prob: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>                <span class="c1"># Number of transitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">il</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Lower level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iu</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Upper level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Element number (atomic number)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Configuration lower level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Configuration upper level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Transition probability</span>

<div class="viewcode-block" id="Two.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Two.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the two-photon transition probablilities from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_two</span><span class="o">.</span><span class="n">two_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_two</span><span class="o">.</span><span class="n">two_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">il</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iu</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">il</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_two</span><span class="o">.</span><span class="n">two_il</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_two</span><span class="o">.</span><span class="n">two_iu</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_two</span><span class="o">.</span><span class="n">two_elem</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_two</span><span class="o">.</span><span class="n">two_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">al</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_two</span><span class="o">.</span><span class="n">two_get_al</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">au</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_two</span><span class="o">.</span><span class="n">two_get_au</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_two</span><span class="o">.</span><span class="n">two_prob</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_two</span><span class="o">.</span><span class="n">two_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Time"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Time">[docs]</a><span class="k">class</span> <span class="nc">Time</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Recombination time scale per ion according to the Bottorf et al. (2000) definition,</span>
<span class="sd">    and relative ion concentrations. Note that the recombination time scale depends upon</span>
<span class="sd">    the hydrogen density, so do not forget to set the relevant density in the model.</span>

<span class="sd">    :ivar nline: Number of two-photon transitions.</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar atom: Element number (atomic number)</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman)</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar texp: Time scale (s)</span>
<span class="sd">    :vartype texp: numpy.ndarray</span>
<span class="sd">    :ivar conrel: Relative concentration</span>
<span class="sd">    :vartype conrel: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>                 <span class="c1"># Number of transitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Element number (atomic number)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">texp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Time scale (s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conrel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Relative concentration</span>

<div class="viewcode-block" id="Time.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Time.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the ionisation/recombination time scale for each ion from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_time</span><span class="o">.</span><span class="n">time_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_time</span><span class="o">.</span><span class="n">time_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">texp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conrel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_time</span><span class="o">.</span><span class="n">time_elem</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_time</span><span class="o">.</span><span class="n">time_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">texp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_time</span><span class="o">.</span><span class="n">time_texp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conrel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_time</span><span class="o">.</span><span class="n">time_conrel</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_time</span><span class="o">.</span><span class="n">time_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Rec"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Rec">[docs]</a><span class="k">class</span> <span class="nc">Rec</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Outputs for each atomic level the populating contributions from radiative,</span>
<span class="sd">    dielectronic and charge exchange recombination, as well as inner-shell ionisation.</span>

<span class="sd">    :ivar nline: Number of two-photon transitions.</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar ilev: Level number.</span>
<span class="sd">    :vartype ilev: numpy.ndarray</span>
<span class="sd">    :ivar atom: Element number (atomic number)</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman)</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar tran: Transition type</span>
<span class="sd">    :vartype tran: numpy.ndarray</span>
<span class="sd">    :ivar arr: Radiative recombination rate (1E-20m**3/s).</span>
<span class="sd">    :vartype arr: numpy.ndarray</span>
<span class="sd">    :ivar adr: Di-electronic recombination rate (1E-20m**3/s).</span>
<span class="sd">    :vartype adr: numpy.ndarray</span>
<span class="sd">    :ivar cxrr: Charge exchange recombination rate (1E-20m**3/s).</span>
<span class="sd">    :vartype arr: numpy.ndarray</span>
<span class="sd">    :ivar aii: Inner-shell ionisation rate (1E-20m**3/s).</span>
<span class="sd">    :vartype arr: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>                <span class="c1"># Number of transitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilev</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Level number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Element number (atomic number)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tran</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Transition type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Radiative recombination rate (1E-20m**3/s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Di-electronic recombination rate (1E-20m**3/s).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cxrr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Charge exchange recombination rate (1E-20m**3/s).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aii</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Inner-shell ionisation rate (1E-20m**3/s).</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the recombination rates per level from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilev</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tran</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cxrr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aii</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ilev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_ilev</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_elem</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tran</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_get_tran</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">adr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_adr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cxrr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_cxrr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">aii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_aii</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_rec</span><span class="o">.</span><span class="n">rec_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div>


<div class="viewcode-block" id="Grid"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Grid">[docs]</a><span class="k">class</span> <span class="nc">Grid</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output the last used energy/wavelength grid used in the model.</span>

<span class="sd">    :ivar nbin: Number of energy bins.</span>
<span class="sd">    :vartype nbin: int</span>
<span class="sd">    :ivar ibin: Bin number.</span>
<span class="sd">    :vartype ibin: numpy.ndarray</span>
<span class="sd">    :ivar elow: Low energy boundary of bin (keV).</span>
<span class="sd">    :vartype elow: numpy.ndarray</span>
<span class="sd">    :ivar eupp: Upper energy boundary of bin (keV).</span>
<span class="sd">    :vartype eupp: numpy.ndarray</span>
<span class="sd">    :ivar ewidth: Width of the bin (keV).</span>
<span class="sd">    :vartype ewidth: numpy.ndarray</span>
<span class="sd">    :ivar emean: Mean energy of the bin (keV).</span>
<span class="sd">    :vartype emean: numpy.ndarray</span>
<span class="sd">    :ivar wave: Wavelength of the bin (Angstrom).</span>
<span class="sd">    :vartype wave: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="mi">0</span>                  <span class="c1"># Number of energy bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ibin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Bin number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elow</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Low energy boundary of bin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eupp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Upper energy boundary of bin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ewidth</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Width of the bin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Mean energy of the bin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wave</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Wavelength of the bin</span>

<div class="viewcode-block" id="Grid.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Grid.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the energy grid from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_grid</span><span class="o">.</span><span class="n">grid_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_grid</span><span class="o">.</span><span class="n">grid_nbin</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ibin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elow</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eupp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ewidth</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wave</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ibin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_grid</span><span class="o">.</span><span class="n">grid_bin</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elow</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_grid</span><span class="o">.</span><span class="n">grid_elow</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eupp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_grid</span><span class="o">.</span><span class="n">grid_eupp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ewidth</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_grid</span><span class="o">.</span><span class="n">grid_ewidth</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">emean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_grid</span><span class="o">.</span><span class="n">grid_emean</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wave</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_grid</span><span class="o">.</span><span class="n">grid_wave</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_grid</span><span class="o">.</span><span class="n">grid_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Clin"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Clin">[docs]</a><span class="k">class</span> <span class="nc">Clin</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output the continuum, line and total flux for each energy bin.</span>

<span class="sd">    :ivar nbin: Number of energy bins.</span>
<span class="sd">    :vartype nbin: int</span>
<span class="sd">    :ivar ibin: Bin number.</span>
<span class="sd">    :vartype ibin: numpy.ndarray</span>
<span class="sd">    :ivar emean: Mean energy of the bin (keV).</span>
<span class="sd">    :vartype emean: numpy.ndarray</span>
<span class="sd">    :ivar fluxcon: Continuum flux (:math:`10^{44}` ph/s/keV).</span>
<span class="sd">    :vartype fluxcon: numpy.ndarray</span>
<span class="sd">    :ivar fluxlin: Line flux (:math:`10^{44}` ph/s/keV).</span>
<span class="sd">    :vartype fluxlin: numpy.ndarray</span>
<span class="sd">    :ivar flux: Total flux (:math:`10^{44}` ph/s/keV).</span>
<span class="sd">    :vartype flux: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="mi">0</span>                   <span class="c1"># Number of energy bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ibin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Bin number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Mean energy of the bin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluxcon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Continuum flux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluxlin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Line flux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Total flux</span>
        
<div class="viewcode-block" id="Clin.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Clin.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the continuum, line and total fluxes from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_clin</span><span class="o">.</span><span class="n">clin_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_clin</span><span class="o">.</span><span class="n">clin_nbin</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ibin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fluxcon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fluxlin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ibin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_clin</span><span class="o">.</span><span class="n">clin_bin</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">emean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_clin</span><span class="o">.</span><span class="n">clin_emean</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fluxcon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_clin</span><span class="o">.</span><span class="n">clin_flxcon</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fluxlin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_clin</span><span class="o">.</span><span class="n">clin_flxlin</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_clin</span><span class="o">.</span><span class="n">clin_flx</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_clin</span><span class="o">.</span><span class="n">clin_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Line"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Line">[docs]</a><span class="k">class</span> <span class="nc">Line</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The line energy and wavelength, as well as the total line emission (photons/s)</span>
<span class="sd">    for each line contributing to the spectrum, for the last plasma layer of the model.</span>
<span class="sd">    Also given is the natural line width and the Doppler broadening (including thermal</span>
<span class="sd">    and turbulent broadening), expressed as a FWHM in keV.</span>

<span class="sd">    :ivar nline: Number of lines in output.</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar id: Line ID number</span>
<span class="sd">    :vartype id: numpy.ndarray</span>
<span class="sd">    :ivar atom: Atomic number</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman)</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar al: Lower level configuration</span>
<span class="sd">    :vartype al: numpy.ndarray</span>
<span class="sd">    :ivar au: Upper level configuration</span>
<span class="sd">    :vartype au: numpy.ndarray</span>
<span class="sd">    :ivar ener: Line energy (keV)</span>
<span class="sd">    :vartype ener: numpy.ndarray</span>
<span class="sd">    :ivar wave: Line wavelength (Ang)</span>
<span class="sd">    :vartype wave: numpy.ndarray</span>
<span class="sd">    :ivar flux: Line strength in photons/s</span>
<span class="sd">    :vartype flux: numpy.ndarray</span>
<span class="sd">    :ivar width: Natural line width (FWHM)</span>
<span class="sd">    :vartype width: numpy.ndarray</span>
<span class="sd">    :ivar dopp: Doppler line width (FWHM)</span>
<span class="sd">    :vartype dopp: numpy.ndarray</span>
<span class="sd">    :ivar tau: Optical depth at line center (calculated)</span>
<span class="sd">    :vartype tau: numpy.ndarray</span>
<span class="sd">    :ivar pescl: Single flight line escape factor (calculated)</span>
<span class="sd">    :vartype pescl: numpy.ndarray</span>
<span class="sd">    :ivar pescc: Single flight continuum escape factor (calculated, including Thomson scattering)</span>
<span class="sd">    :vartype pescc: numpy.ndarray</span>
<span class="sd">    :ivar pesc: Single flight line escape factor including continuum extinction (calculated)</span>
<span class="sd">    :vartype pesc: numpy.ndarray</span>
<span class="sd">    :ivar epsilon: Destruction probability (calculated in newlin)</span>
<span class="sd">    :vartype epsilon: numpy.ndarray</span>
<span class="sd">    :ivar sort: Sorting array containing the sorted indices.</span>
<span class="sd">    :vartype sort: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wave</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dopp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pescl</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pescc</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pesc</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<div class="viewcode-block" id="Line.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Line.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="s1">&#39;ener&#39;</span><span class="p">,</span> <span class="n">erange</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">10.</span><span class="p">),</span> <span class="n">fluxlim</span><span class="o">=</span><span class="mf">1.E+35</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the line list from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param sort: Column to sort.</span>
<span class="sd">        :type sort: str</span>
<span class="sd">        :param erange: Energy range for output.</span>
<span class="sd">        :type erange: Tuple</span>
<span class="sd">        :param fluxlim: Minimum line emissivity to show (in photons/s).</span>
<span class="sd">        :type fluxlim: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;ascdump set range </span><span class="si">{0}</span><span class="s1">:</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">erange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">erange</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="s1">&#39;ascdump set flux </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fluxlim</span><span class="p">))</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">sort</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_nline</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">au</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wave</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dopp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pescl</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pescc</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pesc</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sort</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_id</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_iz</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_jz</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">al</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_get_al</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">au</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_get_au</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ener</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_ener</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wave</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_wave</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_flux</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_width</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dopp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_dopp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_tau</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pescl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_pescl</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pescc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_pescc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pesc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_pesc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_line</span><span class="o">.</span><span class="n">line_ind</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="Con"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Con">[docs]</a><span class="k">class</span> <span class="nc">Con</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;List of the ions that contribute to the free-free, free-bound and two-photon continuum emission, followed by</span>
<span class="sd">    the free-free, free-bound, two-photon and total continuum spectrum for the last plasma layer of the model.</span>

<span class="sd">    :ivar ff_nion: Number of ions contributing to free-free continuum.</span>
<span class="sd">    :vartype ff_nion: int</span>
<span class="sd">    :ivar ff_atom: Atomic numbers of ions contributing to free-free continuum.</span>
<span class="sd">    :vartype ff_atom: numpy.ndarray</span>
<span class="sd">    :ivar ff_ion: Ion numbers of ions contributing to free-free continuum.</span>
<span class="sd">    :vartype ff_ion: numpy.ndarray</span>
<span class="sd">    :ivar ff_name: Ion names of ions contributing to free-free continuum.</span>
<span class="sd">    :vartype ff_name: numpy.ndarray</span>

<span class="sd">    :ivar fb_nion: Number of ions contributing to free-bound continuum.</span>
<span class="sd">    :vartype fb_nion: int</span>
<span class="sd">    :ivar fb_atom: Atomic numbers of ions contributing to free-bound continuum.</span>
<span class="sd">    :vartype fb_atom: numpy.ndarray</span>
<span class="sd">    :ivar fb_ion: Ion numbers of ions contributing to free-bound continuum.</span>
<span class="sd">    :vartype fb_ion: numpy.ndarray</span>
<span class="sd">    :ivar fb_name: Ion names of ions contributing to free-bound continuum.</span>
<span class="sd">    :vartype fb_name: numpy.ndarray</span>

<span class="sd">    :ivar tf_nion: Number of ions contributing to two-photon continuum.</span>
<span class="sd">    :vartype tf_nion: int</span>
<span class="sd">    :ivar tf_atom: Atomic numbers of ions contributing to two-photon continuum.</span>
<span class="sd">    :vartype tf_atom: numpy.ndarray</span>
<span class="sd">    :ivar tf_ion: Ion numbers of ions contributing to two-photon continuum.</span>
<span class="sd">    :vartype tf_ion: numpy.ndarray</span>
<span class="sd">    :ivar tf_name: Ion names of ions contributing to two-photon continuum.</span>
<span class="sd">    :vartype tf_name: numpy.ndarray</span>

<span class="sd">    :ivar nbin: Number of spectral bins.</span>
<span class="sd">    :vartype nbin: int</span>
<span class="sd">    :ivar ener: Mean energy (keV).</span>
<span class="sd">    :vartype ener: numpy.ndarray</span>
<span class="sd">    :ivar ff: Free-Free continuum (1E44 ph/s/keV).</span>
<span class="sd">    :vartype ff: numpy.ndarray</span>
<span class="sd">    :ivar fb: Free-Bound continuum (1E44 ph/s/keV).</span>
<span class="sd">    :vartype fb: numpy.ndarray</span>
<span class="sd">    :ivar tf: Two-photon continuum (1E44 ph/s/keV).</span>
<span class="sd">    :vartype tf: numpy.ndarray</span>
<span class="sd">    :ivar tot: Total continuum (1E44 ph/s/keV).</span>
<span class="sd">    :vartype tot: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fb_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fb_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fb_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fb</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tot</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<div class="viewcode-block" id="Con.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Con.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the continuum contributions from SPEX.&quot;&quot;&quot;</span>

        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Free-Free </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_ff_nion</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff_atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_ff_elem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_ff_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ff_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            
            <span class="c1"># Free-Bound</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_fb_nion</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fb_atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_fb_elem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fb_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_fb_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fb_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fb_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                
            <span class="c1"># Two-photon</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_tf_nion</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tf_atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_tf_elem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tf_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_tf_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tf_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="c1"># Spectrum</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_nbin</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tot</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ener</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_ener</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_ff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_fb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_tf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_tot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_con</span><span class="o">.</span><span class="n">con_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>



<div class="viewcode-block" id="Tcl"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Tcl">[docs]</a><span class="k">class</span> <span class="nc">Tcl</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output the continuum, line and total flux for each energy bin summed for all plasma layers of the model.</span>

<span class="sd">    :ivar nbin: Number of energy bins.</span>
<span class="sd">    :vartype nbin: int</span>
<span class="sd">    :ivar ibin: Bin number.</span>
<span class="sd">    :vartype ibin: numpy.ndarray</span>
<span class="sd">    :ivar emean: Mean energy of the bin (keV).</span>
<span class="sd">    :vartype emean: numpy.ndarray</span>
<span class="sd">    :ivar fluxcon: Continuum flux (:math:`10^{44}` ph/s/keV).</span>
<span class="sd">    :vartype fluxcon: numpy.ndarray</span>
<span class="sd">    :ivar fluxlin: Line flux (:math:`10^{44}` ph/s/keV).</span>
<span class="sd">    :vartype fluxlin: numpy.ndarray</span>
<span class="sd">    :ivar flux: Total flux (:math:`10^{44}` ph/s/keV).</span>
<span class="sd">    :vartype flux: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="mi">0</span>                   <span class="c1"># Number of energy bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ibin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Bin number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Mean energy of the bin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluxcon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Continuum flux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluxlin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Line flux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Total flux</span>

<div class="viewcode-block" id="Tcl.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Tcl.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the continuum, line and total fluxes from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcl</span><span class="o">.</span><span class="n">tcl_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcl</span><span class="o">.</span><span class="n">tcl_nbin</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ibin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fluxcon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fluxlin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ibin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcl</span><span class="o">.</span><span class="n">tcl_bin</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">emean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcl</span><span class="o">.</span><span class="n">tcl_emean</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fluxcon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcl</span><span class="o">.</span><span class="n">tcl_slxcon</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fluxlin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcl</span><span class="o">.</span><span class="n">tcl_slxlin</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcl</span><span class="o">.</span><span class="n">tcl_slx</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcl</span><span class="o">.</span><span class="n">tcl_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Tcon"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Tcon">[docs]</a><span class="k">class</span> <span class="nc">Tcon</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;List of the ions that contribute to the free-free, free-bound and two-photon continuum emission, followed by</span>
<span class="sd">    the free-free, free-bound, two-photon and total continuum spectrum added for all plasma layers of the model.</span>

<span class="sd">    :ivar ff_nion: Number of ions contributing to free-free continuum.</span>
<span class="sd">    :vartype ff_nion: int</span>
<span class="sd">    :ivar ff_atom: Atomic numbers of ions contributing to free-free continuum.</span>
<span class="sd">    :vartype ff_atom: numpy.ndarray</span>
<span class="sd">    :ivar ff_ion: Ion numbers of ions contributing to free-free continuum.</span>
<span class="sd">    :vartype ff_ion: numpy.ndarray</span>
<span class="sd">    :ivar ff_name: Ion names of ions contributing to free-free continuum.</span>
<span class="sd">    :vartype ff_name: numpy.ndarray</span>
<span class="sd">    :ivar ff_layer: Number of layers in the model</span>
<span class="sd">    :vartype ff_layer: numpy.ndarray</span>

<span class="sd">    :ivar fb_nion: Number of ions contributing to free-bound continuum.</span>
<span class="sd">    :vartype fb_nion: int</span>
<span class="sd">    :ivar fb_atom: Atomic numbers of ions contributing to free-bound continuum.</span>
<span class="sd">    :vartype fb_atom: numpy.ndarray</span>
<span class="sd">    :ivar fb_ion: Ion numbers of ions contributing to free-bound continuum.</span>
<span class="sd">    :vartype fb_ion: numpy.ndarray</span>
<span class="sd">    :ivar fb_name: Ion names of ions contributing to free-bound continuum.</span>
<span class="sd">    :vartype fb_name: numpy.ndarray</span>
<span class="sd">    :ivar fb_layer: Number of layers in the model</span>
<span class="sd">    :vartype fb_layer: numpy.ndarray</span>

<span class="sd">    :ivar tf_nion: Number of ions contributing to two-photon continuum.</span>
<span class="sd">    :vartype tf_nion: int</span>
<span class="sd">    :ivar tf_atom: Atomic numbers of ions contributing to two-photon continuum.</span>
<span class="sd">    :vartype tf_atom: numpy.ndarray</span>
<span class="sd">    :ivar tf_ion: Ion numbers of ions contributing to two-photon continuum.</span>
<span class="sd">    :vartype tf_ion: numpy.ndarray</span>
<span class="sd">    :ivar tf_name: Ion names of ions contributing to two-photon continuum.</span>
<span class="sd">    :vartype tf_name: numpy.ndarray</span>
<span class="sd">    :ivar tf_layer: Number of layers in the model</span>
<span class="sd">    :vartype tf_layer: numpy.ndarray</span>

<span class="sd">    :ivar nbin: Number of spectral bins.</span>
<span class="sd">    :vartype nbin: int</span>
<span class="sd">    :ivar ener: Mean energy (keV).</span>
<span class="sd">    :vartype ener: numpy.ndarray</span>
<span class="sd">    :ivar ff: Free-Free continuum (1E44 ph/s/keV).</span>
<span class="sd">    :vartype ff: numpy.ndarray</span>
<span class="sd">    :ivar fb: Free-Bound continuum (1E44 ph/s/keV).</span>
<span class="sd">    :vartype fb: numpy.ndarray</span>
<span class="sd">    :ivar tf: Two-photon continuum (1E44 ph/s/keV).</span>
<span class="sd">    :vartype tf: numpy.ndarray</span>
<span class="sd">    :ivar tot: Total continuum (1E44 ph/s/keV).</span>
<span class="sd">    :vartype tot: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff_layer</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fb_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fb_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fb_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fb_layer</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf_layer</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fb</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tot</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<div class="viewcode-block" id="Tcon.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Tcon.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the continuum contributions from SPEX.&quot;&quot;&quot;</span>

        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Free-Free</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_ff_nion</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff_layer</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_nion</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff_atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_ff_elem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_ff_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ff_atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ff_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff_layer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_ff_layer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="c1"># Free-Bound</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_fb_nion</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb_layer</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_nion</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fb_atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_fb_elem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fb_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_fb_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fb_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fb_atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fb_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fb_layer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_fb_layer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="c1"># Two-photon</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_tf_nion</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf_layer</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_nion</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tf_atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_tf_elem</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tf_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_tf_ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tf_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tf_atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tf_layer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_tf_layer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="c1"># Spectrum</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_nbin</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fb</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tot</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ener</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_ener</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_ff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_fb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_tf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_tot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tcon</span><span class="o">.</span><span class="n">tcon_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Nei"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Nei">[docs]</a><span class="k">class</span> <span class="nc">Nei</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output the history of ionisation parameter and temperature for NEI models.</span>

<span class="sd">    :ivar nbin: Number of histogram bins.</span>
<span class="sd">    :vartype nbin: int</span>
<span class="sd">    :ivar u: Ionisation parameter (1E20 s/m**3).</span>
<span class="sd">    :vartype u: numpy.ndarray</span>
<span class="sd">    :ivar kt: Temperature (keV).</span>
<span class="sd">    :vartype kt: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="mi">0</span>                <span class="c1"># Number of histogram bins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Ionisation parameter (1E20 s/m**3)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kt</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Temperature (keV)</span>

<div class="viewcode-block" id="Nei.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Nei.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the history of the ionisation parameter from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_nei</span><span class="o">.</span><span class="n">nei_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_nei</span><span class="o">.</span><span class="n">nei_nbin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">u</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kt</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbin</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_nei</span><span class="o">.</span><span class="n">nei_u</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_nei</span><span class="o">.</span><span class="n">nei_kt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_nei</span><span class="o">.</span><span class="n">nei_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Heat"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Heat">[docs]</a><span class="k">class</span> <span class="nc">Heat</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Plasma heating rates (only for photoionized plasmas).</span>

<span class="sd">    :ivar heat: Total heating</span>
<span class="sd">    :vartype heat: float</span>
<span class="sd">    :ivar heatcom: Heating by Compton scattering</span>
<span class="sd">    :vartype heatcom: float</span>
<span class="sd">    :ivar heatffa: Heating by free-free absorption</span>
<span class="sd">    :vartype heatffa: float</span>
<span class="sd">    :ivar heatphi: Heating by photo-electrons</span>
<span class="sd">    :vartype heatphi: float</span>
<span class="sd">    :ivar heatcio: Heating by Compton ionisation</span>
<span class="sd">    :vartype heatcio: float</span>
<span class="sd">    :ivar heataug: Heating by Auger electrons</span>
<span class="sd">    :vartype heataug: float</span>
<span class="sd">    :ivar heatdex: Heating by collisional de-excitation</span>
<span class="sd">    :vartype heatdex: float</span>
<span class="sd">    :ivar heatext: Heating by external source</span>
<span class="sd">    :vartype heatext: float</span>
<span class="sd">    :ivar cool: Total cooling</span>
<span class="sd">    :vartype cool: float</span>
<span class="sd">    :ivar coolcom: Cooling by inverse Compton scattering</span>
<span class="sd">    :vartype coolcom: float</span>
<span class="sd">    :ivar coolion: Cooling by electron ionisation</span>
<span class="sd">    :vartype coolion: float</span>
<span class="sd">    :ivar coolrec: Cooling by radiative recombination</span>
<span class="sd">    :vartype coolrec: float</span>
<span class="sd">    :ivar coolffe: Cooling by free-free emission</span>
<span class="sd">    :vartype coolffe: float</span>
<span class="sd">    :ivar coolexc: Cooling by collisional excitation</span>
<span class="sd">    :vartype coolexc: float</span>
<span class="sd">    :ivar cooldr: Cooling by dielectronic recombination</span>
<span class="sd">    :vartype cooldr: float</span>
<span class="sd">    :ivar cooladi: Cooling by adiabatic expansion</span>
<span class="sd">    :vartype cooladi: float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heat</span> <span class="o">=</span> <span class="mf">0.</span>     <span class="c1"># Total heating</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatcom</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Heating by Compton scattering</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatffa</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Heating by free-free absorption</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatphi</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Heating by photo-electrons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatcio</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Heating by Compton ionisation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heataug</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Heating by Auger electrons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatdex</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Heating by collisional de-excitation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatext</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Heating by external source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cool</span> <span class="o">=</span> <span class="mf">0.</span>     <span class="c1"># Total cooling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coolcom</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Cooling by inverse Compton scattering</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coolion</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Cooling by electron ionisation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coolrec</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Cooling by radiative recombination</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coolffe</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Cooling by free-free emission</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coolexc</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Cooling by collisional excitation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cooldr</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c1"># Cooling by dielectronic recombination</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cooladi</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Cooling by adiabatic expansion</span>

<div class="viewcode-block" id="Heat.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Heat.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain plasma heating rates from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_heat</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatcom</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_heatcom</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatffa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_heatffa</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatphi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_heatphi</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatcio</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_heatcio</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heataug</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_heataug</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatdex</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_heatdex</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatext</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_heatext</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cool</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_cool</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coolcom</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_coolcom</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coolion</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_coolion</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coolrec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_coolrec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coolffe</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_coolffe</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coolexc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_coolexc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cooldr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_cooldr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cooladi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_heat</span><span class="o">.</span><span class="n">heat_cooladi</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Ebal"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Ebal">[docs]</a><span class="k">class</span> <span class="nc">Ebal</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output the energy balance contributions of each layer (only photoionized plasmas).</span>
<span class="sd">    (Heating and cooling in W/m**3)</span>

<span class="sd">    :ivar niter: Number of iterations.</span>
<span class="sd">    :vartype niter: int</span>
<span class="sd">    :ivar icond: I</span>
<span class="sd">    :vartype icond: float</span>
<span class="sd">    :ivar ncedec: CE</span>
<span class="sd">    :vartype ncedec: float</span>
<span class="sd">    :ivar hden: Hydrogen density (1E20/m**3)</span>
<span class="sd">    :vartype hden: float</span>
<span class="sd">    :ivar elden: Electron density (1E20/m**3)</span>
<span class="sd">    :vartype elden: float</span>
<span class="sd">    :ivar ed: Hydrogen / Electron density</span>
<span class="sd">    :vartype ed: float</span>
<span class="sd">    :ivar t: Electron temperature (keV)</span>
<span class="sd">    :vartype t: float</span>
<span class="sd">    :ivar dif: Delta</span>
<span class="sd">    :vartype dif: float</span>
<span class="sd">    :ivar heat: Total heating</span>
<span class="sd">    :vartype heat: float</span>
<span class="sd">    :ivar cool: Total cooling</span>
<span class="sd">    :vartype cool: float</span>
<span class="sd">    :ivar heatcom: Heating by Compton scattering</span>
<span class="sd">    :vartype heatcom: float</span>
<span class="sd">    :ivar heatffa: FF absorption heating</span>
<span class="sd">    :vartype heatffa: float</span>
<span class="sd">    :ivar heatphi: Photo-electron heating</span>
<span class="sd">    :vartype heatphi: float</span>
<span class="sd">    :ivar heatcio: Compton ion. heating</span>
<span class="sd">    :vartype heatcio: float</span>
<span class="sd">    :ivar heataug: Auger electron heating</span>
<span class="sd">    :vartype heataug: float</span>
<span class="sd">    :ivar heatdex: Collisional de-excitation heating</span>
<span class="sd">    :vartype heatdex: float</span>
<span class="sd">    :ivar heatext: External heating</span>
<span class="sd">    :vartype heatext: float</span>
<span class="sd">    :ivar coolcom: Compton scattering cooling</span>
<span class="sd">    :vartype coolcom: float</span>
<span class="sd">    :ivar coolion: Collisional ionisation cooling</span>
<span class="sd">    :vartype coolion: float</span>
<span class="sd">    :ivar coolrec: Recombination cooling</span>
<span class="sd">    :vartype coolrec: float</span>
<span class="sd">    :ivar coolffe: FF emission cooling</span>
<span class="sd">    :vartype coolffe: float</span>
<span class="sd">    :ivar coolexc: Collisional excitation cooling</span>
<span class="sd">    :vartype coolexc: float</span>
<span class="sd">    :ivar cooldr: Di-electronic recombination cooling</span>
<span class="sd">    :vartype cooldr: float</span>
<span class="sd">    :ivar cooladi: Adiabatic cooling</span>
<span class="sd">    :vartype cooladi: float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">niter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">icond</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncedec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hden</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elden</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ed</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">dif</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cool</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatcom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatffa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatphi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatcio</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heataug</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatdex</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heatext</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coolcom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coolion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coolrec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coolffe</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coolexc</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cooldr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cooladi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    
<div class="viewcode-block" id="Ebal.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Ebal.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the energy balance for each iteration of the model.</span>
<span class="sd">        </span>
<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">niter</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_niter</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">icond</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ncedec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hden</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elden</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ed</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  
            <span class="bp">self</span><span class="o">.</span><span class="n">dif</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cool</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatcom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatffa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatphi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatcio</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heataug</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatdex</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heatext</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coolcom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coolion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coolrec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coolffe</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coolexc</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cooldr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cooladi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">niter</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">icond</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_icond</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ncedec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_ncedec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hden</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_hden</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elden</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_elden</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_ed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dif</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_dif</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">heat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_heat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_cool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">heatcom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_heatcom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">heatffa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_heatffa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">heatphi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_heatphi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">heatcio</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_heatcio</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">heataug</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_heataug</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">heatdex</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_heatdex</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">heatext</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_heatext</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coolcom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_coolcom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coolion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_coolion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coolrec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_coolrec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coolffe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_coolffe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coolexc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_coolexc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cooldr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_cooldr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cooladi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_ebal</span><span class="o">.</span><span class="n">ebal_cooladi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Col"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Col">[docs]</a><span class="k">class</span> <span class="nc">Col</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Output the ionic column densities.</span>

<span class="sd">    :ivar nline: Number of lines.</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar atom: Atomic number.</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage.</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name.</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman).</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar column: Column density (1E28/m**2).</span>
<span class="sd">    :vartype column: numpy.ndarray</span>
<span class="sd">    :ivar logcol: Recombination rate (/m**2).</span>
<span class="sd">    :vartype logcol: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Atomic number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Column density (1E28/m**2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logcol</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Recombination rate (/m**2)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fname</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<div class="viewcode-block" id="Col.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Col.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the ionic column denstities from SPEX.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_col</span><span class="o">.</span><span class="n">col_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_col</span><span class="o">.</span><span class="n">col_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">column</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logcol</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_col</span><span class="o">.</span><span class="n">col_atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_col</span><span class="o">.</span><span class="n">col_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_col</span><span class="o">.</span><span class="n">col_column</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logcol</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_col</span><span class="o">.</span><span class="n">col_logcol</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_col</span><span class="o">.</span><span class="n">col_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Tranline"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Tranline">[docs]</a><span class="k">class</span> <span class="nc">Tranline</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The transmission and equivalent width of absorption lines for the</span>
<span class="sd">    hot, pion, slab, xabs and warm models.</span>

<span class="sd">    :ivar nline: Number of lines</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar id: Line ID number</span>
<span class="sd">    :vartype id: numpy.ndarray</span>
<span class="sd">    :ivar atom: Atomic number</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name.</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman).</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar ener: Line energy (keV)</span>
<span class="sd">    :vartype ener: numpy.ndarray</span>
<span class="sd">    :ivar ew: Equivalent width (keV)</span>
<span class="sd">    :vartype ew: numpy.ndarray</span>
<span class="sd">    :ivar tau: Optical depth tau</span>
<span class="sd">    :vartype tau: numpy.ndarray</span>
<span class="sd">    :ivar avoigt: Natural line width</span>
<span class="sd">    :vartype avoigt: numpy.ndarray</span>
<span class="sd">    :ivar sorted: Sorted index array</span>
<span class="sd">    :vartype sorted: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c1"># Number of absorption lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>          <span class="c1"># Line ID number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>        <span class="c1"># Atomic number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>         <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>        <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>       <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>        <span class="c1"># Line energy (keV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ew</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>          <span class="c1"># Equivalent width (keV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>         <span class="c1"># Optical depth tau</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">avoigt</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Natural line width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sorted</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Sorted index array</span>

<div class="viewcode-block" id="Tranline.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Tranline.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">sortn</span><span class="o">=</span><span class="s1">&#39;ener&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the transmission and equivalent width from absorption lines from SPEX. This</span>
<span class="sd">        works for the hot, pion, slab, xabs, and warm models.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param sortn: Sort the data based on column: energy (ener), wavelength (wav), ion (ion), line power (powe), natural line width (wid).</span>
<span class="sd">        :type sortn: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">sortn</span><span class="o">=</span><span class="n">sortn</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sorted</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_indsor</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ew</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">avoigt</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_iar</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_izion</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_jzion</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ener</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_eline</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_ewline</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_tauline</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">avoigt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_avoigtline</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Tranedge"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Tranedge">[docs]</a><span class="k">class</span> <span class="nc">Tranedge</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The transmission and equivalent width of absorption edges for the</span>
<span class="sd">    hot, pion, slab, xabs and warm models.</span>

<span class="sd">    :ivar nedge: Number of edges</span>
<span class="sd">    :vartype nedge: int</span>
<span class="sd">    :ivar atom: Atomic number</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar shell: Atomic shell</span>
<span class="sd">    :vartype shell: numpy.ndarray</span>
<span class="sd">    :ivar shname: Shell name</span>
<span class="sd">    :vartype shname: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name.</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman).</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar ener: Edge energy</span>
<span class="sd">    :vartype ener: numpy.ndarray</span>
<span class="sd">    :ivar tau: Optical depth tau</span>
<span class="sd">    :vartype tau: numpy.ndarray</span>
<span class="sd">    :ivar ew: Equivalent width (keV)</span>
<span class="sd">    :vartype ew: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nedge</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c1"># Number of edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>        <span class="c1"># Atomic number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>         <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shell</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>       <span class="c1"># Atomic shell</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>        <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>       <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shname</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Shell name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>        <span class="c1"># Edge energy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>         <span class="c1"># Optical depth tau</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ew</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>          <span class="c1"># Equivalent width (keV)</span>

<div class="viewcode-block" id="Tranedge.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Tranedge.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the transmission and equivalent width from absorption edges from SPEX. This</span>
<span class="sd">        works for the hot, pion, slab, xabs, and warm models.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">sortn</span><span class="o">=</span><span class="s1">&#39;ener&#39;</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nedge</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_nedge</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nedge</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nedge</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shell</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nedge</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nedge</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nedge</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shname</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nedge</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ener</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nedge</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nedge</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ew</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nedge</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nedge</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_iz</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_jz</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_is</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shname</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atomshell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ener</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_eedge</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_tau</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_ewedge</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_tran</span><span class="o">.</span><span class="n">tran_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Tran"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Tran">[docs]</a><span class="k">class</span> <span class="nc">Tran</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;In two subsequent objects, the transmission and equivalent width of</span>
<span class="sd">        absorption lines (self.line) and absorption edges (self.edge)</span>
<span class="sd">        are listed for the hot, pion, slab, xabs and warm models.</span>

<span class="sd">    :ivar line: Object containing the transmission and equivalent widths of the absorption lines.</span>
<span class="sd">    :vartype line: pyspex.ascdump.Tranline</span>
<span class="sd">    :ivar edge: Object containing the transmission and equivalent widths of the absorption edges.</span>
<span class="sd">    :vartype edge: pyspex.ascdump.Tranedge</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Spectral absorption lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">Tranline</span><span class="p">()</span>
        <span class="c1"># Absorption edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span> <span class="o">=</span> <span class="n">Tranedge</span><span class="p">()</span>

<div class="viewcode-block" id="Tran.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Tran.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">sortn</span><span class="o">=</span><span class="s1">&#39;ener&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the transmission and equivalent width from absorption lines and edges from SPEX. This</span>
<span class="sd">        works for the hot, pion, slab, xabs, and warm models.</span>

<span class="sd">        :param isect: Sector number of the component.</span>
<span class="sd">        :type isect: int</span>
<span class="sd">        :param icomp: Component number.</span>
<span class="sd">        :type icomp: int</span>
<span class="sd">        :param sortn: Sort the data based on column: energy (ener), wavelength (wav), ion (ion), line power (powe), natural line width (wid).</span>
<span class="sd">        :type sortn: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">,</span> <span class="n">sortn</span><span class="o">=</span><span class="n">sortn</span><span class="p">)</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>


<div class="viewcode-block" id="Warm"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Warm">[docs]</a><span class="k">class</span> <span class="nc">Warm</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Column densities, ionisation parameters and temperatures of the warm model.</span>

<span class="sd">    :ivar nline: Number of lines.</span>
<span class="sd">    :vartype nline: int</span>
<span class="sd">    :ivar atom: Atomic number.</span>
<span class="sd">    :vartype atom: numpy.ndarray</span>
<span class="sd">    :ivar ion: Ionisation stage.</span>
<span class="sd">    :vartype ion: numpy.ndarray</span>
<span class="sd">    :ivar name: Element name.</span>
<span class="sd">    :vartype name: numpy.ndarray</span>
<span class="sd">    :ivar roman: Ionisation stage (Roman).</span>
<span class="sd">    :vartype roman: numpy.ndarray</span>
<span class="sd">    :ivar xi: Log Xi (1E-9 Wm).</span>
<span class="sd">    :vartype xi: numpy.ndarray</span>
<span class="sd">    :ivar t: Log T (keV).</span>
<span class="sd">    :vartype t: numpy.ndarray</span>
<span class="sd">    :ivar col: dN/d ln Xi.</span>
<span class="sd">    :vartype col: numpy.ndarray</span>

<span class="sd">    :ivar nxil: Number of Xi grid points.</span>
<span class="sd">    :vartype nxil: int</span>
<span class="sd">    :ivar xilgrid: Xi (1E-9 Wm).</span>
<span class="sd">    :vartype xilgrid: numpy.ndarray</span>
<span class="sd">    :ivar dndlnxi: dN/d ln Xi</span>
<span class="sd">    :vartype dndlnxi: numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Atomic number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># Ionisation stage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>    <span class="c1"># Element name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>   <span class="c1"># Ionisation stage (Roman)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>      <span class="c1"># Log Xi (1E-9 Wm)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>       <span class="c1"># Log T (keV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>     <span class="c1"># dN/d ln Xi</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nxil</span> <span class="o">=</span> <span class="mi">0</span>                   <span class="c1"># Number of Xi grid points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xilgrid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Xi (1E-9 Wm)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dndlnxi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># dN/d ln Xi</span>

<div class="viewcode-block" id="Warm.get"><a class="viewcode-back" href="../../pyspex/ascdump.html#pyspex.ascdump.Warm.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain the column densities, ionisation parameters and temperatures of the warm model from SPEX.&quot;&quot;&quot;</span>

        <span class="n">ier</span> <span class="o">=</span> <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_get</span><span class="p">(</span><span class="n">isect</span><span class="p">,</span> <span class="n">icomp</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Elements</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_nline</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roman</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ion</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nline</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roman</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">ion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_xi_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_t_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">col</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_col_ion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">nxil</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_nxil</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xilgrid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxil</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dndlnxi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxil</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxil</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xilgrid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_xilgrid</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dndlnxi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_dndlnxi</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">pyspex</span><span class="o">.</span><span class="n">api_asc_warm</span><span class="o">.</span><span class="n">warm_final</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ier</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo-wide.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getstarted.html">1. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../threads.html">2. Analysis threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">3. Command overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">4. Spectral models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">5. Additional tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyspex.html">6. Python Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help.html">7. Help &amp; troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory.html">8. SPEX Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exercises.html">9. Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">10. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">11. Credits</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
        Last updated on: Feb 11, 2021.<br>
    
        &copy;2020, Jelle de Plaa, Jelle Kaastra, SPEX Development Team, <a href="https://www.sron.nl/">SRON Netherlands Institute for Space Research</a>.
    

</div>

  </body>
</html>