
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4.1.37. Tpho: Time-dependent, non-equilibrium, photoionised plasma model &#8212; SPEX Help Center 3.07.02 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="canonical" href="https://spex-xray.github.io/spex-help/models/tpho.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.1.38. User: User defined model" href="user.html" />
    <link rel="prev" title="4.1.36. Spln: spline continuum model" href="spln.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tpho-time-dependent-non-equilibrium-photoionised-plasma-model">
<span id="sec-tpho"></span><h1><span class="section-number">4.1.37. </span>Tpho: Time-dependent, non-equilibrium, photoionised plasma model<a class="headerlink" href="#tpho-time-dependent-non-equilibrium-photoionised-plasma-model" title="Permalink to this headline">¶</a></h1>
<p>The <em>tpho</em> model computes the state of a photoionised plasma that is out
of equilibrium due to changes in the ionising radiation. In the <em>pion</em>
model, which corresponds to a photoionisation equilibrium (PIE) plasma,
the heating=cooling solution is found for the plasma. However, in the
<em>tpho</em> model this is not necessarily the case. Depending on the spectral
energy distribution (SED) variation, and the parameters of the plasma
(such as its density), heating does not balance cooling in the plasma.
The <em>tpho</em> model can be considered to be analogous to the <em>neij</em> model
in SPEX, but for a photoionised plasma case.</p>
<p>For the <em>tpho</em> computation the user provides the X-ray lightcurve of the
ionising source as an input file. At time=0, the model is calculated at
PIE condition like the <em>pion</em> model. Then at time &gt; 0, the heating and
cooling processes are calculated as the SED is scaled according to the
provided lightcurve. The state of the plasma is evolved and the
corresponding non-equilibrium temperature is calculated at each step. At
t=final, the evolution and calculations finish, and the final spectrum
is displayed in SPEX. The <em>tpho</em> model also has an option to store
intermediate results of the computations (from time=0 to time=final) as
ASCII outputs for further examination by the user outside of SPEX.</p>
<div class="line-block">
<div class="line">The parameters of the model are:</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">nh</span></code>: Hydrogen column density in <img class="math" src="../_images/math/ab6e04e5ca2234069abfab6259b6c07dac8127b5.svg" alt="10^{28}" style="vertical-align: 0px"/> <img class="math" src="../_images/math/c0a326b7dd0bb2fb67d3e9537242840ad69320bd.svg" alt="\mathrm{m}^{-2}" style="vertical-align: 0px"/>. Default
value: <img class="math" src="../_images/math/5af985bca89ef405a8dea835b54997e022a3a857.svg" alt="10^{-4}" style="vertical-align: 0px"/> (corresponding to <img class="math" src="../_images/math/f36d19d17cfe311910a982e8b4571ac20ec2e83c.svg" alt="10^{24}" style="vertical-align: 0px"/> <img class="math" src="../_images/math/c0a326b7dd0bb2fb67d3e9537242840ad69320bd.svg" alt="\mathrm{m}^{-2}" style="vertical-align: 0px"/>).</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">xi</span></code>: the <img class="math" src="../_images/math/a693d4c492afc3f04176719f4e9d8d88be543b68.svg" alt="^{10}\log" style="vertical-align: -3px"/> of the initial (time=0) ionisation parameter
<img class="math" src="../_images/math/f4b734e9e2ef12084970f859b71af22504059ee7.svg" alt="\log\xi" style="vertical-align: -3px"/> in units of <img class="math" src="../_images/math/6a4b79279044493855d396b733ee7b812a8e73ae.svg" alt="10^{-9}" style="vertical-align: 0px"/> W m. Default value: 1.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">mode</span></code>: This parameter specifies how
the ionising SED is taken into account. Mode=1 means use the continuum
models that the user has set up in SPEX (e.g. pow). This mode is the
same as how the continuum is used in the <em>pion</em> model. Mode=2 means an
input SED file in ASCII format is read.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">sed</span></code>: The name of the input SED
file, if mode=2. The format of this file is like the <em>file</em> model in
SPEX and is as following: the 1st line contains the number of data
points, and the next lines provide the energy in keV (1st column) and
the flux in <img class="math" src="../_images/math/10032336f81641b7a7ef5064e6614742acd1d93a.svg" alt="10^{44}" style="vertical-align: 0px"/> photons/s/keV (2nd column). Remember to use
’aval’ instead of ’val’ when setting the name of the parameter in
SPEX.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">lc</span></code>: The name of the file containing the lightcurve. The first
column is time in second, and the second column is the X-ray flux
(energy per unit area per second). Remember to use ’aval’ instead of
’val’ when setting the name of the parameter in SPEX.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">hden</span></code>: Hydrogen number density in <img class="math" src="../_images/math/22930a0ec3f5a5b815256b6ca239486029c2f7cc.svg" alt="10^{20}" style="vertical-align: 0px"/> <img class="math" src="../_images/math/fe3f93d068e0064c7b13a3e8366f80ddc73a3dbd.svg" alt="\mathrm{m}^{-3}" style="vertical-align: 0px"/>.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">fcov</span></code>: The covering factor of the absorber. Default value: 1 (full covering)</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">v</span></code>: Root mean square velocity <img class="math" src="../_images/math/f691f0b7dee13ad327a9687828f41f263f84fe48.svg" alt="\sigma_{\mathrm v}" style="vertical-align: -2px"/></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">rms</span></code>: Rms velocity <img class="math" src="../_images/math/3e7ee6fbf382fd939b10b00df4db409e0bd8ff2f.svg" alt="\sigma_{\mathrm b}" style="vertical-align: -2px"/> of line blend components</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">dv</span></code>: Velocity distance <img class="math" src="../_images/math/8a1e195ea7a6ddd2d2bdbd0bf57bc61707cfa84f.svg" alt="\Delta v" style="vertical-align: 0px"/> between different blend components</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">zv</span></code>: Average systematic velocity <img class="math" src="../_images/math/26f466833af51f7aab1f2bda409fcc52eb979a05.svg" alt="v" style="vertical-align: 0px"/> of the absorber (using relativistic Doppler shift)</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ref</span></code>: Reference element for abundances</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">01..28</span></code>: Abundances of H to Ni; only here we take H, He, C, N, O,
Ne, Na, Mg, Al, Si, S, Ar, Ca, Fe, Ni.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">info</span></code>: Flag for writing out the intermediate calculation results into ASCII
files. Info=0 (default) does not write any files, while info=1 writes the
intermediate results into a directory called <code class="docutils literal notranslate"><span class="pre">tpho_info</span></code>. The following ASCII
files are produced: <code class="docutils literal notranslate"><span class="pre">plasma.dat</span></code> (1st column: time (s); 2nd column: ionisation
parameter <img class="math" src="../_images/math/c9e8aef6f8b8c0e290d66b363e1eb7f41d144f6b.svg" alt="\xi" style="vertical-align: -3px"/> in erg cm /s; 3rd column: T in keV; 4th column: <img class="math" src="../_images/math/191cce28fbc86c6fc7f97f55132916591794d36b.svg" alt="\Xi" style="vertical-align: 0px"/>; 5th column:
total heating in <img class="math" src="../_images/math/565dcb6062f038b5ac9632b606197bd92572af18.svg" alt="\mathrm{W m^{-3}}" style="vertical-align: 0px"/>; 6th column: total cooling in <img class="math" src="../_images/math/565dcb6062f038b5ac9632b606197bd92572af18.svg" alt="\mathrm{W m^{-3}}" style="vertical-align: 0px"/>; 7th column:
electron-ion equilibration time in s). Note: just for info, we adopt for this version electron-ion
equilibrium. <code class="docutils literal notranslate"><span class="pre">heatproc.dat</span></code> with subsequent columns time, <img class="math" src="../_images/math/86515baf32de1f4595833dfab12de85d1db98736.svg" alt="\xi, T, \Xi" style="vertical-align: -3px"/> and total
heating and cooling in the same units as the file <code class="docutils literal notranslate"><span class="pre">plasma.dat</span></code>, followed by the contributions to the total
heating (Compton scattering, free-free absorption, photo-ionisation, Compton ionisation,
Auger electrons, collisional de-excitation, external heating) and to the total cooling
(Inverse Compton scattering, collisional ionisation, radiative recombination, bremsstrahlung,
collisional excitation and dielectronic recombination); files <code class="docutils literal notranslate"><span class="pre">ion01.dat</span></code> to <code class="docutils literal notranslate"><span class="pre">ion30.dat</span></code>, with
the ion concentrations of the ions for each element labeled by its atomic number Z (1–30)
as a function of time (s); the concentrations are relative to the total hydrogen density;
<code class="docutils literal notranslate"><span class="pre">spect.dat</span></code> (1st column: E in keV, 2nd column:
transmission). We note that currently only the final spectrum (at t=final) can be
stored; the user however can modify the t=final in the lightcurve file to be
able to see the spectrum at the desired time in SPEX.</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please note the <em>tpho</em> model is currently in the testing phase.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please note that if the final time is very large, the computation may take a long time, because time steps
are not allowed to be larger than a certain fraction of the thermal time scale;
make sure that your parameters are well and reasonable defined.</p>
</div>
<p><em>For questions and issues regarding the model please contact Missagh
Mehdipour and Daniele Rogantini.</em></p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo-wide.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getstarted.html">1. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../threads.html">2. Analysis threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">3. Command overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../models.html">4. Spectral models</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="over.html">4.1. Overview of spectral components</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html">4.2. Optimizing model performance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">5. Additional tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyspex.html">6. Python Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../help.html">7. Help &amp; troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">8. SPEX Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises.html">9. Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">10. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">11. Credits</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../models.html"><span class="section-number">4. </span>Spectral models</a><ul>
  <li><a href="over.html"><span class="section-number">4.1. </span>Overview of spectral components</a><ul>
      <li>Previous: <a href="spln.html" title="previous chapter"><span class="section-number">4.1.36. </span>Spln: spline continuum model</a></li>
      <li>Next: <a href="user.html" title="next chapter"><span class="section-number">4.1.38. </span>User: User defined model</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
        Last updated on: Nov 29, 2022.<br>
    
        &copy;2022, Jelle de Plaa, Jelle Kaastra, Liyi Gu, SPEX Development Team, <a href="https://www.sron.nl/">SRON Netherlands Institute for Space Research</a>.
    

</div>

  </body>
</html>