
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>8.3.1. Calculating models on grids &#8212; SPEX Help Center 3.07.00 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="canonical" href="https://spex-xray.github.io/spex-help/theory/fitting/egrids.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="8.3.2. Different types of spectral components" href="modtype.html" />
    <link rel="prev" title="8.3. Modelling and fitting" href="../fitting.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="calculating-models-on-grids">
<span id="sec-calcmodel"></span><h1><span class="section-number">8.3.1. </span>Calculating models on grids<a class="headerlink" href="#calculating-models-on-grids" title="Permalink to this headline">¶</a></h1>
<p>Model spectra are generally calculated for an energy or wavelength grid. In SPEX,
the default energy grid has 8192 bins between 0.001 and 100 keV. This grid is used
when calculating models without an instrument defined, for example, when you
plot a model spectrum using the <code class="docutils literal notranslate"><span class="pre">plot</span> <span class="pre">type</span> <span class="pre">model</span></code> command (<a class="reference internal" href="../../reference/plot/types.html#sect-plottypes"><span class="std std-ref">Plot types</span></a>).
The resolution of this grid is usually enough, but when it is not, the egrid command
can help to increase the resolution or broaden the energy range (<a class="reference internal" href="../../reference/commands/egrid.html#sec-egrid"><span class="std std-ref">Egrid: define model energy grids</span></a>).</p>
<section id="energy-grids-when-loading-data">
<h2><span class="section-number">8.3.1.1. </span>Energy grids when loading data<a class="headerlink" href="#energy-grids-when-loading-data" title="Permalink to this headline">¶</a></h2>
<p>When data is loaded into SPEX, then the energy grid is automatically adapted to
the loaded response matrix. Because response matrices already contain a model
energy grid and a channel grid, the SPEX energy grid should match the one from
the response, at least within the energy range defined in the response matrix.
This way, the model is always calculated at a resolution that is set by the
response matrix.</p>
</section>
<section id="special-cases">
<h2><span class="section-number">8.3.1.2. </span>Special cases<a class="headerlink" href="#special-cases" title="Permalink to this headline">¶</a></h2>
<p>For some models, like PION, the broad-band spectrum is very important for the
calculation. In those cases, the energy band should be extended. Recommended
is a logarithmic grid between <img class="math" src="../../_images/math/cdf56c770855488e761662df0277fc43fe35c756.svg" alt="10^{-6}-10^{6}" style="vertical-align: -1px"/> keV with a step size of 0.005
(see <a class="reference internal" href="../../models/pion.html#sec-pion"><span class="std std-ref">Pion: SPEX photoionised plasma model</span></a>). Thus, the default grid has 200 bins per decade. Which energy
grid should be used depends on your settings and wishes. The range (lower and upper
energy) matter for the physical outcome of the PION model, due to the effects of
(inverse) Compton scattering of high- and low energy photons.</p>
<p>When an observed spectrum and response are loaded, we could stick with just the
energies contained in the matrix. However, for the PION model also energies outside
this range are relevant, because the photons there contribute to heating/cooling/ionisation
etc. That is the reason why the energy grid is extended for this model to span the full
1E-6 to 1E6 range. We realise that the 200 bins per decade of that extension is an
arbitrary choice, but we think for most cases that is accurate enough to represent
the IR or gamma-ray range.</p>
<p>This extension of the energy grid happens in SPEX always, as soon as you read data,
even if you do not have the PION model. This is because SPEX cannot anticipate what
model components the user may want to add or delete to the full model that is being
used. But of course it is harmless for all other models.</p>
<p>You might argue that sometimes you may also want to have higher resolution than
200 bins per decade in the optical or UV range, for instance in those cases where
you might have joint HST/COS data with high resolution. Fortunately, whenever
the corresponding UV data (response &amp; spectrum) is added, the way SPEX determines
its energy grid as described above would include the high-resolution UV part
automatically at the desirable high resolution.</p>
</section>
<section id="checking-the-energy-grid">
<h2><span class="section-number">8.3.1.3. </span>Checking the energy grid<a class="headerlink" href="#checking-the-energy-grid" title="Permalink to this headline">¶</a></h2>
<p>Whenever you read data (a single spectrum, or from multiple instruments), SPEX
creates a new energy grid on which the model is evaluated, before folding with
the response matrices. This energy grid is the combination of all energies on
the photon axis (not to be confused with the count axis) of the response matrices
of all instruments involved, supplemented with a grid with a spacing of 0.005 in
log energy spanning between 1E-6 and 1E6 keV.</p>
<p>To see what happens in a specific case, you can plot the model spectrum, put on the x-axis
the energy in keV, and choose <code class="docutils literal notranslate"><span class="pre">plot</span> <span class="pre">uy</span> <span class="pre">bin</span></code> which gives you the bin number. Also
issue the command <code class="docutils literal notranslate"><span class="pre">plot</span> <span class="pre">ux</span> <span class="pre">kev</span></code> to re-determine the min/max energies of the grid.
This should show the binning of your response matrix/matrices as well as the extension.</p>
<p>Another method to inspect the energy grid is running the <code class="docutils literal notranslate"><span class="pre">egrid</span> <span class="pre">save</span></code> command
(<a class="reference internal" href="../../reference/commands/egrid.html#sec-egrid"><span class="std std-ref">Egrid: define model energy grids</span></a>). This will save the full energy grid to file.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo-wide.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getstarted.html">1. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../threads.html">2. Analysis threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">3. Command overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">4. Spectral models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">5. Additional tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyspex.html">6. Python Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help.html">7. Help &amp; troubleshooting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../theory.html">8. SPEX Theory</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../spexact.html">8.1. SPEX Atomic Code &amp; Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spex2notation.html">8.2. SPEX 2 notation of atomic transitions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../fitting.html">8.3. Modelling and fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../response.html">8.4. Optimal definition of respons matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../turbulence.html">8.5. Definition of the micro-turbulent velocity in SPEX</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../exercises.html">9. Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">10. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">11. Credits</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../../theory.html"><span class="section-number">8. </span>SPEX Theory</a><ul>
  <li><a href="../fitting.html"><span class="section-number">8.3. </span>Modelling and fitting</a><ul>
      <li>Previous: <a href="../fitting.html" title="previous chapter"><span class="section-number">8.3. </span>Modelling and fitting</a></li>
      <li>Next: <a href="modtype.html" title="next chapter"><span class="section-number">8.3.2. </span>Different types of spectral components</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
        Last updated on: Aug 01, 2022.<br>
    
        &copy;2022, Jelle de Plaa, Jelle Kaastra, Liyi Gu, SPEX Development Team, <a href="https://www.sron.nl/">SRON Netherlands Institute for Space Research</a>.
    

</div>

  </body>
</html>