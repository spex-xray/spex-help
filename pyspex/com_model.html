
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>6.1.2.2. Model related commands &#8212; SPEX Help Center 3.08.01 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="canonical" href="https://spex-xray.github.io/spex-help/pyspex/com_model.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.1.2.3. Ascdump commands" href="com_ascdump.html" />
    <link rel="prev" title="6.1.2.1. Data related commands" href="com_data.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="model-related-commands">
<h1><span class="section-number">6.1.2.2. </span>Model related commands<a class="headerlink" href="#model-related-commands" title="Permalink to this heading">¶</a></h1>
<p>A SPEX model is organised in sectors and components. Sectors are groups of components that model
a particular source of radiation. Below, the basic commands for building the model and change its
parameters are listed.</p>
<section id="abundance">
<h2><span class="section-number">6.1.2.2.1. </span>Abundance<a class="headerlink" href="#abundance" title="Permalink to this heading">¶</a></h2>
<p>The solar abundance table used is set in SPEX using the <code class="docutils literal notranslate"><span class="pre">abundance</span></code> command. In PYSPEX, this
is abbreviated to <code class="docutils literal notranslate"><span class="pre">abun</span></code>. The desired abundance table should be loaded by providing the
abbreviation for the table (<code class="docutils literal notranslate"><span class="pre">abunset</span></code>):</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.abun">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">abun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abunset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.abun"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.abun" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the abundance table in SPEX. The abunset parameter is one of ‘reset’, ‘ag’, ‘allen’, ‘asplund’,
‘ra’, ‘grevesse’, ‘gs’, ‘lodders’, and ‘solar’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>abunset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – String representing the abundance set used in SPEX.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object containing the abundance class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="model.html#pyspex.model.Abundance" title="pyspex.model.Abundance">pyspex.model.Abundance</a></p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The possible abundance tables are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reset</span></code>: Lodders et al. (2009)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allen</span></code>: Allen (1973)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ra</span></code>: Ross &amp; Aller (1976)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grevesse</span></code>: Grevesse et al. (1992)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gs</span></code>: Grevesse &amp; Sauval (1998)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lodders</span></code>: Lodders proto-Solar (2003)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solar</span></code>: Lodders Solar Photospheric (2003)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ag</span></code>: Anders &amp; Grevesse (1989)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">asplund</span></code>: Asplund et al. (2009)</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">abun</span></code> command returns an object with the abundance information, which can optionally
be assigned to a parameter and be accessed through Python. See the advanced class descriptions
for details.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">abun</span><span class="p">(</span><span class="s1">&#39;asplund&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[&#39;__doc__&#39;, &#39;__init__&#39;, &#39;__module__&#39;, &#39;get&#39;, &#39;index&#39;, &#39;list&#39;, &#39;ref&#39;, &#39;set&#39;, &#39;update&#39;]</span>
</pre></div>
</div>
<section id="abundance-show">
<h3><span class="section-number">6.1.2.2.1.1. </span>Abundance show<a class="headerlink" href="#abundance-show" title="Permalink to this heading">¶</a></h3>
<p>To show the current abundance table, use the <code class="docutils literal notranslate"><span class="pre">abun_show</span></code> method:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.abun_show">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">abun_show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.abun_show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.abun_show" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the current ionisation balance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reference to the used ionisation balance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The method returns the reference as a text string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ab</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">abun_show</span><span class="p">()</span>
<span class="go">Lodders et al. (2009)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
<span class="go">Lodders et al. (2009)</span>
</pre></div>
</div>
</section>
</section>
<section id="aerror">
<h2><span class="section-number">6.1.2.2.2. </span>Aerror<a class="headerlink" href="#aerror" title="Permalink to this heading">¶</a></h2>
<p>Calculate the uncertainties for several parameters of a model component due to the uncertainties in the
atomic data.</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.aerror">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">aerror</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.aerror"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.aerror" title="Permalink to this definition">¶</a></dt>
<dd><p>Command to calculate the uncertainty in a model parameter due to the uncertainties
in the atomic data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the component.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name.</p></li>
<li><p><strong>shell</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Shell number for calculation (L-shell = 1, K-shell = 2)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The atomic uncertainty for the selected parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a></p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">aerr</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">aerror</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;norm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aerr</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">aerror</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;26&#39;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="calculate">
<h2><span class="section-number">6.1.2.2.3. </span>Calculate<a class="headerlink" href="#calculate" title="Permalink to this heading">¶</a></h2>
<p>Once the model sectors and components are set-up and the parameters are set, the model spectrum
can be calculated using the SPEX <code class="docutils literal notranslate"><span class="pre">calculate</span></code> command. For convenience, this command has been
abbreviated to <code class="docutils literal notranslate"><span class="pre">calc</span></code> in PYSPEX.</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.calc">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">calc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.calc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the current model.</p>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">calc</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="components">
<h2><span class="section-number">6.1.2.2.4. </span>Components<a class="headerlink" href="#components" title="Permalink to this heading">¶</a></h2>
<p>Spectral components, like power laws, thermal and absorption models are loaded using the
SPEX <code class="docutils literal notranslate"><span class="pre">comp</span></code> command. Since the command is often typed simply as <code class="docutils literal notranslate"><span class="pre">com</span></code> in practice, the
PYSPEX command is also <code class="docutils literal notranslate"><span class="pre">com</span></code>:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.com">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">com</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.com"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.com" title="Permalink to this definition">¶</a></dt>
<dd><p>Add model component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Name of the model component, for example ‘reds’, ‘hot’, ‘cie’, etc.</p></li>
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number to add component to (default is sector 1).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The command adds a component by default to sector 1. If the component should be added to a
different sector, then please use the optional <code class="docutils literal notranslate"><span class="pre">isect</span></code> parameter to specify the target sector.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">com</span><span class="p">(</span><span class="s1">&#39;cie&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">com</span><span class="p">(</span><span class="s1">&#39;po&#39;</span><span class="p">,</span> <span class="n">isect</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>See the SPEX reference manual for a list of spectral components.</p>
<section id="component-delete">
<h3><span class="section-number">6.1.2.2.4.1. </span>Component delete<a class="headerlink" href="#component-delete" title="Permalink to this heading">¶</a></h3>
<p>Deleting a component from the model is done using the sector and component number of the component.</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.com_del">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">com_del</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.com_del"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.com_del" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete component from model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the component to delete.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number to delete.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">com_del</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The command above deletes the first component in sector number 1.</p>
</section>
<section id="component-relate">
<h3><span class="section-number">6.1.2.2.4.2. </span>Component relate<a class="headerlink" href="#component-relate" title="Permalink to this heading">¶</a></h3>
<p>The relation between the additive and multiplicative components is set with a <code class="docutils literal notranslate"><span class="pre">com</span> <span class="pre">rel</span></code> command
in SPEX. In PYSPEX this is:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.com_rel">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">com_rel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.com_rel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.com_rel" title="Permalink to this definition">¶</a></dt>
<dd><p>Relate model components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the component to relate.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number to relate.</p></li>
<li><p><strong>rel</strong> (<em>numpy.ndarray</em>) – Array containing the multiplicative component numbers counted from the source to the observer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The relations are set per component (so no ranges, unfortunately) and the related multiplicative
models should be entered (in the right order) using a numpy array. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">com</span><span class="p">(</span><span class="s1">&#39;reds&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">com</span><span class="p">(</span><span class="s1">&#39;hot&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">com</span><span class="p">(</span><span class="s1">&#39;cie&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">com_rel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</section>
</section>
<section id="distance">
<h2><span class="section-number">6.1.2.2.5. </span>Distance<a class="headerlink" href="#distance" title="Permalink to this heading">¶</a></h2>
<p>To calculate fluxes and luminosities, SPEX needs an assumed distance of the source. In SPEX this
is done with the <code class="docutils literal notranslate"><span class="pre">distance</span></code> command. In PYSPEX this is abbreviated to <code class="docutils literal notranslate"><span class="pre">dist</span></code> for convenience.</p>
<p>The distance can be set with the dist command:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dist">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the distance in SPEX.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number.</p></li>
<li><p><strong>dist</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Distance value.</p></li>
<li><p><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The unit of the distance value, for example: ‘m’, ‘au’, ‘ly’, ‘pc’, ‘kpc’, ‘mpc’, ‘z’, ‘cz’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">isect</span></code> is the sector number, <code class="docutils literal notranslate"><span class="pre">dist</span></code> the distance (float) and <code class="docutils literal notranslate"><span class="pre">unit</span></code> the unit of the
distance that is put in. The function returns an object containing the distance in all available
units.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>     <span class="c1"># Redshift of z=0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="s1">&#39;kpc&#39;</span><span class="p">)</span>   <span class="c1"># Distance of 2 kiloparsec</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">[&#39;__doc__&#39;, &#39;__init__&#39;, &#39;__module__&#39;, &#39;age&#39;, &#39;au&#39;, &#39;cz&#39;, &#39;get&#39;, &#39;h0&#39;, &#39;kpc&#39;, &#39;ly&#39;, &#39;m&#39;, &#39;mpc&#39;, &#39;omega_l&#39;, &#39;omega_m&#39;, &#39;omega_r&#39;, &#39;pc&#39;, &#39;set&#39;, &#39;set_cosmo&#39;, &#39;z&#39;]</span>
</pre></div>
</div>
<p>If you do not want to set the distance, but just get the current parameters, the <code class="docutils literal notranslate"><span class="pre">dist_get</span></code>
command can be used:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dist_get">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dist_get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dist_get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dist_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current distances in SPEX.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Like the dist command, this method returns an object with the distances in all available units.</p>
<section id="cosmology">
<h3><span class="section-number">6.1.2.2.5.1. </span>Cosmology<a class="headerlink" href="#cosmology" title="Permalink to this heading">¶</a></h3>
<p>Next to the distance, the cosmology used by SPEX can also be specified. In SPEX all parameters
should be provided through seperate lines, but in PYSPEX this has been combined in one command:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dist_cosmo">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dist_cosmo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dist_cosmo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dist_cosmo" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the cosmology for the distance calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Hubble constant (km/s/Mpc).</p></li>
<li><p><strong>omega_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Omega matter.</p></li>
<li><p><strong>omega_l</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Omega lambda.</p></li>
<li><p><strong>omega_r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Omega R.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The commands needs values for the Hubble constant <code class="docutils literal notranslate"><span class="pre">h0</span></code> (70 km/s/Mpc), Omega Matter <code class="docutils literal notranslate"><span class="pre">omega_m</span></code>
(0.3), Omega Lambda <code class="docutils literal notranslate"><span class="pre">omega_l</span></code> (0.7) and Omega R <code class="docutils literal notranslate"><span class="pre">omega_r</span></code> (0.0). For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">dist_cosmo</span><span class="p">(</span><span class="mi">75</span><span class="p">,</span><span class="mf">0.33</span><span class="p">,</span><span class="mf">0.67</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>(The command will write the distances 4 times to the terminal since in the background all
SPEX commands are executed separately…)</p>
</section>
</section>
<section id="energy-grid">
<h2><span class="section-number">6.1.2.2.6. </span>Energy grid<a class="headerlink" href="#energy-grid" title="Permalink to this heading">¶</a></h2>
<p>The model energy grid can be manipulated with the SPEX <code class="docutils literal notranslate"><span class="pre">egrid</span></code> command. In PYSPEX, this command
has been splitted into two varieties:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.egrid">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">egrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ehigh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.egrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.egrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Egrid command when the number of desired bins is known.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Lowest energy/wavelength for energy grid.</p></li>
<li><p><strong>ehigh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Highest energy/wavelength for energy grid.</p></li>
<li><p><strong>nbins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of bins for energy grid.</p></li>
<li><p><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Unit of the energy/wavelength range, for example: ‘kev’, ‘ev’, ‘ryd’, ‘j’, ‘hz’, ‘ang’, ‘nm’</p></li>
<li><p><strong>log</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Make the energy grid logarithmic (True or False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.egrid_step">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">egrid_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ehigh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.egrid_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.egrid_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Egrid command when the stepsize for the grid is known.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Lowest energy/wavelength for energy grid.</p></li>
<li><p><strong>ehigh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Highest energy/wavelength for energy grid.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Step size for the energy grid.</p></li>
<li><p><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Unit of the energy/wavelength range, for example: ‘kev’, ‘ev’, ‘ryd’, ‘j’, ‘hz’, ‘ang’, ‘nm’</p></li>
<li><p><strong>log</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Make the energy grid logarithmic (True or False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For the first method, <code class="docutils literal notranslate"><span class="pre">egrid</span></code>, the number of spectral bins <code class="docutils literal notranslate"><span class="pre">nbins</span></code> is known, while for
<code class="docutils literal notranslate"><span class="pre">egrid_step</span></code> the step size (<code class="docutils literal notranslate"><span class="pre">step</span></code>) is an input value. The lowest and highest energy of
the grid needs to be provided using the <code class="docutils literal notranslate"><span class="pre">elow</span></code> and <code class="docutils literal notranslate"><span class="pre">ehigh</span></code> input values. The unit is a
text string and the grid can be logarithmic if the <code class="docutils literal notranslate"><span class="pre">log</span></code> parameter is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">egrid</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">10.</span><span class="p">,</span><span class="mi">9990</span><span class="p">,</span><span class="s1">&#39;kev&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">egrid_step</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="s1">&#39;kev&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<section id="reading-saving-grids">
<h3><span class="section-number">6.1.2.2.6.1. </span>Reading &amp; saving grids<a class="headerlink" href="#reading-saving-grids" title="Permalink to this heading">¶</a></h3>
<p>Grids can also be save and read from a text file. The two methods below save and read a <code class="docutils literal notranslate"><span class="pre">.egr</span></code>
file, respectively:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.egrid_save">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">egrid_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savefile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.egrid_save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.egrid_save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save energy grid to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>savefile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Filename to save the energy grid to (including .egr extension)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.egrid_read">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">egrid_read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">readfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.egrid_read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.egrid_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read energy grid from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>readfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Filename to read the energy grid from (including .egr extension)</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">savefile</span></code> or <code class="docutils literal notranslate"><span class="pre">readfile</span></code> parameter should provide the method with the filename to save
or read, including the <code class="docutils literal notranslate"><span class="pre">.egr</span></code> extension! If necessary, the full path to the file can be included.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">egrid_save</span><span class="p">(</span><span class="s1">&#39;mygrid.egr&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">egrid_read</span><span class="p">(</span><span class="s1">&#39;mygrid.egr&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="get-set-custom-grids">
<h3><span class="section-number">6.1.2.2.6.2. </span>Get &amp; set custom grids<a class="headerlink" href="#get-set-custom-grids" title="Permalink to this heading">¶</a></h3>
<p>If the grid needs to be transfered from or to Python memory, then the <code class="docutils literal notranslate"><span class="pre">get</span></code> and <code class="docutils literal notranslate"><span class="pre">set</span></code> methods
can be used:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.egrid_get">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">egrid_get</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.egrid_get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.egrid_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the energy grid and return the grid as an object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An Egrid object from pyspex.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="model.html#pyspex.model.Egrid" title="pyspex.model.Egrid">pyspex.model.Egrid</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.egrid_set">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">egrid_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ebounds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.egrid_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.egrid_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide a grid to SPEX by providing a numpy array with the bin boundaries.
Please note that the length of this array is the number of bins + 1!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ebounds</strong> (<em>numpy.ndarray</em>) – Array containing the energy boundaries of the new energy grid.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">get</span></code> routine returns a Python object with the egrid arrays. The <code class="docutils literal notranslate"><span class="pre">set</span></code> routine requires
an <code class="docutils literal notranslate"><span class="pre">ebounds</span></code> numpy array containing the energies of the bin boundaries. Note that the number
of elements of this array would be of length n + 1, where n is the number of bins in the array.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">grid</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">egrid_get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ebounds</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9991</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">egrid_set</span><span class="p">(</span><span class="n">ebounds</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="flux-luminosity">
<h2><span class="section-number">6.1.2.2.7. </span>Flux &amp; Luminosity<a class="headerlink" href="#flux-luminosity" title="Permalink to this heading">¶</a></h2>
<p>For each component, the fluxes and luminosities are calculated using the set distance and energy
boundaries. These energy limits for the flux and luminosity can be set using the <code class="docutils literal notranslate"><span class="pre">elim</span></code> command:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.elim">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">elim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ehigh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.elim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.elim" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the energy limits for flux output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Lowest energy/wavelength for energy interval.</p></li>
<li><p><strong>ehigh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Highest energy/wavelength for energy interval.</p></li>
<li><p><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Unit of the energy/wavelength interval, for example: ‘kev’, ‘ev’, ‘ryd’, ‘j’, ‘hz’, ‘ang’, ‘nm’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">elow</span></code> is the lower boundary of the flux and <code class="docutils literal notranslate"><span class="pre">ehigh</span></code> the higher boundary. The <code class="docutils literal notranslate"><span class="pre">unit</span></code>
determines the units of the input values, for example ‘kev’ for keV.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">elim</span><span class="p">(</span><span class="mf">13.6E-3</span><span class="p">,</span><span class="mf">13.6</span><span class="p">,</span><span class="s1">&#39;kev&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="get-flux">
<h3><span class="section-number">6.1.2.2.7.1. </span>Get flux<a class="headerlink" href="#get-flux" title="Permalink to this heading">¶</a></h3>
<p>The fluxes and luminosities calculated in SPEX can be extracted using the <code class="docutils literal notranslate"><span class="pre">flux_get</span></code> method.</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.flux_get">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">flux_get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.flux_get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.flux_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the fluxes and luminosities for component icomp in sector isect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the component to obtain the flux from.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number to obtain the flux from.</p></li>
</ul>
</dd>
<dt class="field-even">Return flux<span class="colon">:</span></dt>
<dd class="field-even"><p>A Flux object from pyspex.</p>
</dd>
<dt class="field-odd">Rtype flux<span class="colon">:</span></dt>
<dd class="field-odd"><p>pyspex.model.Flux</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The values are returned in a python object so that they can be accessed easily:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flx</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">flux_get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">flx</span><span class="o">.</span><span class="n">enerflux</span>
<span class="go">1.51011622912e-18</span>
</pre></div>
</div>
<p>For the details about the contents of the object, see the advanced class description of the
Fluxes class.</p>
</section>
</section>
<section id="ionisation-balance">
<h2><span class="section-number">6.1.2.2.8. </span>Ionisation balance<a class="headerlink" href="#ionisation-balance" title="Permalink to this heading">¶</a></h2>
<p>There are several ionisation balances available in SPEX. The Urdampilleta ionisation balance
is the current default set.</p>
<p>The ionisation balance can be set using the <code class="docutils literal notranslate"><span class="pre">ibal</span></code> method:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.ibal">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">ibal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.ibal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.ibal" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the ionisation balance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ref</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Abbreviation of the reference to the ionisation balance.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">ref</span></code> is the short text string describing the paper reference for the ionisation balance:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ar92</span></code>: Arnaud &amp; Raymond (1992) for Fe, Arnaud &amp; Rothenflug (1985) for other elements.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ar85</span></code>: Arnaud &amp; Rothenflug (1985).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">oldbryans</span></code>: Old Bryans et al. data (NOT recommended).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bryans09</span></code>: Bryans et al. (2009).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u17</span></code>: Urdampilleta et al. (2017).</p></li>
</ul>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">ibal</span><span class="p">(</span><span class="s1">&#39;u17&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="show">
<h3><span class="section-number">6.1.2.2.8.1. </span>Show<a class="headerlink" href="#show" title="Permalink to this heading">¶</a></h3>
<p>To show the current ionisation balance, the <code class="docutils literal notranslate"><span class="pre">ibal_show</span></code> method can be used:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.ibal_show">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">ibal_show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.ibal_show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.ibal_show" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the current ionisation balance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reference to the used ionisation balance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>This method returns the reference of the ionisation balance as a string.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ib</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">ibal_show</span><span class="p">()</span>
<span class="go">Urdampilleta et al. (2017)</span>
</pre></div>
</div>
</section>
</section>
<section id="ion-selection">
<h2><span class="section-number">6.1.2.2.9. </span>Ion selection<a class="headerlink" href="#ion-selection" title="Permalink to this heading">¶</a></h2>
<p>In original SPEX models that use the SPEX atomic data, ions can be turned on or off, or can be
calculated using the old SPEX version 2 or the new SPEX version 3. In addition, the maximum
principle quantum number (nmax) and the maximum angular momentum (lmax) can be set.</p>
<p>The functions have been created such that each function selects the ions either by atomic number,
iso-electronic sequence or ion.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.ions_all">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">ions_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.ions_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.ions_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameter for all values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name to set, e.g.: ‘use’, ‘new’, ‘nmax’, ‘lmax’.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Value to set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.ions_iso">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">ions_iso</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iso</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.ions_iso"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.ions_iso" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameter for an iso-electronic sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iso</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Iso-electronic sequence number</p></li>
<li><p><strong>par</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name to set, e.g.: ‘use’, ‘new’, ‘nmax’, ‘lmax’.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Value to set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.ions_z">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">ions_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.ions_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.ions_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameter for an atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Atomic number of the element.</p></li>
<li><p><strong>par</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name to set, e.g.: ‘use’, ‘new’, ‘nmax’, ‘lmax’.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Value to set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.ions_ion">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">ions_ion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.ions_ion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.ions_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameter for a specific ion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Atomic number of the element.</p></li>
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Ionisation stage (in astrophysical notation, e.g. 1, 2, 3, etc.)</p></li>
<li><p><strong>par</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name to set, e.g.: ‘use’, ‘new’, ‘nmax’, ‘lmax’.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Value to set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="id1">
<h3><span class="section-number">6.1.2.2.9.1. </span>Show<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<p>The ion selections can be shown by calling the <code class="docutils literal notranslate"><span class="pre">ions_show</span></code> function below:</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.ions_show">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">ions_show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.ions_show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.ions_show" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the ions in use and with which parameters.</p>
</dd></dl>

</section>
<section id="line-selection">
<h3><span class="section-number">6.1.2.2.9.2. </span>Line selection<a class="headerlink" href="#line-selection" title="Permalink to this heading">¶</a></h3>
<p>Up to 10 specific lines can be ‘muted’ using the <code class="docutils literal notranslate"><span class="pre">ions_line</span></code> function below:</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.ions_line">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">ions_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.ions_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.ions_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Mutes or unmutes a spectral line from an emission spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Atomic number of the element.</p></li>
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Ionisation stage (in astrophysical notation, e.g. 1, 2, 3, etc.)</p></li>
<li><p><strong>lid</strong> – Line ID number (see ascdump_line for the line ID number).</p></li>
<li><p><strong>add</strong> – If False, the line is not added to the spectrum. True will add the line to the spectrum again.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="setting-parameters">
<h2><span class="section-number">6.1.2.2.10. </span>Setting parameters<a class="headerlink" href="#setting-parameters" title="Permalink to this heading">¶</a></h2>
<p>Model parameters in SPEX are set using the <code class="docutils literal notranslate"><span class="pre">par</span></code> command. Since this command has subcommands,
there are a number of methods to cover most of the functionality in PYSPEX. The most basic function
is to set a parameter value and determine whether it should be free in the fit or thawn. These
functions have been combined into one:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thawn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameter value and status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the parameter.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number of the parameter.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – New value of the parameter.</p></li>
<li><p><strong>thawn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Should the parameter be free (True) or frozen (False).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par_text">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Set text type parameter value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the parameter.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number of the parameter.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – New value of the parameter.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">par</span></code> method is used for setting numerical values. It needs the sector number (isect),
component number (icomp) and the name of the parameter (name) to set. Optionally, the
parameter can be set free by setting <code class="docutils literal notranslate"><span class="pre">thawn</span></code> to True.</p>
<p>For text values, like filenames of model input files, the <code class="docutils literal notranslate"><span class="pre">par_text</span></code> method is used. The
usage is very similar to the <code class="docutils literal notranslate"><span class="pre">par</span></code> method, but just with the difference a text string is
passed instead of a value. Text parameters cannot be free parameters as well.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="mf">1E+8</span><span class="p">,</span> <span class="n">thawn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par_text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;dist.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="fix-free-parameters">
<h3><span class="section-number">6.1.2.2.10.1. </span>Fix &amp; Free parameters<a class="headerlink" href="#fix-free-parameters" title="Permalink to this heading">¶</a></h3>
<p>Many times, we want to fix and free parameters without changing the values. For this purpose,
two convenience functions have been created:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par_fix">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par_fix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par_fix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par_fix" title="Permalink to this definition">¶</a></dt>
<dd><p>Fix a model parameter during the fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the parameter.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number of the parameter.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par_free">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par_free</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par_free"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Free a model parameter during the fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the parameter.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number of the parameter.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">par_fix</span></code> and <code class="docutils literal notranslate"><span class="pre">par_free</span></code> fix and free the parameter with name (<code class="docutils literal notranslate"><span class="pre">name</span></code>) in sector (<code class="docutils literal notranslate"><span class="pre">isect</span></code>)
and component (<code class="docutils literal notranslate"><span class="pre">icomp</span></code>).</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par_free</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;26&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par_fix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="parameter-range">
<h3><span class="section-number">6.1.2.2.10.2. </span>Parameter range<a class="headerlink" href="#parameter-range" title="Permalink to this heading">¶</a></h3>
<p>Parameters have ranges in which they can be safely varied without causing undesired errors or
unphysical results. These ranges can be set using the <code class="docutils literal notranslate"><span class="pre">par_range</span></code> method:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par_range">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rlow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rupp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Set parameter range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the parameter.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number of the parameter.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name.</p></li>
<li><p><strong>rlow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Lower limit of the parameter range.</p></li>
<li><p><strong>rupp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Upper limit of the parameter range.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>In addition to the sector number (<code class="docutils literal notranslate"><span class="pre">isect</span></code>), component number (<code class="docutils literal notranslate"><span class="pre">icomp</span></code>), and the parameter
name (<code class="docutils literal notranslate"><span class="pre">name</span></code>), this function needs the lower (<code class="docutils literal notranslate"><span class="pre">rlow</span></code>) and upper range (<code class="docutils literal notranslate"><span class="pre">rupp</span></code>) limits of
the parameter.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par_range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">10.</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="couple-parameters">
<h3><span class="section-number">6.1.2.2.10.3. </span>Couple parameters<a class="headerlink" href="#couple-parameters" title="Permalink to this heading">¶</a></h3>
<p>Parameters can be coupled to each other such they have the same values in the fit. Or, optionally,
remain coupled with a given multiplication factor. The PYSPEX method for this is <code class="docutils literal notranslate"><span class="pre">par_couple</span></code>:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par_couple">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par_couple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par_couple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par_couple" title="Permalink to this definition">¶</a></dt>
<dd><p>Couple one parameter to another with a given multiplication factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the parameter.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number of the parameter.</p></li>
<li><p><strong>iname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name.</p></li>
<li><p><strong>csect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the parameter to couple to.</p></li>
<li><p><strong>ccomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number of the parameter to couple to.</p></li>
<li><p><strong>cname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name of the parameter to couple to.</p></li>
<li><p><strong>factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Multiplication factor (value(name) = factor * value(cname)).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>The parameter located in <code class="docutils literal notranslate"><span class="pre">isect</span></code>, <code class="docutils literal notranslate"><span class="pre">icomp</span></code> and with <code class="docutils literal notranslate"><span class="pre">iname</span></code> will be coupled to the parameter
in <code class="docutils literal notranslate"><span class="pre">csect</span></code>, <code class="docutils literal notranslate"><span class="pre">ccomp</span></code>, and <code class="docutils literal notranslate"><span class="pre">cname</span></code>. The <code class="docutils literal notranslate"><span class="pre">factor</span></code> sets the multiplication factor for the
coupling.</p>
<p>To decouple a parameter again, simply use:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par_decouple">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par_decouple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par_decouple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par_decouple" title="Permalink to this definition">¶</a></dt>
<dd><p>Decouple a parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number of the parameter.</p></li>
<li><p><strong>icomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Component number of the parameter.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Parameter name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par_couple</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Couple the temperature in component 2 to 0.5 times the temperature in component 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par_decouple</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="set-instrument-normalisation">
<h3><span class="section-number">6.1.2.2.10.4. </span>Set instrument normalisation<a class="headerlink" href="#set-instrument-normalisation" title="Permalink to this heading">¶</a></h3>
<p>With SPEX the instrument normalisations can be set with the par command, but then with negative
sector numbers. Since that can be confusing, there is a separate command to set the instrument
normalisation, which has a similar syntax as the <code class="docutils literal notranslate"><span class="pre">par</span></code> method:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par_norm">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thawn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an instrument normalisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Instrument number.</p></li>
<li><p><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Region number.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – New value of the instrument normalisation.</p></li>
<li><p><strong>thawn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Should the parameter be free (True) or frozen (False).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>This methods sets the instrument normalisation to <code class="docutils literal notranslate"><span class="pre">value</span></code> for the instrument with number
<code class="docutils literal notranslate"><span class="pre">ins</span></code> and region number <code class="docutils literal notranslate"><span class="pre">reg</span></code>. The <code class="docutils literal notranslate"><span class="pre">status</span></code> parameter is a logical/boolean where
<code class="docutils literal notranslate"><span class="pre">True</span></code> means thawn or free and <code class="docutils literal notranslate"><span class="pre">False</span></code> frozen.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par_norm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="show-parameters">
<h3><span class="section-number">6.1.2.2.10.5. </span>Show parameters<a class="headerlink" href="#show-parameters" title="Permalink to this heading">¶</a></h3>
<p>Show the model parameters in the terminal (or Jupyter Notebook). One can specify a couple of options to
show more or less information:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par_show">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par_show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par_show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par_show" title="Permalink to this definition">¶</a></dt>
<dd><p>Display parameter overview in terminal. Options include:</p>
<ul class="simple">
<li><p>all: Show all information.</p></li>
<li><p>free: Show only free parameters.</p></li>
<li><p>couple: Show coupled parameters.</p></li>
<li><p>flux: Show summary of the fluxes of each emission component.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>option</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Select which information should be shown (free/couple/flux/all)</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par_show</span><span class="p">(</span><span class="s1">&#39;free&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The models can also be shown through the Fortran backend, but then the output will be shown in the terminal only
(not in the Jupyter notebook).</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par_show_classic">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par_show_classic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par_show_classic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par_show_classic" title="Permalink to this definition">¶</a></dt>
<dd><p>Display parameter overview in terminal through the Fortran backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>option</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Select which information should be shown (free/couple/flux/stat/corr/all)</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par_show_classic</span><span class="p">(</span><span class="s1">&#39;flux&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See also the SPEX documentation for <a class="reference external" href="https://spex-xray.github.io/spex-help/reference/commands/par.html">par_show</a>.</p>
</section>
<section id="write-parameters-to-com-file">
<h3><span class="section-number">6.1.2.2.10.6. </span>Write parameters to .com file<a class="headerlink" href="#write-parameters-to-com-file" title="Permalink to this heading">¶</a></h3>
<p>The current parameter settings can be saved to a command file (.com) and be loaded later by
the <code class="docutils literal notranslate"><span class="pre">log_exe</span></code> command. The <code class="docutils literal notranslate"><span class="pre">par_write</span></code> method in pyspex is called like this:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.par_write">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">par_write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.par_write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.par_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write parameters to a .com file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Output file name (with .com extension!)</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Overwrite existing files if necessary (True/False).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">par_write</span><span class="p">(</span><span class="s1">&#39;myparam.com&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="sectors">
<h2><span class="section-number">6.1.2.2.11. </span>Sectors<a class="headerlink" href="#sectors" title="Permalink to this heading">¶</a></h2>
<p>Sectors group spectral components to form the model for a particular source or phenomenon.
If the sectors need a different response, the sectors should also be defined in the .spo and
.res files. When starting SPEX, the number of sectors is 1 by default, even if loaded
data files contain more sectors. Sectors can be added to SPEX with the <code class="docutils literal notranslate"><span class="pre">sector</span></code> command.</p>
<p>In PYSPEX a new sector is created easily with the <code class="docutils literal notranslate"><span class="pre">sector</span></code> method:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.sector">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">sector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.sector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.sector" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new sector.</p>
</dd></dl>

</div></blockquote>
<p>This creates an empty sector. Sometimes, the new sector needs to have the same components as
a previous one. In this case, the sector can be copied:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.sector_copy">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">sector_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.sector_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.sector_copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy sector with number isect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>If a sector is no longer needed, it can be deleted:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.sector_del">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">sector_del</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isect</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.sector_del"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.sector_del" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete sector with number isect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>isect</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Sector number.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">sector</span><span class="p">()</span>
<span class="go">There are 2 sectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">sector_copy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go"> You have defined    1 component.</span>
<span class="go">There are 3 sectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">sector_del</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="differential-emission-measure-dem-modeling">
<h2><span class="section-number">6.1.2.2.12. </span>Differential Emission Measure (DEM) modeling<a class="headerlink" href="#differential-emission-measure-dem-modeling" title="Permalink to this heading">¶</a></h2>
<p>SPEX offers the functionality to fit thermal spectra with Differential Emission Measure (DEM)
models. Some of these models do not have parametrisations for the DEM structure and allow
users to fit the DEM distribution itself using various methods. In SPEX this is done using the
DEM model and commands (<a class="reference internal" href="../reference/commands/dem.html#sec-dem-command"><span class="std std-ref">DEM: differential emission measure analysis</span></a>).</p>
<p>The DEM commands are also available in PYSPEX. To use it, the <code class="docutils literal notranslate"><span class="pre">dem</span></code> model needs to be loaded
using <code class="docutils literal notranslate"><span class="pre">s.com('dem')</span></code>. The temperature grid can be set by setting the <code class="docutils literal notranslate"><span class="pre">t1</span></code>, <code class="docutils literal notranslate"><span class="pre">t2</span></code> and <code class="docutils literal notranslate"><span class="pre">nr</span></code>
parameters. It is advised not to free any parameters.</p>
<p>More information about the PYSPEX DEM class can be found at <a class="reference internal" href="model.html#class-dem"><span class="std std-ref">DEM Modeling</span></a>.</p>
<section id="creating-the-dem-spectral-library">
<h3><span class="section-number">6.1.2.2.12.1. </span>Creating the DEM spectral library<a class="headerlink" href="#creating-the-dem-spectral-library" title="Permalink to this heading">¶</a></h3>
<p>As a first step, the spectrum needs to be calculated for all temperatures on the grid. This is
done using <code class="docutils literal notranslate"><span class="pre">s.dem_lib()</span></code>:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_lib">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_lib</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_lib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_lib" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the basic DEM library of isothermal spectra.</p>
</dd></dl>

</div></blockquote>
<p>The next commands use various fitting methods to find a suitable DEM distribution using this
spectral library.</p>
</section>
<section id="regularization-method">
<h3><span class="section-number">6.1.2.2.12.2. </span>Regularization method<a class="headerlink" href="#regularization-method" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_reg">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_reg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_reg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_reg" title="Permalink to this definition">¶</a></dt>
<dd><p>Do DEM analysis using the regularization method, using a
fixed regularization parameter R = r.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Regularization parameter R</p>
</dd>
<dt class="field-even">Return chisq<span class="colon">:</span></dt>
<dd class="field-even"><p>Best fit <img class="math" src="../_images/math/db5019371e06bb4dbbf76375d0a61d554448699b.svg" alt="\chi^2" style="vertical-align: -3px"/>.</p>
</dd>
<dt class="field-odd">Rtype chisq<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Return dempen<span class="colon">:</span></dt>
<dd class="field-even"><p>DEM penalty (number of zero emission components)</p>
</dd>
<dt class="field-odd">Rtype dempen<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>There is also an automatic regularisation method:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_reg_auto">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_reg_auto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_reg_auto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_reg_auto" title="Permalink to this definition">¶</a></dt>
<dd><p>Do DEM analysis using the regularization method using an automatic search of the optimum regularization
parameter. It determines the regularisation parameter R in such a way that
<img class="math" src="../_images/math/a1f8b1cfbbf0d08517d5204ae13b96e650b967b6.svg" alt="\chi^2(R) = \chi^2(0) [1 + s \sqrt{2/(n-n_{\mathrm T}}]" style="vertical-align: -5px"/> where the scaling factor s=1, n is the number of
spectral bins in the data set and <img class="math" src="../_images/math/1984ffeaa7eed72cc82dd61c13f80e368ba7a706.svg" alt="n_{\mathrm T}" style="vertical-align: -2px"/> is the number of temperature components in the DEM library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Scaling factor in the automatic search for R (optional).</p>
</dd>
<dt class="field-even">Return chisq<span class="colon">:</span></dt>
<dd class="field-even"><p>Best fit <img class="math" src="../_images/math/7f4f72c9d6e9ba4cbe0f1538e4758bed12ac2d8b.svg" alt="\chi^2(R)" style="vertical-align: -4px"/>.</p>
</dd>
<dt class="field-odd">Rtype chisq<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Return dempen<span class="colon">:</span></dt>
<dd class="field-even"><p>DEM penalty (number of zero emission components)</p>
</dd>
<dt class="field-odd">Rtype dempen<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Both functions above return the best fit <img class="math" src="../_images/math/db5019371e06bb4dbbf76375d0a61d554448699b.svg" alt="\chi^2" style="vertical-align: -3px"/> value and the DEM penalty.</p>
<p>One can also do a grid search using <code class="docutils literal notranslate"><span class="pre">s.dem_chireg()</span></code>, which outputs a table with best-fit
<img class="math" src="../_images/math/db5019371e06bb4dbbf76375d0a61d554448699b.svg" alt="\chi^2" style="vertical-align: -3px"/> values and regularisation parameters:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_chireg">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_chireg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_chireg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_chireg" title="Permalink to this definition">¶</a></dt>
<dd><p>Do a grid search over the regularization parameter R, with <code class="docutils literal notranslate"><span class="pre">n</span></code> steps and R distributed logarithmically
between <code class="docutils literal notranslate"><span class="pre">r1</span></code> and <code class="docutils literal notranslate"><span class="pre">r2</span></code>. Useful to scan the <img class="math" src="../_images/math/7f4f72c9d6e9ba4cbe0f1538e4758bed12ac2d8b.svg" alt="\chi^2(R)" style="vertical-align: -4px"/> curve whenever it is complicated and to see how
much <cite>penalty</cite> (negative DEM values) there are for each value of R.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Lower boundary for R.</p></li>
<li><p><strong>r2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Upper boundary for R.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of steps.</p></li>
</ul>
</dd>
<dt class="field-even">Return chi_table<span class="colon">:</span></dt>
<dd class="field-even"><p>Table with the Chi^2 and DEM penalty values for each regularization parameter.</p>
</dd>
<dt class="field-odd">Rtype chi_table<span class="colon">:</span></dt>
<dd class="field-odd"><p>astropy.table.QTable</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">penalty</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dem_reg</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">penalty</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dem_reg_auto</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dem_chireg</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>The output table has the columns: Regularisation parameter (Reg), Chi squared (Chi2) and
Penalty (Penalty).</p>
</section>
<section id="clean-method">
<h3><span class="section-number">6.1.2.2.12.3. </span>Clean method<a class="headerlink" href="#clean-method" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_clean">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_clean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_clean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Do DEM analysis using the clean method.</p>
<dl class="field-list simple">
<dt class="field-odd">Return chisq<span class="colon">:</span></dt>
<dd class="field-odd"><p>Best fit <img class="math" src="../_images/math/db5019371e06bb4dbbf76375d0a61d554448699b.svg" alt="\chi^2" style="vertical-align: -3px"/>.</p>
</dd>
<dt class="field-even">Rtype chisq<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Return dempen<span class="colon">:</span></dt>
<dd class="field-odd"><p>DEM penalty (number of zero emission components)</p>
</dd>
<dt class="field-even">Rtype dempen<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">penalty</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dem_clean</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="polynomial-method">
<h3><span class="section-number">6.1.2.2.12.4. </span>Polynomial method<a class="headerlink" href="#polynomial-method" title="Permalink to this heading">¶</a></h3>
<p>The DEM can also be parametrised by a polynomial:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_poly">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_poly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Do DEM analysis using the polynomial method, where <code class="docutils literal notranslate"><span class="pre">degree</span></code> is the degree of the polynomial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>degree</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The degree of the polynomial.</p>
</dd>
<dt class="field-even">Return chisq<span class="colon">:</span></dt>
<dd class="field-even"><p>Best fit <img class="math" src="../_images/math/db5019371e06bb4dbbf76375d0a61d554448699b.svg" alt="\chi^2" style="vertical-align: -3px"/>.</p>
</dd>
<dt class="field-odd">Rtype chisq<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Return dempen<span class="colon">:</span></dt>
<dd class="field-even"><p>DEM penalty (number of zero emission components)</p>
</dd>
<dt class="field-odd">Rtype dempen<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">penalty</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dem_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="multi-temperature-method">
<h3><span class="section-number">6.1.2.2.12.5. </span>Multi-temperature method<a class="headerlink" href="#multi-temperature-method" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_mult">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_mult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncomp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_mult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_mult" title="Permalink to this definition">¶</a></dt>
<dd><p>Do DEM analysis using the multi-temperature method, where <code class="docutils literal notranslate"><span class="pre">ncomp</span></code> is the number of broad components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ncomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of broad temperature components.</p>
</dd>
<dt class="field-even">Return mult_table<span class="colon">:</span></dt>
<dd class="field-even"><p>Table containing the best temperature components and their emission measure.</p>
</dd>
<dt class="field-odd">Rtype mult_table<span class="colon">:</span></dt>
<dd class="field-odd"><p>astropy.table.QTable</p>
</dd>
<dt class="field-even">Return chisq<span class="colon">:</span></dt>
<dd class="field-even"><p>Best fit <img class="math" src="../_images/math/db5019371e06bb4dbbf76375d0a61d554448699b.svg" alt="\chi^2" style="vertical-align: -3px"/>.</p>
</dd>
<dt class="field-odd">Rtype chisq<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dem_mult</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
<p>The method outputs the <img class="math" src="../_images/math/db5019371e06bb4dbbf76375d0a61d554448699b.svg" alt="\chi^2" style="vertical-align: -3px"/> value and a table with columns for the temperature (kT),
the error on temperature (dkT), and differential emission measure (DY).</p>
</section>
<section id="genetic-algorithm">
<h3><span class="section-number">6.1.2.2.12.6. </span>Genetic algorithm<a class="headerlink" href="#genetic-algorithm" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_gene">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_gene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_gene"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_gene" title="Permalink to this definition">¶</a></dt>
<dd><p>Do DEM analysis using the genetic algorithm, using a population size given by <code class="docutils literal notranslate"><span class="pre">pop</span></code> (maximum value 1024)
and <code class="docutils literal notranslate"><span class="pre">gen</span></code> is the number of generations (no limit, in practice after about 100 generations not much change in
the solution. Experiment with these numbers for your practical case).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Population size</p></li>
<li><p><strong>gen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of generations</p></li>
</ul>
</dd>
<dt class="field-even">Return mult_table<span class="colon">:</span></dt>
<dd class="field-even"><p>Table containing the best temperature components and their emission measure.</p>
</dd>
<dt class="field-odd">Rtype mult_table<span class="colon">:</span></dt>
<dd class="field-odd"><p>astropy.table.QTable</p>
</dd>
<dt class="field-even">Return chisq<span class="colon">:</span></dt>
<dd class="field-even"><p>Best fit <img class="math" src="../_images/math/db5019371e06bb4dbbf76375d0a61d554448699b.svg" alt="\chi^2" style="vertical-align: -3px"/>.</p>
</dd>
<dt class="field-odd">Rtype chisq<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">penalty</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dem_gene</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">80</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="dem-smooth">
<h3><span class="section-number">6.1.2.2.12.7. </span>DEM smooth<a class="headerlink" href="#dem-smooth" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_smooth">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smoothes a DEM previously determined by any DEM method using a block filter/ Here <code class="docutils literal notranslate"><span class="pre">width</span></code> is the full width
of the filter expressed in <img class="math" src="../_images/math/bc16cb2471360bb4aa9a7f3fed9c63cd439f6fe3.svg" alt="^{10}\log T" style="vertical-align: -3px"/>. Note that this smoothing will in principle worsen the
<img class="math" src="../_images/math/db5019371e06bb4dbbf76375d0a61d554448699b.svg" alt="\chi^2" style="vertical-align: -3px"/> of the solution, but it is sometimes useful to “wash out” some residual noise in the DEM
distribution, preserving total emission measure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The full width of the filter expressed in <img class="math" src="../_images/math/bc16cb2471360bb4aa9a7f3fed9c63cd439f6fe3.svg" alt="^{10}\log T" style="vertical-align: -3px"/>.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">dem_smooth</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="get-the-dem-distribution-in-python">
<h3><span class="section-number">6.1.2.2.12.8. </span>Get the DEM distribution in python<a class="headerlink" href="#get-the-dem-distribution-in-python" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_get">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_get</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the best-fit DEM distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Return table<span class="colon">:</span></dt>
<dd class="field-odd"><p>Table with the DEM distribution</p>
</dd>
<dt class="field-even">Rtype table<span class="colon">:</span></dt>
<dd class="field-even"><p>astropy.table.QTable</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dem_get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
<p>The output table has the columns temperature (kT), differential emission measure (DY) and
the error on the emission measure (DY_Err), if available.</p>
</section>
<section id="plot-the-dem-distribution">
<h3><span class="section-number">6.1.2.2.12.9. </span>Plot the DEM distribution<a class="headerlink" href="#plot-the-dem-distribution" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_plot">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the DEM distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Make the X-axis logarithmic.</p></li>
<li><p><strong>ylog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Make the Y-axis logarithmic.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">dem_plot</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="reading-the-dem-distribution-from-file">
<h3><span class="section-number">6.1.2.2.12.10. </span>Reading the DEM distribution from file<a class="headerlink" href="#reading-the-dem-distribution-from-file" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_read">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a DEM distribution from a file named #a which automatically gets the extension <code class="docutils literal notranslate"><span class="pre">.dem</span></code>. It is an ascii
file with at least two columns, the first column is the temperature in keV and the second column the
differential emission measure, in units of <img class="math" src="../_images/math/5dbdc1e07ee6aca7fcc581f51089404e50eed0f7.svg" alt="10^{64} m^{-3} keV^{-1}" style="vertical-align: 0px"/>. The maximum number of data points
in this file is 8192. Temperature should be in increasing order. The data will be interpolated to match
the temperature grid defined in the dem model (which is set by the user).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Filename without <code class="docutils literal notranslate"><span class="pre">.dem</span></code> extension.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">dem_read</span><span class="p">(</span><span class="s1">&#39;mydem&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="writing-the-dem-distribution-to-file">
<h3><span class="section-number">6.1.2.2.12.11. </span>Writing the DEM distribution to file<a class="headerlink" href="#writing-the-dem-distribution-to-file" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.dem_write">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">dem_write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.dem_write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.dem_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the DEM to a file <code class="docutils literal notranslate"><span class="pre">file</span></code> with extension “.dem”. The same format as above is used for the file. A third
column has the corresponding error bars on the DEM as determined by the DEM method used (not always relevant
or well defined, exept for the regularization method).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Filename without <code class="docutils literal notranslate"><span class="pre">.dem</span></code> extension.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">dem_write</span><span class="p">(</span><span class="s1">&#39;mydem&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="plasma-model-parameters">
<h2><span class="section-number">6.1.2.2.13. </span>Plasma model parameters<a class="headerlink" href="#plasma-model-parameters" title="Permalink to this heading">¶</a></h2>
<p>There are a number of settings for the SPEX plasma models that can be changed by the user. In
SPEX these are done using the <code class="docutils literal notranslate"><span class="pre">var</span></code> command. The <code class="docutils literal notranslate"><span class="pre">var</span></code> commands have been implemented in
pyspex through the methods below. The current settings can be obtained using the
<a class="reference internal" href="model.html#class-var"><span class="std std-ref">Var class</span></a> which is referenced in the SPEX session as <code class="docutils literal notranslate"><span class="pre">s.mod_var</span></code>.</p>
<section id="free-bound-accuracy">
<h3><span class="section-number">6.1.2.2.13.1. </span>Free-bound accuracy<a class="headerlink" href="#free-bound-accuracy" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.var_gacc">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">var_gacc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.var_gacc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.var_gacc" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the free-bound emission accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Free-bound emission accuracy.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_gacc</span><span class="p">(</span><span class="mf">1.0E-2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="line-emission-contributions">
<h3><span class="section-number">6.1.2.2.13.2. </span>Line emission contributions<a class="headerlink" href="#line-emission-contributions" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.var_line">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">var_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ltype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.var_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.var_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a line emission contribution on or off.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ltype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Line emission contribution (‘ex’, ‘px’, ‘rr’, ‘dr’, ‘ds’, ‘ii’, ‘reset’)</p></li>
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Boolean indicator whether contribution is on (True) or off (False).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_line</span><span class="p">(</span><span class="s1">&#39;ex&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="doppler-broadening">
<h3><span class="section-number">6.1.2.2.13.3. </span>Doppler broadening<a class="headerlink" href="#doppler-broadening" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.var_doppler">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">var_doppler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.var_doppler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.var_doppler" title="Permalink to this definition">¶</a></dt>
<dd><p>Doppler broadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Doppler broadening type.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_doppler</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spexact-version-3-calculations">
<h3><span class="section-number">6.1.2.2.13.4. </span>SPEXACT version 3 calculations<a class="headerlink" href="#spexact-version-3-calculations" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.var_calc">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">var_calc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.var_calc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.var_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform SPEXACT 3 line calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Use SPEXACT 2 (0), Quick SPEXACT 3 (1), or SPEXACT 3 (2)</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_calc</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="occupation-numbers-starting-values">
<h3><span class="section-number">6.1.2.2.13.5. </span>Occupation numbers starting values<a class="headerlink" href="#occupation-numbers-starting-values" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.var_occstart">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">var_occstart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">otype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.var_occstart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.var_occstart" title="Permalink to this definition">¶</a></dt>
<dd><p>At which occupation level to start.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>otype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Occupation level (‘ground’, ‘boltz’, ‘last’)</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_occstart</span><span class="p">(</span><span class="s1">&#39;ground&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spexact-version-2-settings-mekal">
<h3><span class="section-number">6.1.2.2.13.6. </span>SPEXACT version 2 settings (MEKAL)<a class="headerlink" href="#spexact-version-2-settings-mekal" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.var_mekal">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">var_mekal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.var_mekal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.var_mekal" title="Permalink to this definition">¶</a></dt>
<dd><p>Switch old Mekal updates on/off.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>utype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Update type (‘wav’, ‘fe17’, ‘update’, ‘all’)</p></li>
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – On (True) or off (False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_mekal</span><span class="p">(</span><span class="s1">&#39;wav&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_mekal</span><span class="p">(</span><span class="s1">&#39;fe17&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="multi-maxwellians-for-the-ionisation-balance">
<h3><span class="section-number">6.1.2.2.13.7. </span>Multi-Maxwellians for the ionisation balance<a class="headerlink" href="#multi-maxwellians-for-the-ionisation-balance" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.var_ibalmaxw">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">var_ibalmaxw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.var_ibalmaxw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.var_ibalmaxw" title="Permalink to this definition">¶</a></dt>
<dd><p>Switch the Multi-Maxwellians for the ionisation balance on/off (True/False).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – On (True) or off (False)</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_ibalmaxw</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spexact-version-3-cooling">
<h3><span class="section-number">6.1.2.2.13.8. </span>SPEXACT version 3 cooling<a class="headerlink" href="#spexact-version-3-cooling" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.var_newcoolexc">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">var_newcoolexc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.var_newcoolexc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.var_newcoolexc" title="Permalink to this definition">¶</a></dt>
<dd><p>Cooling by collisional excitation by Stofanova (SPEXACT 3) on/off (True/False).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – On (True) or off (False)</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_newcoolexc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>And for the cooling by di-electronic recombination:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.var_newcooldr">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">var_newcooldr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.var_newcooldr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.var_newcooldr" title="Permalink to this definition">¶</a></dt>
<dd><p>Cooling by dielectronic recombination (SPEXACT 3) on/off (True/False).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – On (True) or off (False)</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_newcooldr</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="charge-exchange-recombination-and-ionization">
<h3><span class="section-number">6.1.2.2.13.9. </span>Charge exchange recombination and ionization<a class="headerlink" href="#charge-exchange-recombination-and-ionization" title="Permalink to this heading">¶</a></h3>
<p>Set the origin of the charge exchange recombination and ionization rates.</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.var_cxcon">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">var_cxcon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.var_cxcon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.var_cxcon" title="Permalink to this definition">¶</a></dt>
<dd><p>Set charge exchange recombination and ionization rates according to either
1 = Arnaud &amp; Rothenflug (1985) or 2 = Kingdon &amp; Ferland (1996). Default is 2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Recombination and ionisation rateset. 1 = Arnaud &amp; Rothenflug, 2 = Kingdon &amp; Ferland.</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">var_cxcon</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo-wide.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getstarted.html">1. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../threads.html">2. Analysis threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">3. Command overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">4. Spectral models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">5. Additional tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pyspex.html">6. Python Interface</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../pyspex.html#basic-commands">6.1. Basic commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pyspex.html#analysis-threads-other-tricks">6.2. Analysis threads &amp; other tricks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pyspex.html#advanced-class-descriptions">6.3. Advanced class descriptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../help.html">7. Help &amp; troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">8. SPEX Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises.html">9. Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">10. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">11. Credits</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../pyspex.html"><span class="section-number">6. </span>Python Interface</a><ul>
  <li><a href="commands.html"><span class="section-number">6.1.2. </span>Basic PYSPEX commands</a><ul>
      <li>Previous: <a href="com_data.html" title="previous chapter"><span class="section-number">6.1.2.1. </span>Data related commands</a></li>
      <li>Next: <a href="com_ascdump.html" title="next chapter"><span class="section-number">6.1.2.3. </span>Ascdump commands</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
        Last updated on: Sep 10, 2024.<br>
    
        &copy;2024, Jelle de Plaa, Jelle Kaastra, Liyi Gu, SPEX Development Team, <a href="https://www.sron.nl/">SRON Netherlands Institute for Space Research</a>.
    

</div>

  </body>
</html>