
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>6.1.2.5. Plot commands &#8212; SPEX Help Center 3.08.01 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="canonical" href="https://spex-xray.github.io/spex-help/pyspex/com_plot.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.1.2.6. Log commands" href="com_log.html" />
    <link rel="prev" title="6.1.2.4. Optimization commands" href="com_opt.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="plot-commands">
<span id="pyspex-plot"></span><h1><span class="section-number">6.1.2.5. </span>Plot commands<a class="headerlink" href="#plot-commands" title="Permalink to this heading">¶</a></h1>
<p>Next to the PGPLOT plotting system of SPEX, the python interface can also be used for plotting.
In this section, we provide a list of commands for plotting spectral models, the effective area and
spectral data (including residuals).</p>
<section id="plot-spectral-model">
<h2><span class="section-number">6.1.2.5.1. </span>Plot spectral model<a class="headerlink" href="#plot-spectral-model" title="Permalink to this heading">¶</a></h2>
<p>The SPEX plot type ‘model’ plots the model spectrum as a function of energy or wavelength.
In PYSPEX there is a function to obtain the same plot using matplotlib:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.plot_model">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">plot_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPEX</span> <span class="pre">Model</span> <span class="pre">Spectrum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.plot_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.plot_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the spectral model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Set the X-axis to be logarithmic.</p></li>
<li><p><strong>ylog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Set the Y-axis to be logarithmic.</p></li>
<li><p><strong>wave</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Plot in wavelength (Angstrom)</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – (Optional) Set the title of the plot.</p></li>
<li><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Show the plot (True) or return the plot object (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot object and optionally the matplotlib plt object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="plot.html#pyspex.plot.PlotModel" title="pyspex.plot.PlotModel">pyspex.plot.PlotModel</a>, matplotlib.pyplot</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>This function plots the model spectrum as a function of energy (keV) by default. If the <code class="docutils literal notranslate"><span class="pre">wave=True</span></code>
parameter is set, then the spectrum will be plotted as a function of wavelength (<img class="math" src="../_images/math/930cf1bd920e5a1a203879c11d070c25dad6bf93.svg" alt="\AA" style="vertical-align: 0px"/>).
The axis can be made logarithmic by setting <code class="docutils literal notranslate"><span class="pre">xlog=True</span></code> and <code class="docutils literal notranslate"><span class="pre">ylog=True</span></code> for the x and y axis,
respectively.</p>
<blockquote>
<div><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Due to a bug in pyspex 3.06.01, the unit on the y axis is not photons/s/m**2/keV,
but photons/s/m**2. So it shows the spectra without dividing by the bin width.
This issue will be fixed in pyspex 3.07.00.</p>
</div>
</div></blockquote>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_model</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">xlog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ylog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<section id="obtain-the-raw-plot-data">
<h3><span class="section-number">6.1.2.5.1.1. </span>Obtain the raw plot data<a class="headerlink" href="#obtain-the-raw-plot-data" title="Permalink to this heading">¶</a></h3>
<p>It is possible to get the raw plot data through the pyspex interface. The <code class="docutils literal notranslate"><span class="pre">plot_model</span></code> command
can return an object containing the plot data organised by model sector. Per sector, the data
is available in two formats: an <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.QTable.html">Astropy QTable</a>
and individual numpy arrays.</p>
<p>The data object <code class="docutils literal notranslate"><span class="pre">pl</span></code> can be returned as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">plot_model</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">sector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tabmodel</span>
</pre></div>
</div>
<p>Please be reminded that Python starts counting at 0, while SPEX starts counting at 1, so sector[0]
in Python corresponds to sector 1 in SPEX.</p>
<p>The table <code class="docutils literal notranslate"><span class="pre">tabmodel</span></code> contains the following columns:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X_ctr</span></code>: The central value of the X-axis bin (in energy or wavelength)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X_upp</span></code>: The value of the upper bin edge of the X-axis bin (in energy or wavelength)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Model</span></code>: The model value for that bin.</p></li>
</ul>
</div></blockquote>
<p>Since <code class="docutils literal notranslate"><span class="pre">tabmodel</span></code> is an <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.QTable.html">Astropy QTable</a>
the units of the values are included in the table data and all the features of a QTable can be used.</p>
<p>Some examples to try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">plot_model</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">sector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tabmodel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;X_ctr&#39;</span><span class="p">]</span>         <span class="c1"># extract a column from the table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span> <span class="c1"># see the unit of the Model column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>               <span class="c1"># Print the table nicely formatted</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="plot.html#class-plot-model"><span class="std std-ref">Model spectrum plots</span></a> for a description of the individual numpy arrays available within
the sector object.</p>
</section>
</section>
<section id="plot-data">
<h2><span class="section-number">6.1.2.5.2. </span>Plot data<a class="headerlink" href="#plot-data" title="Permalink to this heading">¶</a></h2>
<p>The SPEX data plot type plots the observed spectrum, the folded model and background spectrum.
In PYSPEX, this is done with one command called <code class="docutils literal notranslate"><span class="pre">plot_data</span></code>:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.plot_data">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">plot_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPEX'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.plot_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.plot_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the observed spectrum with the convolved model for all instruments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Set the X-axis to be logarithmic.</p></li>
<li><p><strong>ylog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Set the Y-axis to be logarithmic.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – (Optional) Set the title of the plot.</p></li>
<li><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Show the plot (True) or return the plot object (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot object and optionally the matplotlib plt object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="plot.html#pyspex.plot.PlotData" title="pyspex.plot.PlotData">pyspex.plot.PlotData</a>, matplotlib.pyplot</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>This function plots the observed spectra in black, the convolved model in red, and the background
spectrum as a dashed blue line. The axis can be made logarithmic by setting <code class="docutils literal notranslate"><span class="pre">xlog=True</span></code>
and <code class="docutils literal notranslate"><span class="pre">ylog=True</span></code> for the x and y axis, respectively.</p>
<p>With the parameter <code class="docutils literal notranslate"><span class="pre">wave=True</span></code>, the data and model will be plotted versus wavelength (<img class="math" src="../_images/math/930cf1bd920e5a1a203879c11d070c25dad6bf93.svg" alt="\AA" style="vertical-align: 0px"/>).</p>
<blockquote>
<div><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Due to a bug in pyspex 3.06.01, the unit on the y axis is not counts/s/keV,
but counts/s. So it shows the spectra without dividing by the bin width.
This issue will be fixed in pyspex 3.07.00.</p>
</div>
</div></blockquote>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">xlog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ylog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<section id="plot-data-with-residuals">
<h3><span class="section-number">6.1.2.5.2.1. </span>Plot data with residuals<a class="headerlink" href="#plot-data-with-residuals" title="Permalink to this heading">¶</a></h3>
<p>It is also possible to attach a subplot with residuals to the main data plot. To do this,
one uses the <code class="docutils literal notranslate"><span class="pre">plot_chi</span></code> command:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.plot_chi">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">plot_chi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dchi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPEX'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.plot_chi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.plot_chi" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the observed spectrum with the convolved model and their residuals for all instruments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Set the X-axis to be logarithmic.</p></li>
<li><p><strong>ylog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Set the Y-axis to be logarithmic.</p></li>
<li><p><strong>chi</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – (Optional) Type of residual, either ‘dchi’ or ‘rel’.</p></li>
<li><p><strong>wave</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Plot residuals as function of wavelength (Angstrom)</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – (Optional) Set the title of the plot.</p></li>
<li><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Show the plot (True) or return the plot object (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot object and optionally the matplotlib plt object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="plot.html#pyspex.plot.PlotData" title="pyspex.plot.PlotData">pyspex.plot.PlotData</a>, matplotlib.pyplot</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>In addition to the xlog and ylog parameter, this function can also set the residual type.
Currently, <code class="docutils literal notranslate"><span class="pre">dchi</span></code> and <code class="docutils literal notranslate"><span class="pre">rel</span></code> are implemented. Also, with the parameter <code class="docutils literal notranslate"><span class="pre">wave=True</span></code>, the
values will be plotted as a function of wavelength (<img class="math" src="../_images/math/930cf1bd920e5a1a203879c11d070c25dad6bf93.svg" alt="\AA" style="vertical-align: 0px"/>).</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_chi</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_chi</span><span class="p">(</span><span class="n">chi</span><span class="o">=</span><span class="s1">&#39;rel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_chi</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plot-data-with-model-components">
<h3><span class="section-number">6.1.2.5.2.2. </span>Plot data with model components<a class="headerlink" href="#plot-data-with-model-components" title="Permalink to this heading">¶</a></h3>
<p>For models with multiple additive components, it is possible in PYSPEX to plot the total model and
the contributions from the individual additive components with the <code class="docutils literal notranslate"><span class="pre">plot_comp</span></code> method.</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.plot_comp">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">plot_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPEX'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.plot_comp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.plot_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the individual model components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Set the X-axis to be logarithmic.</p></li>
<li><p><strong>ylog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Set the Y-axis to be logarithmic.</p></li>
<li><p><strong>wave</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Plot the components as function of wavelength (Angstrom)</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – (Optional) Set the title of the plot.</p></li>
<li><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Show the plot (True) or return the plot object (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot object and optionally the matplotlib plt object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="plot.html#pyspex.plot.PlotData" title="pyspex.plot.PlotData">pyspex.plot.PlotData</a>, matplotlib.pyplot</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_comp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_comp</span><span class="p">(</span><span class="n">ylog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Spectral components&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_comp</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3><span class="section-number">6.1.2.5.2.3. </span>Obtain the raw plot data<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<p>It is possible to get the raw plot data through the pyspex interface. The <code class="docutils literal notranslate"><span class="pre">plot_data</span></code> command
can return an object containing the plot data organised by instrument and region. Per region, the data
is available in two formats: an <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.QTable.html">Astropy QTable</a>
and individual numpy arrays.</p>
<p>The data object <code class="docutils literal notranslate"><span class="pre">pl</span></code> can be returned as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">plot_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">inst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tabdata</span>
</pre></div>
</div>
<p>Please be reminded that Python starts counting at 0, while SPEX starts counting at 1, so inst[0]
and reg[0] in Python correspond to instrument 1 and region 1, respectively.</p>
<p>The table <code class="docutils literal notranslate"><span class="pre">tabdata</span></code> contains the following columns:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X_ctr</span></code>: The central value of the X-axis bin (in energy or wavelength).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X_low</span></code>: The value of the lower bin edge of the X-axis bin (in energy or wavelength).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X_upp</span></code>: The value of the upper bin edge of the X-axis bin (in energy or wavelength).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Data</span></code>: The data value for every bin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Error</span></code>: The error value for every data point.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Model</span></code>: The model value for every bin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Bkg</span></code>: The background value for every bin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Exposure</span></code>: The exposure time for each bin (SPEX stores effective area corrections
as effective exposure times per bin).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1/Area</span></code>: The inverse of the effective area. This array is used internally in SPEX.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Chi</span></code>: The residuals for every bin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Chi_err</span></code>: The error on the residual for every bin.</p></li>
</ul>
</div></blockquote>
<p>Since <code class="docutils literal notranslate"><span class="pre">tabdata</span></code> is an <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.QTable.html">Astropy QTable</a>
the units of the values are included in the table data and all the features of a QTable can be used.</p>
<p>Some examples to try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">plot_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">sector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tabdata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;X_ctr&#39;</span><span class="p">]</span>          <span class="c1"># extract a column from the table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>  <span class="c1"># Print the unit of the Model column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>                <span class="c1"># Print the table nicely formatted</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="plot.html#class-plot-data"><span class="std std-ref">Data plots</span></a> for a description of the individual numpy arrays available within
the region object.</p>
</section>
</section>
<section id="plot-effective-area">
<h2><span class="section-number">6.1.2.5.3. </span>Plot effective area<a class="headerlink" href="#plot-effective-area" title="Permalink to this heading">¶</a></h2>
<p>The SPEX plot type ‘area’ plots the effective area as a function of energy. In PYSPEX there is a
function to obtain the same plot using matplotlib:</p>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="pyspex.spex.Session.plot_area">
<span class="sig-prename descclassname"><span class="pre">Session.</span></span><span class="sig-name descname"><span class="pre">plot_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Effective</span> <span class="pre">Area'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyspex/spex.html#Session.plot_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyspex.spex.Session.plot_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the effective area of all instruments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Set the X-axis to be logarithmic.</p></li>
<li><p><strong>ylog</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Set the Y-axis to be logarithmic.</p></li>
<li><p><strong>wave</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Plot the effective area as function of wavelength (Angstrom)</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – (Optional) Set the title of the plot.</p></li>
<li><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – (Optional) Show the plot (True) or return the plot object (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Plot object and optionally the matplotlib plt object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="plot.html#pyspex.plot.PlotArea" title="pyspex.plot.PlotArea">pyspex.plot.PlotArea</a>, matplotlib.pyplot</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p>This function plots the effective area as a function of energy (keV) by default. To plot the effective
area as function of wavelength (<img class="math" src="../_images/math/930cf1bd920e5a1a203879c11d070c25dad6bf93.svg" alt="\AA" style="vertical-align: 0px"/>), one can set <code class="docutils literal notranslate"><span class="pre">wave=True</span></code> as one of the function arguments.</p>
<p>The plot axes can be made logarithmic by setting <code class="docutils literal notranslate"><span class="pre">xlog=True</span></code> and <code class="docutils literal notranslate"><span class="pre">ylog=True</span></code> for the x and y axis,
respectively.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_area</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_area</span><span class="p">(</span><span class="n">xlog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ylog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot_area</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<section id="id5">
<h3><span class="section-number">6.1.2.5.3.1. </span>Obtain the raw plot data<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<p>It is possible to get the raw plot data through the pyspex interface. The <code class="docutils literal notranslate"><span class="pre">plot_area</span></code> command
can return an object containing the plot data organised by instrument and region. Per region, the data
is available in two formats: an <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.QTable.html">Astropy QTable</a>
and individual numpy arrays.</p>
<p>The data object <code class="docutils literal notranslate"><span class="pre">pl</span></code> can be returned as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">plot_area</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">inst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tabarea</span>
</pre></div>
</div>
<p>Please be reminded that Python starts counting at 0, while SPEX starts counting at 1, so <code class="docutils literal notranslate"><span class="pre">inst[0]</span></code> and
<code class="docutils literal notranslate"><span class="pre">reg[0]</span></code> in Python correspond to instrument 1 and region 1, respectively.</p>
<p>The table <code class="docutils literal notranslate"><span class="pre">tabarea</span></code> contains the following columns:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X_ctr</span></code>: The central value of the X-axis bin (in energy or wavelength)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X_upp</span></code>: The value of the upper bin edge of the X-axis bin (in energy or wavelength)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Area</span></code>:  The effective area value for that bin.</p></li>
</ul>
</div></blockquote>
<p>Since <code class="docutils literal notranslate"><span class="pre">tabarea</span></code> is an <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.QTable.html">Astropy QTable</a>
the units of the values are included in the table data and all the features of a QTable can be used.</p>
<p>Some examples to try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">plot_area</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">inst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tabarea</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;X_ctr&#39;</span><span class="p">]</span>         <span class="c1"># extract a column from the table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>  <span class="c1"># see the unit of the Area column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>               <span class="c1"># Print the table nicely formatted</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="plot.html#class-plot-area"><span class="std std-ref">Effective area plots</span></a> for a description of the individual numpy arrays available within
the region object.</p>
</section>
</section>
<section id="plotting-astropy-table-data">
<h2><span class="section-number">6.1.2.5.4. </span>Plotting Astropy Table data<a class="headerlink" href="#plotting-astropy-table-data" title="Permalink to this heading">¶</a></h2>
<p>There are some caveats to keep in mind when plotting Astropy QTable data with Matplotlib. First,
matplotlib cannot plot columns directly, since they are in a non-standard format. It needs some
information to decode the arrays. Luckily, the Astropy module provides those. At the beginning
of your program, you can add the following lines to make it work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">quantity_support</span>
<span class="n">quantity_support</span><span class="p">()</span>
</pre></div>
</div>
<p>The above will enable quantity support for the entire file. If you do not want that, you can
also enable it for a single or series of commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">quantity_support</span>
<span class="o">...</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="o">...</span>
    <span class="k">with</span> <span class="n">quantity_support</span><span class="p">():</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;X_ctr&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Model&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>More information about <a class="reference external" href="https://docs.astropy.org/en/stable/table/index.html">Astropy Tables</a> and
<a class="reference external" href="https://docs.astropy.org/en/stable/units/index.html">Astropy Units</a>.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo-wide.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getstarted.html">1. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../threads.html">2. Analysis threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">3. Command overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">4. Spectral models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">5. Additional tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pyspex.html">6. Python Interface</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../pyspex.html#basic-commands">6.1. Basic commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pyspex.html#analysis-threads-other-tricks">6.2. Analysis threads &amp; other tricks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pyspex.html#advanced-class-descriptions">6.3. Advanced class descriptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../help.html">7. Help &amp; troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">8. SPEX Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises.html">9. Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">10. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">11. Credits</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../pyspex.html"><span class="section-number">6. </span>Python Interface</a><ul>
  <li><a href="commands.html"><span class="section-number">6.1.2. </span>Basic PYSPEX commands</a><ul>
      <li>Previous: <a href="com_opt.html" title="previous chapter"><span class="section-number">6.1.2.4. </span>Optimization commands</a></li>
      <li>Next: <a href="com_log.html" title="next chapter"><span class="section-number">6.1.2.6. </span>Log commands</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
        Last updated on: Sep 10, 2024.<br>
    
        &copy;2024, Jelle de Plaa, Jelle Kaastra, Liyi Gu, SPEX Development Team, <a href="https://www.sron.nl/">SRON Netherlands Institute for Space Research</a>.
    

</div>

  </body>
</html>